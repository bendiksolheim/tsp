(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function r(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(l){if(l.ep)return;l.ep=!0;const c=r(l);fetch(l.href,c)}})();var mc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},zs={exports:{}};/*! Tweakpane 3.1.9 (c) 2016 cocopon, licensed under the MIT license. */(function(t,i){(function(r,o){o(i)})(mc,function(r){class o{constructor(e){const[s,a]=e.split("-"),d=s.split(".");this.major=parseInt(d[0],10),this.minor=parseInt(d[1],10),this.patch=parseInt(d[2],10),this.prerelease=a??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}}class l{constructor(e){this.controller_=e}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(e){this.controller_.viewProps.set("hidden",e)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class c{constructor(e){this.target=e}}class h extends c{constructor(e,s,a,d){super(e),this.value=s,this.presetKey=a,this.last=d??!0}}class u extends c{constructor(e,s,a){super(e),this.value=s,this.presetKey=a}}class _ extends c{constructor(e,s){super(e),this.expanded=s}}class f extends c{constructor(e,s){super(e),this.index=s}}function y(n){return n}function g(n){return n==null}function v(n,e){if(n.length!==e.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!==e[s])return!1;return!0}function b(n,e){let s=n;do{const a=Object.getOwnPropertyDescriptor(s,e);if(a&&(a.set!==void 0||a.writable===!0))return!0;s=Object.getPrototypeOf(s)}while(s!==null);return!1}const k={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class P{static alreadyDisposed(){return new P({type:"alreadydisposed"})}static notBindable(){return new P({type:"notbindable"})}static propertyNotFound(e){return new P({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new P({type:"shouldneverhappen"})}constructor(e){var s;this.message=(s=k[e.type](e.context))!==null&&s!==void 0?s:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}}class S{constructor(e,s,a){this.obj_=e,this.key_=s,this.presetKey_=a??s}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(e){this.obj_[this.key_]=e}writeProperty(e,s){const a=this.read();if(!S.isBindable(a))throw P.notBindable();if(!(e in a))throw P.propertyNotFound(e);a[e]=s}}class x extends l{get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get title(){var e;return(e=this.controller_.valueController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.valueController.props.set("title",e)}on(e,s){const a=s.bind(this);return this.controller_.valueController.emitter.on(e,()=>{a(new c(this))}),this}}class C{constructor(){this.observers_={}}on(e,s){let a=this.observers_[e];return a||(a=this.observers_[e]=[]),a.push({handler:s}),this}off(e,s){const a=this.observers_[e];return a&&(this.observers_[e]=a.filter(d=>d.handler!==s)),this}emit(e,s){const a=this.observers_[e];a&&a.forEach(d=>{d.handler(s)})}}const R="tp";function E(n){return(s,a)=>[R,"-",n,"v",s?`_${s}`:"",a?`-${a}`:""].join("")}function M(n,e){return s=>e(n(s))}function j(n){return n.rawValue}function O(n,e){n.emitter.on("change",M(j,e)),e(n.rawValue)}function U(n,e,s){O(n.value(e),s)}function D(n,e,s){s?n.classList.add(e):n.classList.remove(e)}function I(n,e){return s=>{D(n,e,s)}}function q(n,e){O(n,s=>{e.textContent=s??""})}const J=E("btn");class nt{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(J()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("button");a.classList.add(J("b")),s.viewProps.bindDisabled(a),this.element.appendChild(a),this.buttonElement=a;const d=e.createElement("div");d.classList.add(J("t")),q(s.props.value("title"),d),this.buttonElement.appendChild(d)}}class Y{constructor(e,s){this.emitter=new C,this.onClick_=this.onClick_.bind(this),this.props=s.props,this.viewProps=s.viewProps,this.view=new nt(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class wt{constructor(e,s){var a;this.constraint_=s==null?void 0:s.constraint,this.equals_=(a=s==null?void 0:s.equals)!==null&&a!==void 0?a:(d,m)=>d===m,this.emitter=new C,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,s){const a=s??{forceEmit:!1,last:!0},d=this.constraint_?this.constraint_.constrain(e):e,m=this.rawValue_;this.equals_(m,d)&&!a.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=d,this.emitter.emit("change",{options:a,previousRawValue:m,rawValue:d,sender:this}))}}class at{constructor(e){this.emitter=new C,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,s){const a=s??{forceEmit:!1,last:!0},d=this.value_;d===e&&!a.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:a,previousRawValue:d,rawValue:this.value_,sender:this}))}}function it(n,e){const s=e==null?void 0:e.constraint,a=e==null?void 0:e.equals;return!s&&!a?new at(n):new wt(n,e)}class N{constructor(e){this.emitter=new C,this.valMap_=e;for(const s in this.valMap_)this.valMap_[s].emitter.on("change",()=>{this.emitter.emit("change",{key:s,sender:this})})}static createCore(e){return Object.keys(e).reduce((a,d)=>Object.assign(a,{[d]:it(e[d])}),{})}static fromObject(e){const s=this.createCore(e);return new N(s)}get(e){return this.valMap_[e].rawValue}set(e,s){this.valMap_[e].rawValue=s}value(e){return this.valMap_[e]}}function kt(n,e){const a=Object.keys(e).reduce((d,m)=>{if(d===void 0)return;const w=e[m],T=w(n[m]);return T.succeeded?Object.assign(Object.assign({},d),{[m]:T.value}):void 0},{});return a}function Nt(n,e){return n.reduce((s,a)=>{if(s===void 0)return;const d=e(a);if(!(!d.succeeded||d.value===void 0))return[...s,d.value]},[])}function Ut(n){return n===null?!1:typeof n=="object"}function Ct(n){return e=>s=>{if(!e&&s===void 0)return{succeeded:!1,value:void 0};if(e&&s===void 0)return{succeeded:!0,value:void 0};const a=n(s);return a!==void 0?{succeeded:!0,value:a}:{succeeded:!1,value:void 0}}}function Qt(n){return{custom:e=>Ct(e)(n),boolean:Ct(e=>typeof e=="boolean"?e:void 0)(n),number:Ct(e=>typeof e=="number"?e:void 0)(n),string:Ct(e=>typeof e=="string"?e:void 0)(n),function:Ct(e=>typeof e=="function"?e:void 0)(n),constant:e=>Ct(s=>s===e?e:void 0)(n),raw:Ct(e=>e)(n),object:e=>Ct(s=>{if(Ut(s))return kt(s,e)})(n),array:e=>Ct(s=>{if(Array.isArray(s))return Nt(s,e)})(n)}}const et={optional:Qt(!0),required:Qt(!1)};function st(n,e){const s=et.required.object(e)(n);return s.succeeded?s.value:void 0}function rt(n){console.warn([`Missing '${n.key}' of ${n.target} in ${n.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function ci(n){return n&&n.parentElement&&n.parentElement.removeChild(n),null}class Tt{constructor(e){this.value_=e}static create(e){return[new Tt(e),(s,a)=>{e.setRawValue(s,a)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const Ua=E("");function sn(n,e){return I(n,Ua(void 0,e))}class qt extends N{constructor(e){var s;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Tt.create(it(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(s=this.get("parent"))===null||s===void 0||s.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var s,a,d;const m=e??{};return new qt(N.createCore({disabled:(s=m.disabled)!==null&&s!==void 0?s:!1,disposed:!1,hidden:(a=m.hidden)!==null&&a!==void 0?a:!1,parent:(d=m.parent)!==null&&d!==void 0?d:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){O(this.globalDisabled_,sn(e,"disabled")),U(this,"hidden",sn(e,"hidden"))}bindDisabled(e){O(this.globalDisabled_,s=>{e.disabled=s})}bindTabIndex(e){O(this.globalDisabled_,s=>{e.tabIndex=s?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",s=>{s&&e()})}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var s;const a=e.previousRawValue;a==null||a.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(s=this.get("parent"))===null||s===void 0||s.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function za(){return["veryfirst","first","last","verylast"]}const nn=E(""),rn={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Fe{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const s=this.view.element;this.blade.value("positions").emitter.on("change",()=>{za().forEach(a=>{s.classList.remove(nn(void 0,rn[a]))}),this.blade.get("positions").forEach(a=>{s.classList.add(nn(void 0,rn[a]))})}),this.viewProps.handleDispose(()=>{ci(s)})}get parent(){return this.parent_}set parent(e){if(this.parent_=e,!("parent"in this.viewProps.valMap_)){rt({key:"parent",target:qt.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const zt="http://www.w3.org/2000/svg";function di(n){n.offsetHeight}function Ha(n,e){const s=n.style.transition;n.style.transition="none",e(),n.style.transition=s}function ts(n){return n.ontouchstart!==void 0}function Ka(){return globalThis}function $a(){return Ka().document}function qa(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const Ga={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function ui(n,e){const s=n.createElementNS(zt,"svg");return s.innerHTML=Ga[e],s}function an(n,e,s){n.insertBefore(e,n.children[s])}function on(n){n.parentElement&&n.parentElement.removeChild(n)}function ln(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function Ya(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function hn(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}const Oe=E("lbl");function Xa(n,e){const s=n.createDocumentFragment();return e.split(`
`).map(d=>n.createTextNode(d)).forEach((d,m)=>{m>0&&s.appendChild(n.createElement("br")),s.appendChild(d)}),s}class cn{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(Oe()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("div");a.classList.add(Oe("l")),U(s.props,"label",m=>{g(m)?this.element.classList.add(Oe(void 0,"nol")):(this.element.classList.remove(Oe(void 0,"nol")),Ya(a),a.appendChild(Xa(e,m)))}),this.element.appendChild(a),this.labelElement=a;const d=e.createElement("div");d.classList.add(Oe("v")),this.element.appendChild(d),this.valueElement=d}}class pi extends Fe{constructor(e,s){const a=s.valueController.viewProps;super(Object.assign(Object.assign({},s),{view:new cn(e,{props:s.props,viewProps:a}),viewProps:a})),this.props=s.props,this.valueController=s.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const Wa={id:"button",type:"blade",accept(n){const e=et,s=st(n,{title:e.required.string,view:e.required.constant("button"),label:e.optional.string});return s?{params:s}:null},controller(n){return new pi(n.document,{blade:n.blade,props:N.fromObject({label:n.params.label}),valueController:new Y(n.document,{props:N.fromObject({title:n.params.title}),viewProps:n.viewProps})})},api(n){return!(n.controller instanceof pi)||!(n.controller.valueController instanceof Y)?null:new x(n.controller)}};class ke extends Fe{constructor(e){super(e),this.value=e.value}}function Ie(){return new N({positions:it([],{equals:v})})}class Ne extends N{constructor(e){super(e)}static create(e){const s={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},a=N.createCore(s);return new Ne(a)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!g(e)?`${e}px`:"auto"}bindExpandedClass(e,s){const a=()=>{this.styleExpanded?e.classList.add(s):e.classList.remove(s)};U(this,"expanded",a),U(this,"temporaryExpanded",a)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Ja(n,e){let s=0;return Ha(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),di(e),s=e.clientHeight,n.set("temporaryExpanded",null),di(e)}),s}function dn(n,e){e.style.height=n.styleHeight}function es(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),g(n.get("expandedHeight"))){const s=Ja(n,e);s>0&&n.set("expandedHeight",s)}n.set("shouldFixHeight",!0),di(e)}),n.emitter.on("change",()=>{dn(n,e)}),dn(n,e),e.addEventListener("transitionend",s=>{s.propertyName==="height"&&n.cleanUpTransition()})}class is extends l{constructor(e,s){super(e),this.rackApi_=s}}function Za(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function Qa(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function to(n,e){const s=e??{};return n.addBlade(Object.assign(Object.assign({},s),{view:"separator"}))}function eo(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}class ss{constructor(e){this.emitter=new C,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const s of this.allItems())if(e(s))return s;return null}includes(e){return this.cache_.has(e)}add(e,s){if(this.includes(e))throw P.shouldNeverHappen();const a=s!==void 0?s:this.items_.length;this.items_.splice(a,0,e),this.cache_.add(e);const d=this.extract_(e);d&&(d.emitter.on("add",this.onSubListAdd_),d.emitter.on("remove",this.onSubListRemove_),d.allItems().forEach(m=>{this.cache_.add(m)})),this.emitter.emit("add",{index:a,item:e,root:this,target:this})}remove(e){const s=this.items_.indexOf(e);if(s<0)return;this.items_.splice(s,1),this.cache_.delete(e);const a=this.extract_(e);a&&(a.emitter.off("add",this.onSubListAdd_),a.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:s,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}class ns extends l{constructor(e){super(e),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new C,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,s){const a=s.bind(this);return this.emitter_.on(e,d=>{a(d.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(e){const s=e.sender.target.read();this.emitter_.emit("change",{event:new h(this,s,this.controller_.binding.target.presetKey,e.options.last)})}}class Ht extends pi{constructor(e,s){super(e,s),this.binding=s.binding}}class rs extends l{constructor(e){super(e),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new C,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}on(e,s){const a=s.bind(this);return this.emitter_.on(e,d=>{a(d.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(e){const s=e.sender.target.read();this.emitter_.emit("update",{event:new u(this,s,this.controller_.binding.target.presetKey)})}}class te extends pi{constructor(e,s){super(e,s),this.binding=s.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function io(n){return n instanceof fi?n.apiSet_:n instanceof is?n.rackApi_.apiSet_:null}function Be(n,e){const s=n.find(a=>a.controller_===e);if(!s)throw P.shouldNeverHappen();return s}function un(n,e,s){if(!S.isBindable(n))throw P.notBindable();return new S(n,e,s)}class fi extends l{constructor(e,s){super(e),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new C,this.apiSet_=new ss(io),this.pool_=s;const a=this.controller_.rack;a.emitter.on("add",this.onRackAdd_),a.emitter.on("remove",this.onRackRemove_),a.emitter.on("inputchange",this.onRackInputChange_),a.emitter.on("monitorupdate",this.onRackMonitorUpdate_),a.children.forEach(d=>{this.setUpApi_(d)})}get children(){return this.controller_.rack.children.map(e=>Be(this.apiSet_,e))}addInput(e,s,a){const d=a??{},m=this.controller_.view.element.ownerDocument,w=this.pool_.createInput(m,un(e,s,d.presetKey),d),T=new ns(w);return this.add(T,d.index)}addMonitor(e,s,a){const d=a??{},m=this.controller_.view.element.ownerDocument,w=this.pool_.createMonitor(m,un(e,s),d),T=new rs(w);return this.add(T,d.index)}addFolder(e){return Qa(this,e)}addButton(e){return Za(this,e)}addSeparator(e){return to(this,e)}addTab(e){return eo(this,e)}add(e,s){this.controller_.rack.add(e.controller_,s);const a=this.apiSet_.find(d=>d.controller_===e.controller_);return a&&this.apiSet_.remove(a),this.apiSet_.add(e),e}remove(e){this.controller_.rack.remove(e.controller_)}addBlade(e){const s=this.controller_.view.element.ownerDocument,a=this.pool_.createBlade(s,e),d=this.pool_.createBladeApi(a);return this.add(d,e.index)}on(e,s){const a=s.bind(this);return this.emitter_.on(e,d=>{a(d.event)}),this}setUpApi_(e){this.apiSet_.find(a=>a.controller_===e)||this.apiSet_.add(this.pool_.createBladeApi(e))}onRackAdd_(e){this.setUpApi_(e.bladeController)}onRackRemove_(e){if(e.isRoot){const s=Be(this.apiSet_,e.bladeController);this.apiSet_.remove(s)}}onRackInputChange_(e){const s=e.bladeController;if(s instanceof Ht){const a=Be(this.apiSet_,s),d=s.binding;this.emitter_.emit("change",{event:new h(a,d.target.read(),d.target.presetKey,e.options.last)})}else if(s instanceof ke){const a=Be(this.apiSet_,s);this.emitter_.emit("change",{event:new h(a,s.value.rawValue,void 0,e.options.last)})}}onRackMonitorUpdate_(e){if(!(e.bladeController instanceof te))throw P.shouldNeverHappen();const s=Be(this.apiSet_,e.bladeController),a=e.bladeController.binding;this.emitter_.emit("update",{event:new u(s,a.target.read(),a.target.presetKey)})}}class as extends is{constructor(e,s){super(e,new fi(e.rackController,s)),this.emitter_=new C,this.controller_.foldable.value("expanded").emitter.on("change",a=>{this.emitter_.emit("fold",{event:new _(this,a.sender.rawValue)})}),this.rackApi_.on("change",a=>{this.emitter_.emit("change",{event:a})}),this.rackApi_.on("update",a=>{this.emitter_.emit("update",{event:a})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(e){this.controller_.foldable.set("expanded",e)}get title(){return this.controller_.props.get("title")}set title(e){this.controller_.props.set("title",e)}get children(){return this.rackApi_.children}addInput(e,s,a){return this.rackApi_.addInput(e,s,a)}addMonitor(e,s,a){return this.rackApi_.addMonitor(e,s,a)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,s){return this.rackApi_.add(e,s)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,s){const a=s.bind(this);return this.emitter_.on(e,d=>{a(d.event)}),this}}class os extends Fe{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}}class so{constructor(e,s){const a=E(s.viewName);this.element=e.createElement("div"),this.element.classList.add(a()),s.viewProps.bindClassModifiers(this.element)}}function no(n,e){for(let s=0;s<n.length;s++){const a=n[s];if(a instanceof Ht&&a.binding===e)return a}return null}function ro(n,e){for(let s=0;s<n.length;s++){const a=n[s];if(a instanceof te&&a.binding===e)return a}return null}function ao(n,e){for(let s=0;s<n.length;s++){const a=n[s];if(a instanceof ke&&a.value===e)return a}return null}function ls(n){return n instanceof De?n.rack:n instanceof os?n.rackController.rack:null}function oo(n){const e=ls(n);return e?e.bcSet_:null}class lo{constructor(e){var s,a;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new C,this.blade_=(s=e.blade)!==null&&s!==void 0?s:null,(a=this.blade_)===null||a===void 0||a.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new ss(oo),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,s){var a;(a=e.parent)===null||a===void 0||a.remove(e),b(e,"parent")?e.parent=this:(e.parent_=this,rt({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(e,s)}remove(e){b(e,"parent")?e.parent=null:(e.parent_=null,rt({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(s=>s instanceof e)}onSetAdd_(e){this.updatePositions_();const s=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,isRoot:s,sender:this}),!s)return;const a=e.item;if(a.viewProps.emitter.on("change",this.onChildViewPropsChange_),a.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),a.viewProps.handleDispose(this.onChildDispose_),a instanceof Ht)a.binding.emitter.on("change",this.onChildInputChange_);else if(a instanceof te)a.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(a instanceof ke)a.value.emitter.on("change",this.onChildValueChange_);else{const d=ls(a);if(d){const m=d.emitter;m.on("layout",this.onDescendantLayout_),m.on("inputchange",this.onDescendantInputChange_),m.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(e){this.updatePositions_();const s=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,isRoot:s,sender:this}),!s)return;const a=e.item;if(a instanceof Ht)a.binding.emitter.off("change",this.onChildInputChange_);else if(a instanceof te)a.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(a instanceof ke)a.value.emitter.off("change",this.onChildValueChange_);else{const d=ls(a);if(d){const m=d.emitter;m.off("layout",this.onDescendantLayout_),m.off("inputchange",this.onDescendantInputChange_),m.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const e=this.bcSet_.items.filter(d=>!d.viewProps.get("hidden")),s=e[0],a=e[e.length-1];this.bcSet_.items.forEach(d=>{const m=[];d===s&&(m.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&m.push("veryfirst")),d===a&&(m.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&m.push("verylast")),d.blade.set("positions",m)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(s=>s.viewProps.get("disposed")).forEach(s=>{this.bcSet_.remove(s)})}onChildInputChange_(e){const s=no(this.find(Ht),e.sender);if(!s)throw P.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:s,options:e.options,sender:this})}onChildMonitorUpdate_(e){const s=ro(this.find(te),e.sender);if(!s)throw P.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:s,sender:this})}onChildValueChange_(e){const s=ao(this.find(ke),e.sender);if(!s)throw P.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:s,options:e.options,sender:this})}onDescendantLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(e){this.emitter.emit("inputchange",{bladeController:e.bladeController,options:e.options,sender:this})}onDescendantMonitorUpdate_(e){this.emitter.emit("monitorupdate",{bladeController:e.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class De extends Fe{constructor(e,s){super(Object.assign(Object.assign({},s),{view:new so(e,{viewName:"brk",viewProps:s.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const a=new lo({blade:s.root?void 0:s.blade,viewProps:s.viewProps});a.emitter.on("add",this.onRackAdd_),a.emitter.on("remove",this.onRackRemove_),this.rack=a,this.viewProps.handleDispose(()=>{for(let d=this.rack.children.length-1;d>=0;d--)this.rack.children[d].viewProps.set("disposed",!0)})}onRackAdd_(e){e.isRoot&&an(this.view.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.isRoot&&on(e.bladeController.view.element)}}const pn=E("cnt");class ho{constructor(e,s){var a;this.className_=E((a=s.viewName)!==null&&a!==void 0?a:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),pn()),s.viewProps.bindClassModifiers(this.element),this.foldable_=s.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),U(this.foldable_,"completed",I(this.element,this.className_(void 0,"cpl")));const d=e.createElement("button");d.classList.add(this.className_("b")),U(s.props,"title",z=>{g(z)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),s.viewProps.bindDisabled(d),this.element.appendChild(d),this.buttonElement=d;const m=e.createElement("div");m.classList.add(this.className_("i")),this.element.appendChild(m);const w=e.createElement("div");w.classList.add(this.className_("t")),q(s.props.value("title"),w),this.buttonElement.appendChild(w),this.titleElement=w;const T=e.createElement("div");T.classList.add(this.className_("m")),this.buttonElement.appendChild(T);const B=s.containerElement;B.classList.add(this.className_("c")),this.element.appendChild(B),this.containerElement=B}}class hs extends os{constructor(e,s){var a;const d=Ne.create((a=s.expanded)!==null&&a!==void 0?a:!0),m=new De(e,{blade:s.blade,root:s.root,viewProps:s.viewProps});super(Object.assign(Object.assign({},s),{rackController:m,view:new ho(e,{containerElement:m.view.element,foldable:d,props:s.props,viewName:s.root?"rot":void 0,viewProps:s.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=s.props,this.foldable=d,es(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const co={id:"folder",type:"blade",accept(n){const e=et,s=st(n,{title:e.required.string,view:e.required.constant("folder"),expanded:e.optional.boolean});return s?{params:s}:null},controller(n){return new hs(n.document,{blade:n.blade,expanded:n.params.expanded,props:N.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof hs?new as(n.controller,n.pool):null}};class Ce extends ke{constructor(e,s){const a=s.valueController.viewProps;super(Object.assign(Object.assign({},s),{value:s.valueController.value,view:new cn(e,{props:s.props,viewProps:a}),viewProps:a})),this.props=s.props,this.valueController=s.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class fn extends l{}const _n=E("spr");class uo{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(_n()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("hr");a.classList.add(_n("r")),this.element.appendChild(a)}}class mn extends Fe{constructor(e,s){super(Object.assign(Object.assign({},s),{view:new uo(e,{viewProps:s.viewProps})}))}}const po={id:"separator",type:"blade",accept(n){const s=st(n,{view:et.required.constant("separator")});return s?{params:s}:null},controller(n){return new mn(n.document,{blade:n.blade,viewProps:n.viewProps})},api(n){return n.controller instanceof mn?new fn(n.controller):null}},je=E("tbi");class fo{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(je()),s.viewProps.bindClassModifiers(this.element),U(s.props,"selected",m=>{m?this.element.classList.add(je(void 0,"sel")):this.element.classList.remove(je(void 0,"sel"))});const a=e.createElement("button");a.classList.add(je("b")),s.viewProps.bindDisabled(a),this.element.appendChild(a),this.buttonElement=a;const d=e.createElement("div");d.classList.add(je("t")),q(s.props.value("title"),d),this.buttonElement.appendChild(d),this.titleElement=d}}class _o{constructor(e,s){this.emitter=new C,this.onClick_=this.onClick_.bind(this),this.props=s.props,this.viewProps=s.viewProps,this.view=new fo(e,{props:s.props,viewProps:s.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class gn{constructor(e,s){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new _o(e,{props:s.itemProps,viewProps:qt.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new De(e,{blade:Ie(),viewProps:qt.create()}),this.props=s.props,U(this.props,"selected",a=>{this.itemController.props.set("selected",a),this.contentController.viewProps.set("hidden",!a)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class vn{constructor(e,s){this.controller_=e,this.rackApi_=s}get title(){var e;return(e=this.controller_.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.itemController.props.set("title",e)}get selected(){return this.controller_.props.get("selected")}set selected(e){this.controller_.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addSeparator(e){return this.rackApi_.addSeparator(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,s){this.rackApi_.add(e,s)}remove(e){this.rackApi_.remove(e)}addInput(e,s,a){return this.rackApi_.addInput(e,s,a)}addMonitor(e,s,a){return this.rackApi_.addMonitor(e,s,a)}addBlade(e){return this.rackApi_.addBlade(e)}}class bn extends is{constructor(e,s){super(e,new fi(e.rackController,s)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new C,this.pageApiMap_=new Map,this.rackApi_.on("change",a=>{this.emitter_.emit("change",{event:a})}),this.rackApi_.on("update",a=>{this.emitter_.emit("update",{event:a})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(a=>{this.setUpPageApi_(a)})}get pages(){return this.controller_.pageSet.items.map(e=>{const s=this.pageApiMap_.get(e);if(!s)throw P.shouldNeverHappen();return s})}addPage(e){const s=this.controller_.view.element.ownerDocument,a=new gn(s,{itemProps:N.fromObject({selected:!1,title:e.title}),props:N.fromObject({selected:!1})});this.controller_.add(a,e.index);const d=this.pageApiMap_.get(a);if(!d)throw P.shouldNeverHappen();return d}removePage(e){this.controller_.remove(e)}on(e,s){const a=s.bind(this);return this.emitter_.on(e,d=>{a(d.event)}),this}setUpPageApi_(e){const s=this.rackApi_.apiSet_.find(d=>d.controller_===e.contentController);if(!s)throw P.shouldNeverHappen();const a=new vn(e,s);this.pageApiMap_.set(e,a)}onPageAdd_(e){this.setUpPageApi_(e.item)}onPageRemove_(e){if(!this.pageApiMap_.get(e.item))throw P.shouldNeverHappen();this.pageApiMap_.delete(e.item)}onSelect_(e){this.emitter_.emit("select",{event:new f(this,e.rawValue)})}}const yn=-1;class mo{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=it(!0),this.selectedIndex=it(yn),this.items_=[]}add(e,s){const a=s??this.items_.length;this.items_.splice(a,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const s=this.items_.indexOf(e);s<0||(this.items_.splice(s,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=yn,this.empty.rawValue=!0;return}const e=this.items_.findIndex(s=>s.rawValue);e<0?(this.items_.forEach((s,a)=>{s.rawValue=a===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((s,a)=>{s.rawValue=a===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const s=this.items_.findIndex(a=>a===e.sender);this.items_.forEach((a,d)=>{a.rawValue=d===s}),this.selectedIndex.rawValue=s}else this.keepSelection_()}}const Ue=E("tab");class go{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(Ue(),pn()),s.viewProps.bindClassModifiers(this.element),O(s.empty,I(this.element,Ue(void 0,"nop")));const a=e.createElement("div");a.classList.add(Ue("t")),this.element.appendChild(a),this.itemsElement=a;const d=e.createElement("div");d.classList.add(Ue("i")),this.element.appendChild(d);const m=s.contentsElement;m.classList.add(Ue("c")),this.element.appendChild(m),this.contentsElement=m}}class wn extends os{constructor(e,s){const a=new De(e,{blade:s.blade,viewProps:s.viewProps}),d=new mo;super({blade:s.blade,rackController:a,view:new go(e,{contentsElement:a.view.element,empty:d.empty,viewProps:s.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new ss(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=d}get pageSet(){return this.pageSet_}add(e,s){this.pageSet_.add(e,s)}remove(e){this.pageSet_.remove(this.pageSet_.items[e])}onPageAdd_(e){const s=e.item;an(this.view.itemsElement,s.itemController.view.element,e.index),s.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(s.contentController,e.index),this.tab.add(s.props.value("selected"))}onPageRemove_(e){const s=e.item;on(s.itemController.view.element),s.itemController.viewProps.set("parent",null),this.rackController.rack.remove(s.contentController),this.tab.remove(s.props.value("selected"))}}const xn={id:"tab",type:"blade",accept(n){const e=et,s=st(n,{pages:e.required.array(e.required.object({title:e.required.string})),view:e.required.constant("tab")});return!s||s.pages.length===0?null:{params:s}},controller(n){const e=new wn(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(s=>{const a=new gn(n.document,{itemProps:N.fromObject({selected:!1,title:s.title}),props:N.fromObject({selected:!1})});e.add(a)}),e},api(n){return n.controller instanceof wn?new bn(n.controller,n.pool):null}};function vo(n,e){const s=n.accept(e.params);if(!s)return null;const a=et.optional.boolean(e.params.disabled).value,d=et.optional.boolean(e.params.hidden).value;return n.controller({blade:Ie(),document:e.document,params:Object.assign(Object.assign({},s.params),{disabled:a,hidden:d}),viewProps:qt.create({disabled:a,hidden:d})})}class bo{constructor(){this.disabled=!1,this.emitter=new C}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class yo{constructor(e,s){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new C,this.interval_=s,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class wo{constructor(e){this.onValueChange_=this.onValueChange_.bind(this),this.reader=e.reader,this.writer=e.writer,this.emitter=new C,this.value=e.value,this.value.emitter.on("change",this.onValueChange_),this.target=e.target,this.read()}read(){const e=this.target.read();e!==void 0&&(this.value.rawValue=this.reader(e))}write_(e){this.writer(this.target,e)}onValueChange_(e){this.write_(e.rawValue),this.emitter.emit("change",{options:e.options,rawValue:e.rawValue,sender:this})}}function kn(n,e){for(;n.length<e;)n.push(void 0)}function xo(n){const e=[];return kn(e,n),it(e)}function ko(n){const e=n.indexOf(void 0);return e<0?n:n.slice(0,e)}function Co(n,e){const s=[...ko(n),e];return s.length>n.length?s.splice(0,s.length-n.length):kn(s,n.length),s}class Po{constructor(e){this.onTick_=this.onTick_.bind(this),this.reader_=e.reader,this.target=e.target,this.emitter=new C,this.value=e.value,this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const e=this.target.read();if(e===void 0)return;const s=this.value.rawValue,a=this.reader_(e);this.value.rawValue=Co(s,a),this.emitter.emit("update",{rawValue:a,sender:this})}onTick_(e){this.read()}}class ze{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((s,a)=>a.constrain(s),e)}}function Gt(n,e){if(n instanceof e)return n;if(n instanceof ze){const s=n.constraints.reduce((a,d)=>a||(d instanceof e?d:null),null);if(s)return s}return null}class Pe{constructor(e){this.values=N.fromObject({max:e.max,min:e.min})}constrain(e){const s=this.values.get("max"),a=this.values.get("min");return Math.min(Math.max(e,a),s)}}class He{constructor(e){this.values=N.fromObject({options:e})}get options(){return this.values.get("options")}constrain(e){const s=this.values.get("options");return s.length===0||s.filter(d=>d.value===e).length>0?e:s[0].value}}class Cn{constructor(e){this.values=N.fromObject({max:e.max,min:e.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(e){const s=this.values.get("max"),a=this.values.get("min");let d=e;return g(a)||(d=Math.max(d,a)),g(s)||(d=Math.min(d,s)),d}}class _i{constructor(e,s=0){this.step=e,this.origin=s}constrain(e){const s=this.origin%this.step,a=Math.round((e-s)/this.step);return s+a*this.step}}const cs=E("lst");class Eo{constructor(e,s){this.onValueChange_=this.onValueChange_.bind(this),this.props_=s.props,this.element=e.createElement("div"),this.element.classList.add(cs()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("select");a.classList.add(cs("s")),U(this.props_,"options",m=>{ln(a),m.forEach((w,T)=>{const B=e.createElement("option");B.dataset.index=String(T),B.textContent=w.text,B.value=String(w.value),a.appendChild(B)})}),s.viewProps.bindDisabled(a),this.element.appendChild(a),this.selectElement=a;const d=e.createElement("div");d.classList.add(cs("m")),d.appendChild(ui(e,"dropdown")),this.element.appendChild(d),s.value.emitter.on("change",this.onValueChange_),this.value_=s.value,this.update_()}update_(){this.selectElement.value=String(this.value_.rawValue)}onValueChange_(){this.update_()}}class Ke{constructor(e,s){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=s.props,this.value=s.value,this.viewProps=s.viewProps,this.view=new Eo(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const a=e.currentTarget.selectedOptions.item(0);if(!a)return;const d=Number(a.dataset.index);this.value.rawValue=this.props.get("options")[d].value}}const Pn=E("pop");class So{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(Pn()),s.viewProps.bindClassModifiers(this.element),O(s.shows,I(this.element,Pn(void 0,"v")))}}class En{constructor(e,s){this.shows=it(!1),this.viewProps=s.viewProps,this.view=new So(e,{shows:this.shows,viewProps:this.viewProps})}}const Sn=E("txt");class Ao{constructor(e,s){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Sn()),s.viewProps.bindClassModifiers(this.element),this.props_=s.props,this.props_.emitter.on("change",this.onChange_);const a=e.createElement("input");a.classList.add(Sn("i")),a.type="text",s.viewProps.bindDisabled(a),this.element.appendChild(a),this.inputElement=a,s.value.emitter.on("change",this.onChange_),this.value_=s.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class mi{constructor(e,s){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=s.parser,this.props=s.props,this.value=s.value,this.viewProps=s.viewProps,this.view=new Ao(e,{props:s.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const a=e.currentTarget.value,d=this.parser_(a);g(d)||(this.value.rawValue=d),this.view.refresh()}}function Ro(n){return String(n)}function An(n){return n==="false"?!1:!!n}function Rn(n){return Ro(n)}class Mo{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const To={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};class Vo{constructor(e,s,a){this.left=s,this.operator=e,this.right=a}evaluate(){const e=To[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Lo={"+":n=>n,"-":n=>-n,"~":n=>~n};class Fo{constructor(e,s){this.operator=e,this.expression=s}evaluate(){const e=Lo[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function ds(n){return(e,s)=>{for(let a=0;a<n.length;a++){const d=n[a](e,s);if(d!=="")return d}return""}}function $e(n,e){var s;const a=n.substr(e).match(/^\s+/);return(s=a&&a[0])!==null&&s!==void 0?s:""}function Oo(n,e){const s=n.substr(e,1);return s.match(/^[1-9]$/)?s:""}function qe(n,e){var s;const a=n.substr(e).match(/^[0-9]+/);return(s=a&&a[0])!==null&&s!==void 0?s:""}function Io(n,e){const s=qe(n,e);if(s!=="")return s;const a=n.substr(e,1);if(e+=1,a!=="-"&&a!=="+")return"";const d=qe(n,e);return d===""?"":a+d}function us(n,e){const s=n.substr(e,1);if(e+=1,s.toLowerCase()!=="e")return"";const a=Io(n,e);return a===""?"":s+a}function Mn(n,e){const s=n.substr(e,1);if(s==="0")return s;const a=Oo(n,e);return e+=a.length,a===""?"":a+qe(n,e)}function No(n,e){const s=Mn(n,e);if(e+=s.length,s==="")return"";const a=n.substr(e,1);if(e+=a.length,a!==".")return"";const d=qe(n,e);return e+=d.length,s+a+d+us(n,e)}function Bo(n,e){const s=n.substr(e,1);if(e+=s.length,s!==".")return"";const a=qe(n,e);return e+=a.length,a===""?"":s+a+us(n,e)}function Do(n,e){const s=Mn(n,e);return e+=s.length,s===""?"":s+us(n,e)}const jo=ds([No,Bo,Do]);function Uo(n,e){var s;const a=n.substr(e).match(/^[01]+/);return(s=a&&a[0])!==null&&s!==void 0?s:""}function zo(n,e){const s=n.substr(e,2);if(e+=s.length,s.toLowerCase()!=="0b")return"";const a=Uo(n,e);return a===""?"":s+a}function Ho(n,e){var s;const a=n.substr(e).match(/^[0-7]+/);return(s=a&&a[0])!==null&&s!==void 0?s:""}function Ko(n,e){const s=n.substr(e,2);if(e+=s.length,s.toLowerCase()!=="0o")return"";const a=Ho(n,e);return a===""?"":s+a}function $o(n,e){var s;const a=n.substr(e).match(/^[0-9a-f]+/i);return(s=a&&a[0])!==null&&s!==void 0?s:""}function qo(n,e){const s=n.substr(e,2);if(e+=s.length,s.toLowerCase()!=="0x")return"";const a=$o(n,e);return a===""?"":s+a}const Go=ds([zo,Ko,qo]),Yo=ds([Go,jo]);function Xo(n,e){const s=Yo(n,e);return e+=s.length,s===""?null:{evaluable:new Mo(s),cursor:e}}function Wo(n,e){const s=n.substr(e,1);if(e+=s.length,s!=="(")return null;const a=Vn(n,e);if(!a)return null;e=a.cursor,e+=$e(n,e).length;const d=n.substr(e,1);return e+=d.length,d!==")"?null:{evaluable:a.evaluable,cursor:e}}function Jo(n,e){var s;return(s=Xo(n,e))!==null&&s!==void 0?s:Wo(n,e)}function Tn(n,e){const s=Jo(n,e);if(s)return s;const a=n.substr(e,1);if(e+=a.length,a!=="+"&&a!=="-"&&a!=="~")return null;const d=Tn(n,e);return d?(e=d.cursor,{cursor:e,evaluable:new Fo(a,d.evaluable)}):null}function Zo(n,e,s){s+=$e(e,s).length;const a=n.filter(d=>e.startsWith(d,s))[0];return a?(s+=a.length,s+=$e(e,s).length,{cursor:s,operator:a}):null}function Qo(n,e){return(s,a)=>{const d=n(s,a);if(!d)return null;a=d.cursor;let m=d.evaluable;for(;;){const w=Zo(e,s,a);if(!w)break;a=w.cursor;const T=n(s,a);if(!T)return null;a=T.cursor,m=new Vo(w.operator,m,T.evaluable)}return m?{cursor:a,evaluable:m}:null}}const tl=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>Qo(n,e),Tn);function Vn(n,e){return e+=$e(n,e).length,tl(n,e)}function el(n){const e=Vn(n,0);return!e||e.cursor+$e(n,e.cursor).length!==n.length?null:e.evaluable}function Yt(n){var e;const s=el(n);return(e=s==null?void 0:s.evaluate())!==null&&e!==void 0?e:null}function Ln(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Yt(n);if(!g(e))return e}return 0}function il(n){return String(n)}function yt(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}const sl=yt(0);function gi(n){return sl(n)+"%"}function Fn(n){return String(n)}function ps(n){return n}function Ge({primary:n,secondary:e,forward:s,backward:a}){let d=!1;function m(w){d||(d=!0,w(),d=!1)}n.emitter.on("change",w=>{m(()=>{e.setRawValue(s(n,e),w.options)})}),e.emitter.on("change",w=>{m(()=>{n.setRawValue(a(n,e),w.options)}),m(()=>{e.setRawValue(s(n,e),w.options)})}),m(()=>{e.setRawValue(s(n,e),{forceEmit:!1,last:!0})})}function Pt(n,e){const s=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+s:e.downKey?-s:0}function Ye(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Xt(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function nl(n){return n==="ArrowUp"||n==="ArrowDown"}function On(n){return nl(n)||n==="ArrowLeft"||n==="ArrowRight"}function fs(n,e){var s,a;const d=e.ownerDocument.defaultView,m=e.getBoundingClientRect();return{x:n.pageX-(((s=d&&d.scrollX)!==null&&s!==void 0?s:0)+m.left),y:n.pageY-(((a=d&&d.scrollY)!==null&&a!==void 0?a:0)+m.top)}}class fe{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new C,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const s=this.elem_.getBoundingClientRect();return{bounds:{width:s.width,height:s.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var s;e.preventDefault(),(s=e.currentTarget)===null||s===void 0||s.focus();const a=this.elem_.ownerDocument;a.addEventListener("mousemove",this.onDocumentMouseMove_),a.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(fs(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(fs(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const s=this.elem_.ownerDocument;s.removeEventListener("mousemove",this.onDocumentMouseMove_),s.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(fs(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const s=e.targetTouches.item(0),a=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(s?{x:s.clientX-a.left,y:s.clientY-a.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=s}onTouchMove_(e){const s=e.targetTouches.item(0),a=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(s?{x:s.clientX-a.left,y:s.clientY-a.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=s}onTouchEnd_(e){var s;const a=(s=e.targetTouches.item(0))!==null&&s!==void 0?s:this.lastTouch_,d=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(a?{x:a.clientX-d.left,y:a.clientY-d.top}:void 0),sender:this,shiftKey:e.shiftKey})}}function ot(n,e,s,a,d){const m=(n-e)/(s-e);return a+m*(d-a)}function In(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function mt(n,e,s){return Math.min(Math.max(n,e),s)}function Nn(n,e){return(n%e+e)%e}const Vt=E("txt");class rl{constructor(e,s){this.onChange_=this.onChange_.bind(this),this.props_=s.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Vt(),Vt(void 0,"num")),s.arrayPosition&&this.element.classList.add(Vt(void 0,s.arrayPosition)),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("input");a.classList.add(Vt("i")),a.type="text",s.viewProps.bindDisabled(a),this.element.appendChild(a),this.inputElement=a,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=s.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Vt()),this.inputElement.classList.add(Vt("i"));const d=e.createElement("div");d.classList.add(Vt("k")),this.element.appendChild(d),this.knobElement=d;const m=e.createElementNS(zt,"svg");m.classList.add(Vt("g")),this.knobElement.appendChild(m);const w=e.createElementNS(zt,"path");w.classList.add(Vt("gb")),m.appendChild(w),this.guideBodyElem_=w;const T=e.createElementNS(zt,"path");T.classList.add(Vt("gh")),m.appendChild(T),this.guideHeadElem_=T;const B=e.createElement("div");B.classList.add(E("tt")()),this.knobElement.appendChild(B),this.tooltipElem_=B,s.value.emitter.on("change",this.onChange_),this.value=s.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(Vt(void 0,"drg"));return}this.element.classList.add(Vt(void 0,"drg"));const s=e.rawValue/this.props_.get("draggingScale"),a=s+(s>0?-1:s<0?1:0),d=mt(-a,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${a+d},0 L${a},4 L${a+d},8`,`M ${s},-1 L${s},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${s},4`);const m=this.props_.get("formatter");this.tooltipElem_.textContent=m(this.value.rawValue),this.tooltipElem_.style.left=`${s}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class Xe{constructor(e,s){var a;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=s.baseStep,this.parser_=s.parser,this.props=s.props,this.sliderProps_=(a=s.sliderProps)!==null&&a!==void 0?a:null,this.value=s.value,this.viewProps=s.viewProps,this.dragging_=it(null),this.view=new rl(e,{arrayPosition:s.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const d=new fe(this.view.knobElement);d.emitter.on("down",this.onPointerDown_),d.emitter.on("move",this.onPointerMove_),d.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var s,a;const d=(s=this.sliderProps_)===null||s===void 0?void 0:s.get("minValue"),m=(a=this.sliderProps_)===null||a===void 0?void 0:a.get("maxValue");let w=e;return d!==void 0&&(w=Math.max(w,d)),m!==void 0&&(w=Math.min(w,m)),w}onInputChange_(e){const a=e.currentTarget.value,d=this.parser_(a);g(d)||(this.value.rawValue=this.constrainValue_(d)),this.view.refresh()}onInputKeyDown_(e){const s=Pt(this.baseStep_,Ye(e));s!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+s),{forceEmit:!1,last:!1})}onInputKeyUp_(e){Pt(this.baseStep_,Ye(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const s=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+s*this.props.get("draggingScale"))}onPointerMove_(e){const s=this.computeDraggingValue_(e.data);s!==null&&(this.value.setRawValue(s,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const s=this.computeDraggingValue_(e.data);s!==null&&(this.value.setRawValue(s,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const _s=E("sld");class al{constructor(e,s){this.onChange_=this.onChange_.bind(this),this.props_=s.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(_s()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("div");a.classList.add(_s("t")),s.viewProps.bindTabIndex(a),this.element.appendChild(a),this.trackElement=a;const d=e.createElement("div");d.classList.add(_s("k")),this.trackElement.appendChild(d),this.knobElement=d,s.value.emitter.on("change",this.onChange_),this.value=s.value,this.update_()}update_(){const e=mt(ot(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class ol{constructor(e,s){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=s.baseStep,this.value=s.value,this.viewProps=s.viewProps,this.props=s.props,this.view=new al(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new fe(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,s){e.point&&this.value.setRawValue(ot(mt(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),s)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const s=Pt(this.baseStep_,Xt(e));s!==0&&this.value.setRawValue(this.value.rawValue+s,{forceEmit:!1,last:!1})}onKeyUp_(e){Pt(this.baseStep_,Xt(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const ms=E("sldtxt");class ll{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(ms());const a=e.createElement("div");a.classList.add(ms("s")),this.sliderView_=s.sliderView,a.appendChild(this.sliderView_.element),this.element.appendChild(a);const d=e.createElement("div");d.classList.add(ms("t")),this.textView_=s.textView,d.appendChild(this.textView_.element),this.element.appendChild(d)}}class gs{constructor(e,s){this.value=s.value,this.viewProps=s.viewProps,this.sliderC_=new ol(e,{baseStep:s.baseStep,props:s.sliderProps,value:s.value,viewProps:this.viewProps}),this.textC_=new Xe(e,{baseStep:s.baseStep,parser:s.parser,props:s.textProps,sliderProps:s.sliderProps,value:s.value,viewProps:s.viewProps}),this.view=new ll(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function We(n,e){n.write(e)}function vi(n){const e=et;if(Array.isArray(n))return e.required.array(e.required.object({text:e.required.string,value:e.required.raw}))(n).value;if(typeof n=="object")return e.required.raw(n).value}function Bn(n){if(n==="inline"||n==="popup")return n}function ee(n){const e=et;return e.required.object({max:e.optional.number,min:e.optional.number,step:e.optional.number})(n).value}function Dn(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(s=>{e.push({text:s,value:n[s]})}),e}function vs(n){return g(n)?null:new He(Dn(n))}function hl(n){const e=n?Gt(n,_i):null;return e?e.step:null}function bi(n,e){const s=n&&Gt(n,_i);return s?In(s.step):Math.max(In(e),2)}function Ee(n){const e=hl(n);return e??1}function Se(n,e){var s;const a=n&&Gt(n,_i),d=Math.abs((s=a==null?void 0:a.step)!==null&&s!==void 0?s:e);return d===0?.1:Math.pow(10,Math.floor(Math.log10(d))-1)}const yi=E("ckb");class cl{constructor(e,s){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(yi()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("label");a.classList.add(yi("l")),this.element.appendChild(a);const d=e.createElement("input");d.classList.add(yi("i")),d.type="checkbox",a.appendChild(d),this.inputElement=d,s.viewProps.bindDisabled(this.inputElement);const m=e.createElement("div");m.classList.add(yi("w")),a.appendChild(m);const w=ui(e,"check");m.appendChild(w),s.value.emitter.on("change",this.onValueChange_),this.value=s.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class dl{constructor(e,s){this.onInputChange_=this.onInputChange_.bind(this),this.value=s.value,this.viewProps=s.viewProps,this.view=new cl(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const s=e.currentTarget;this.value.rawValue=s.checked}}function ul(n){const e=[],s=vs(n.options);return s&&e.push(s),new ze(e)}const pl={id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const a=st(e,{options:et.optional.custom(vi)});return a?{initialValue:n,params:a}:null},binding:{reader:n=>An,constraint:n=>ul(n.params),writer:n=>We},controller:n=>{const e=n.document,s=n.value,a=n.constraint,d=a&&Gt(a,He);return d?new Ke(e,{props:new N({options:d.values.value("options")}),value:s,viewProps:n.viewProps}):new dl(e,{value:s,viewProps:n.viewProps})}},_e=E("col");class fl{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(_e()),s.foldable.bindExpandedClass(this.element,_e(void 0,"expanded")),U(s.foldable,"completed",I(this.element,_e(void 0,"cpl")));const a=e.createElement("div");a.classList.add(_e("h")),this.element.appendChild(a);const d=e.createElement("div");d.classList.add(_e("s")),a.appendChild(d),this.swatchElement=d;const m=e.createElement("div");if(m.classList.add(_e("t")),a.appendChild(m),this.textElement=m,s.pickerLayout==="inline"){const w=e.createElement("div");w.classList.add(_e("p")),this.element.appendChild(w),this.pickerElement=w}else this.pickerElement=null}}function _l(n,e,s){const a=mt(n/255,0,1),d=mt(e/255,0,1),m=mt(s/255,0,1),w=Math.max(a,d,m),T=Math.min(a,d,m),B=w-T;let z=0,Z=0;const tt=(T+w)/2;return B!==0&&(Z=B/(1-Math.abs(w+T-1)),a===w?z=(d-m)/B:d===w?z=2+(m-a)/B:z=4+(a-d)/B,z=z/6+(z<0?1:0)),[z*360,Z*100,tt*100]}function ml(n,e,s){const a=(n%360+360)%360,d=mt(e/100,0,1),m=mt(s/100,0,1),w=(1-Math.abs(2*m-1))*d,T=w*(1-Math.abs(a/60%2-1)),B=m-w/2;let z,Z,tt;return a>=0&&a<60?[z,Z,tt]=[w,T,0]:a>=60&&a<120?[z,Z,tt]=[T,w,0]:a>=120&&a<180?[z,Z,tt]=[0,w,T]:a>=180&&a<240?[z,Z,tt]=[0,T,w]:a>=240&&a<300?[z,Z,tt]=[T,0,w]:[z,Z,tt]=[w,0,T],[(z+B)*255,(Z+B)*255,(tt+B)*255]}function gl(n,e,s){const a=mt(n/255,0,1),d=mt(e/255,0,1),m=mt(s/255,0,1),w=Math.max(a,d,m),T=Math.min(a,d,m),B=w-T;let z;B===0?z=0:w===a?z=60*(((d-m)/B%6+6)%6):w===d?z=60*((m-a)/B+2):z=60*((a-d)/B+4);const Z=w===0?0:B/w,tt=w;return[z,Z*100,tt*100]}function jn(n,e,s){const a=Nn(n,360),d=mt(e/100,0,1),m=mt(s/100,0,1),w=m*d,T=w*(1-Math.abs(a/60%2-1)),B=m-w;let z,Z,tt;return a>=0&&a<60?[z,Z,tt]=[w,T,0]:a>=60&&a<120?[z,Z,tt]=[T,w,0]:a>=120&&a<180?[z,Z,tt]=[0,w,T]:a>=180&&a<240?[z,Z,tt]=[0,T,w]:a>=240&&a<300?[z,Z,tt]=[T,0,w]:[z,Z,tt]=[w,0,T],[(z+B)*255,(Z+B)*255,(tt+B)*255]}function vl(n,e,s){const a=s+e*(100-Math.abs(2*s-100))/200;return[n,a!==0?e*(100-Math.abs(2*s-100))/a:0,s+e*(100-Math.abs(2*s-100))/(2*100)]}function bl(n,e,s){const a=100-Math.abs(s*(200-e)/100-100);return[n,a!==0?e*s/a:0,s*(200-e)/(2*100)]}function me(n){return[n[0],n[1],n[2]]}function Un(n,e){return[n[0],n[1],n[2],e]}const yl={hsl:{hsl:(n,e,s)=>[n,e,s],hsv:vl,rgb:ml},hsv:{hsl:bl,hsv:(n,e,s)=>[n,e,s],rgb:jn},rgb:{hsl:_l,hsv:gl,rgb:(n,e,s)=>[n,e,s]}};function wi(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function wl(n,e){return n===e?e:Nn(n,e)}function xl(n,e,s){var a;const d=wi(e,s);return[e==="rgb"?mt(n[0],0,d[0]):wl(n[0],d[0]),mt(n[1],0,d[1]),mt(n[2],0,d[2]),mt((a=n[3])!==null&&a!==void 0?a:1,0,1)]}function zn(n,e,s,a){const d=wi(e,s),m=wi(e,a);return n.map((w,T)=>w/d[T]*m[T])}function kl(n,e,s){const a=zn(n,e.mode,e.type,"int"),d=yl[e.mode][s.mode](...a);return zn(d,s.mode,"int",s.type)}function xi(n,e){return typeof n!="object"||g(n)?!1:e in n&&typeof n[e]=="number"}class X{static black(e="int"){return new X([0,0,0],"rgb",e)}static fromObject(e,s="int"){const a="a"in e?[e.r,e.g,e.b,e.a]:[e.r,e.g,e.b];return new X(a,"rgb",s)}static toRgbaObject(e,s="int"){return e.toRgbaObject(s)}static isRgbColorObject(e){return xi(e,"r")&&xi(e,"g")&&xi(e,"b")}static isRgbaColorObject(e){return this.isRgbColorObject(e)&&xi(e,"a")}static isColorObject(e){return this.isRgbColorObject(e)}static equals(e,s){if(e.mode!==s.mode)return!1;const a=e.comps_,d=s.comps_;for(let m=0;m<a.length;m++)if(a[m]!==d[m])return!1;return!0}constructor(e,s,a="int"){this.mode=s,this.type=a,this.comps_=xl(e,s,a)}getComponents(e,s="int"){return Un(kl(me(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:s}),this.comps_[3])}toRgbaObject(e="int"){const s=this.getComponents("rgb",e);return{r:s[0],g:s[1],b:s[2],a:s[3]}}}const ie=E("colp");class Cl{constructor(e,s){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(ie()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("div");a.classList.add(ie("hsv"));const d=e.createElement("div");d.classList.add(ie("sv")),this.svPaletteView_=s.svPaletteView,d.appendChild(this.svPaletteView_.element),a.appendChild(d);const m=e.createElement("div");m.classList.add(ie("h")),this.hPaletteView_=s.hPaletteView,m.appendChild(this.hPaletteView_.element),a.appendChild(m),this.element.appendChild(a);const w=e.createElement("div");if(w.classList.add(ie("rgb")),this.textView_=s.textView,w.appendChild(this.textView_.element),this.element.appendChild(w),s.alphaViews){this.alphaViews_={palette:s.alphaViews.palette,text:s.alphaViews.text};const T=e.createElement("div");T.classList.add(ie("a"));const B=e.createElement("div");B.classList.add(ie("ap")),B.appendChild(this.alphaViews_.palette.element),T.appendChild(B);const z=e.createElement("div");z.classList.add(ie("at")),z.appendChild(this.alphaViews_.text.element),T.appendChild(z),this.element.appendChild(T)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(s=>s.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function Pl(n){return n==="int"?"int":n==="float"?"float":void 0}function bs(n){const e=et;return st(n,{alpha:e.optional.boolean,color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Pl)}),expanded:e.optional.boolean,picker:e.optional.custom(Bn)})}function ge(n){return n?.1:1}function ve(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}function El(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function Lt(n,e){const s=n.match(/^(.+)%$/);return Math.min(s?parseFloat(s[1])*.01*e:parseFloat(n),e)}const Sl={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function Hn(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const s=parseFloat(e[1]),a=e[2];return Sl[a](s)}function Kn(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const s=[Lt(e[1],255),Lt(e[2],255),Lt(e[3],255)];return isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function $n(n){return e=>{const s=Kn(e);return s?new X(s,"rgb",n):null}}function qn(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const s=[Lt(e[1],255),Lt(e[2],255),Lt(e[3],255),Lt(e[4],1)];return isNaN(s[0])||isNaN(s[1])||isNaN(s[2])||isNaN(s[3])?null:s}function Gn(n){return e=>{const s=qn(e);return s?new X(s,"rgb",n):null}}function Yn(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const s=[Hn(e[1]),Lt(e[2],100),Lt(e[3],100)];return isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function Xn(n){return e=>{const s=Yn(e);return s?new X(s,"hsl",n):null}}function Wn(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const s=[Hn(e[1]),Lt(e[2],100),Lt(e[3],100),Lt(e[4],1)];return isNaN(s[0])||isNaN(s[1])||isNaN(s[2])||isNaN(s[3])?null:s}function Jn(n){return e=>{const s=Wn(e);return s?new X(s,"hsl",n):null}}function Zn(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const s=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return s?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]:null}function Al(n){const e=Zn(n);return e?new X(e,"rgb","int"):null}function Qn(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),ot(parseInt(e[4]+e[4],16),0,255,0,1)];const s=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return s?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16),ot(parseInt(s[4],16),0,255,0,1)]:null}function Rl(n){const e=Qn(n);return e?new X(e,"rgb","int"):null}function tr(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const s=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function er(n){return e=>{const s=tr(e);return s?new X(s,"rgb",n):null}}function ir(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const s=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(s[0])||isNaN(s[1])||isNaN(s[2])||isNaN(s[3])?null:s}function sr(n){return e=>{const s=ir(e);return s?new X(s,"rgb",n):null}}const Ml=[{parser:Zn,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Qn,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Kn,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:qn,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Yn,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Wn,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:tr,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:ir,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Tl(n){return Ml.reduce((e,{parser:s,result:a})=>e||(s(n)?a:null),null)}function ys(n,e="int"){const s=Tl(n);return s?s.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},s),{type:"int"}):s.notation==="func"?Object.assign(Object.assign({},s),{type:e}):null:null}const nr={int:[Al,Rl,$n("int"),Gn("int"),Xn("int"),Jn("int"),er("int"),sr("int")],float:[$n("float"),Gn("float"),Xn("float"),Jn("float"),er("float"),sr("float")]};function Vl(n){const e=nr[n];return s=>{if(typeof s!="string")return X.black(n);const a=e.reduce((d,m)=>d||m(s),null);return a??X.black(n)}}function ws(n){const e=nr[n];return s=>e.reduce((a,d)=>a||d(s),null)}function rr(n){const e=mt(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function ar(n,e="#"){const s=me(n.getComponents("rgb")).map(rr).join("");return`${e}${s}`}function xs(n,e="#"){const s=n.getComponents("rgb"),a=[s[0],s[1],s[2],s[3]*255].map(rr).join("");return`${e}${a}`}function or(n,e){const s=yt(e==="float"?2:0);return`rgb(${me(n.getComponents("rgb",e)).map(d=>s(d)).join(", ")})`}function Ll(n){return e=>or(e,n)}function ki(n,e){const s=yt(2),a=yt(e==="float"?2:0);return`rgba(${n.getComponents("rgb",e).map((m,w)=>(w===3?s:a)(m)).join(", ")})`}function Fl(n){return e=>ki(e,n)}function Ol(n){const e=[yt(0),gi,gi];return`hsl(${me(n.getComponents("hsl")).map((a,d)=>e[d](a)).join(", ")})`}function Il(n){const e=[yt(0),gi,gi,yt(2)];return`hsla(${n.getComponents("hsl").map((a,d)=>e[d](a)).join(", ")})`}function lr(n,e){const s=yt(e==="float"?2:0),a=["r","g","b"];return`{${me(n.getComponents("rgb",e)).map((m,w)=>`${a[w]}: ${s(m)}`).join(", ")}}`}function Nl(n){return e=>lr(e,n)}function hr(n,e){const s=yt(2),a=yt(e==="float"?2:0),d=["r","g","b","a"];return`{${n.getComponents("rgb",e).map((w,T)=>{const B=T===3?s:a;return`${d[T]}: ${B(w)}`}).join(", ")}}`}function Bl(n){return e=>hr(e,n)}const Dl=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:ar},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:xs},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Ol},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:Il},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"func",type:e},stringifier:Ll(e)},{format:{alpha:!0,mode:"rgb",notation:"func",type:e},stringifier:Fl(e)},{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Nl(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Bl(e)}],[])];function ks(n){return Dl.reduce((e,s)=>e||(El(s.format,n)?s.stringifier:null),null)}const Je=E("apl");class jl{constructor(e,s){this.onValueChange_=this.onValueChange_.bind(this),this.value=s.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Je()),s.viewProps.bindClassModifiers(this.element),s.viewProps.bindTabIndex(this.element);const a=e.createElement("div");a.classList.add(Je("b")),this.element.appendChild(a);const d=e.createElement("div");d.classList.add(Je("c")),a.appendChild(d),this.colorElem_=d;const m=e.createElement("div");m.classList.add(Je("m")),this.element.appendChild(m),this.markerElem_=m;const w=e.createElement("div");w.classList.add(Je("p")),this.markerElem_.appendChild(w),this.previewElem_=w,this.update_()}update_(){const e=this.value.rawValue,s=e.getComponents("rgb"),a=new X([s[0],s[1],s[2],0],"rgb"),d=new X([s[0],s[1],s[2],255],"rgb"),m=["to right",ki(a),ki(d)];this.colorElem_.style.background=`linear-gradient(${m.join(",")})`,this.previewElem_.style.backgroundColor=ki(e);const w=ot(s[3],0,1,0,100);this.markerElem_.style.left=`${w}%`}onValueChange_(){this.update_()}}class Ul{constructor(e,s){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=s.value,this.viewProps=s.viewProps,this.view=new jl(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new fe(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,s){if(!e.point)return;const a=e.point.x/e.bounds.width,d=this.value.rawValue,[m,w,T]=d.getComponents("hsv");this.value.setRawValue(new X([m,w,T,a],"hsv"),s)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const s=Pt(ge(!0),Xt(e));if(s===0)return;const a=this.value.rawValue,[d,m,w,T]=a.getComponents("hsv");this.value.setRawValue(new X([d,m,w,T+s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Pt(ge(!0),Xt(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Ae=E("coltxt");function zl(n){const e=n.createElement("select"),s=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return e.appendChild(s.reduce((a,d)=>{const m=n.createElement("option");return m.textContent=d.text,m.value=d.value,a.appendChild(m),a},n.createDocumentFragment())),e}class Hl{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(Ae()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("div");a.classList.add(Ae("m")),this.modeElem_=zl(e),this.modeElem_.classList.add(Ae("ms")),a.appendChild(this.modeSelectElement),s.viewProps.bindDisabled(this.modeElem_);const d=e.createElement("div");d.classList.add(Ae("mm")),d.appendChild(ui(e,"dropdown")),a.appendChild(d),this.element.appendChild(a);const m=e.createElement("div");m.classList.add(Ae("w")),this.element.appendChild(m),this.textsElem_=m,this.textViews_=s.textViews,this.applyTextViews_(),O(s.colorMode,w=>{this.modeElem_.value=w})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(e){this.textViews_=e,this.applyTextViews_()}applyTextViews_(){ln(this.textsElem_);const e=this.element.ownerDocument;this.textViews_.forEach(s=>{const a=e.createElement("div");a.classList.add(Ae("c")),a.appendChild(s.element),this.textsElem_.appendChild(a)})}}function Kl(n){return yt(n==="float"?2:0)}function $l(n,e,s){const a=wi(n,e)[s];return new Pe({min:0,max:a})}function Cs(n,e,s){return new Xe(n,{arrayPosition:s===0?"fst":s===3-1?"lst":"mid",baseStep:ge(!1),parser:e.parser,props:N.fromObject({draggingScale:e.colorType==="float"?.01:1,formatter:Kl(e.colorType)}),value:it(0,{constraint:$l(e.colorMode,e.colorType,s)}),viewProps:e.viewProps})}class ql{constructor(e,s){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=s.colorType,this.parser_=s.parser,this.value=s.value,this.viewProps=s.viewProps,this.colorMode=it(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Hl(e,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const s={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},a=[Cs(e,s,0),Cs(e,s,1),Cs(e,s,2)];return a.forEach((d,m)=>{Ge({primary:this.value,secondary:d.value,forward:w=>w.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[m],backward:(w,T)=>{const B=this.colorMode.rawValue,z=w.rawValue.getComponents(B,this.colorType_);return z[m]=T.rawValue,new X(Un(me(z),z[3]),B,this.colorType_)}})}),a}onModeSelectChange_(e){const s=e.currentTarget;this.colorMode.rawValue=s.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const Ps=E("hpl");class Gl{constructor(e,s){this.onValueChange_=this.onValueChange_.bind(this),this.value=s.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Ps()),s.viewProps.bindClassModifiers(this.element),s.viewProps.bindTabIndex(this.element);const a=e.createElement("div");a.classList.add(Ps("c")),this.element.appendChild(a);const d=e.createElement("div");d.classList.add(Ps("m")),this.element.appendChild(d),this.markerElem_=d,this.update_()}update_(){const e=this.value.rawValue,[s]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=or(new X([s,100,100],"hsv"));const a=ot(s,0,360,0,100);this.markerElem_.style.left=`${a}%`}onValueChange_(){this.update_()}}class Yl{constructor(e,s){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=s.value,this.viewProps=s.viewProps,this.view=new Gl(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new fe(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,s){if(!e.point)return;const a=ot(mt(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),d=this.value.rawValue,[,m,w,T]=d.getComponents("hsv");this.value.setRawValue(new X([a,m,w,T],"hsv"),s)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const s=Pt(ge(!1),Xt(e));if(s===0)return;const a=this.value.rawValue,[d,m,w,T]=a.getComponents("hsv");this.value.setRawValue(new X([d+s,m,w,T],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Pt(ge(!1),Xt(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Es=E("svp"),cr=64;class Xl{constructor(e,s){this.onValueChange_=this.onValueChange_.bind(this),this.value=s.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Es()),s.viewProps.bindClassModifiers(this.element),s.viewProps.bindTabIndex(this.element);const a=e.createElement("canvas");a.height=cr,a.width=cr,a.classList.add(Es("c")),this.element.appendChild(a),this.canvasElement=a;const d=e.createElement("div");d.classList.add(Es("m")),this.element.appendChild(d),this.markerElem_=d,this.update_()}update_(){const e=qa(this.canvasElement);if(!e)return;const a=this.value.rawValue.getComponents("hsv"),d=this.canvasElement.width,m=this.canvasElement.height,w=e.getImageData(0,0,d,m),T=w.data;for(let Z=0;Z<m;Z++)for(let tt=0;tt<d;tt++){const be=ot(tt,0,d,0,100),Qe=ot(Z,0,m,100,0),ti=jn(a[0],be,Qe),Ci=(Z*d+tt)*4;T[Ci]=ti[0],T[Ci+1]=ti[1],T[Ci+2]=ti[2],T[Ci+3]=255}e.putImageData(w,0,0);const B=ot(a[1],0,100,0,100);this.markerElem_.style.left=`${B}%`;const z=ot(a[2],0,100,100,0);this.markerElem_.style.top=`${z}%`}onValueChange_(){this.update_()}}class Wl{constructor(e,s){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=s.value,this.viewProps=s.viewProps,this.view=new Xl(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new fe(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,s){if(!e.point)return;const a=ot(e.point.x,0,e.bounds.width,0,100),d=ot(e.point.y,0,e.bounds.height,100,0),[m,,,w]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new X([m,a,d,w],"hsv"),s)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){On(e.key)&&e.preventDefault();const[s,a,d,m]=this.value.rawValue.getComponents("hsv"),w=ge(!1),T=Pt(w,Xt(e)),B=Pt(w,Ye(e));T===0&&B===0||this.value.setRawValue(new X([s,a+T,d+B,m],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const s=ge(!1),a=Pt(s,Xt(e)),d=Pt(s,Ye(e));a===0&&d===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Jl{constructor(e,s){this.value=s.value,this.viewProps=s.viewProps,this.hPaletteC_=new Yl(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Wl(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=s.supportsAlpha?{palette:new Ul(e,{value:this.value,viewProps:this.viewProps}),text:new Xe(e,{parser:Yt,baseStep:.1,props:N.fromObject({draggingScale:.01,formatter:yt(2)}),value:it(0,{constraint:new Pe({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ge({primary:this.value,secondary:this.alphaIcs_.text.value,forward:a=>a.rawValue.getComponents()[3],backward:(a,d)=>{const m=a.rawValue.getComponents();return m[3]=d.rawValue,new X(m,a.rawValue.mode)}}),this.textC_=new ql(e,{colorType:s.colorType,parser:Yt,value:this.value,viewProps:this.viewProps}),this.view=new Cl(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:s.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const Ss=E("colsw");class Zl{constructor(e,s){this.onValueChange_=this.onValueChange_.bind(this),s.value.emitter.on("change",this.onValueChange_),this.value=s.value,this.element=e.createElement("div"),this.element.classList.add(Ss()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("div");a.classList.add(Ss("sw")),this.element.appendChild(a),this.swatchElem_=a;const d=e.createElement("button");d.classList.add(Ss("b")),s.viewProps.bindDisabled(d),this.element.appendChild(d),this.buttonElement=d,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=xs(e)}onValueChange_(){this.update_()}}class Ql{constructor(e,s){this.value=s.value,this.viewProps=s.viewProps,this.view=new Zl(e,{value:this.value,viewProps:this.viewProps})}}class As{constructor(e,s){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=s.value,this.viewProps=s.viewProps,this.foldable_=Ne.create(s.expanded),this.swatchC_=new Ql(e,{value:this.value,viewProps:this.viewProps});const a=this.swatchC_.view.buttonElement;a.addEventListener("blur",this.onButtonBlur_),a.addEventListener("click",this.onButtonClick_),this.textC_=new mi(e,{parser:s.parser,props:N.fromObject({formatter:s.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new fl(e,{foldable:this.foldable_,pickerLayout:s.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=s.pickerLayout==="popup"?new En(e,{viewProps:this.viewProps}):null;const d=new Jl(e,{colorType:s.colorType,supportsAlpha:s.supportsAlpha,value:this.value,viewProps:this.viewProps});d.view.allFocusableElements.forEach(m=>{m.addEventListener("blur",this.onPopupChildBlur_),m.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=d,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(d.view.element),Ge({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:m=>m.rawValue,backward:(m,w)=>w.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),es(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const s=this.view.element,a=e.relatedTarget;(!a||!s.contains(a))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const s=this.popC_.view.element,a=hn(e);a&&s.contains(a)||a&&a===this.swatchC_.view.buttonElement&&!ts(s.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function th(n,e){return X.isColorObject(n)?X.fromObject(n,e):X.black(e)}function eh(n){return me(n.getComponents("rgb")).reduce((e,s)=>e<<8|Math.floor(s)&255,0)}function ih(n){return n.getComponents("rgb").reduce((e,s,a)=>{const d=Math.floor(a===3?s*255:s)&255;return e<<8|d},0)>>>0}function sh(n){return new X([n>>16&255,n>>8&255,n&255],"rgb")}function nh(n){return new X([n>>24&255,n>>16&255,n>>8&255,ot(n&255,0,255,0,1)],"rgb")}function rh(n){return typeof n!="number"?X.black():sh(n)}function ah(n){return typeof n!="number"?X.black():nh(n)}function oh(n){const e=ks(n);return e?(s,a)=>{We(s,e(a))}:null}function lh(n){const e=n?ih:eh;return(s,a)=>{We(s,e(a))}}function hh(n,e,s){const a=e.toRgbaObject(s);n.writeProperty("r",a.r),n.writeProperty("g",a.g),n.writeProperty("b",a.b),n.writeProperty("a",a.a)}function ch(n,e,s){const a=e.toRgbaObject(s);n.writeProperty("r",a.r),n.writeProperty("g",a.g),n.writeProperty("b",a.b)}function dh(n,e){return(s,a)=>{n?hh(s,a,e):ch(s,a,e)}}function Rs(n){var e;return!!(n!=null&&n.alpha||!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function uh(n){return n?e=>xs(e,"0x"):e=>ar(e,"0x")}function ph(n){return"color"in n||"view"in n&&n.view==="color"}const fh={id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!ph(e))return null;const s=bs(e);return s?{initialValue:n,params:s}:null},binding:{reader:n=>Rs(n.params)?ah:rh,equals:X.equals,writer:n=>lh(Rs(n.params))},controller:n=>{const e=Rs(n.params),s="expanded"in n.params?n.params.expanded:void 0,a="picker"in n.params?n.params.picker:void 0;return new As(n.document,{colorType:"int",expanded:s??!1,formatter:uh(e),parser:ws("int"),pickerLayout:a??"popup",supportsAlpha:e,value:n.value,viewProps:n.viewProps})}};function _h(n){return X.isRgbaColorObject(n)}function mh(n){return e=>th(e,n)}function gh(n,e){return s=>n?hr(s,e):lr(s,e)}const vh={id:"input-color-object",type:"input",accept:(n,e)=>{if(!X.isColorObject(n))return null;const s=bs(e);return s?{initialValue:n,params:s}:null},binding:{reader:n=>mh(ve(n.params)),equals:X.equals,writer:n=>dh(_h(n.initialValue),ve(n.params))},controller:n=>{var e;const s=X.isRgbaColorObject(n.initialValue),a="expanded"in n.params?n.params.expanded:void 0,d="picker"in n.params?n.params.picker:void 0,m=(e=ve(n.params))!==null&&e!==void 0?e:"int";return new As(n.document,{colorType:m,expanded:a??!1,formatter:gh(s,m),parser:ws(m),pickerLayout:d??"popup",supportsAlpha:s,value:n.value,viewProps:n.viewProps})}},bh={id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||"view"in e&&e.view==="text")return null;const s=ys(n,ve(e));if(!s||!ks(s))return null;const d=bs(e);return d?{initialValue:n,params:d}:null},binding:{reader:n=>{var e;return Vl((e=ve(n.params))!==null&&e!==void 0?e:"int")},equals:X.equals,writer:n=>{const e=ys(n.initialValue,ve(n.params));if(!e)throw P.shouldNeverHappen();const s=oh(e);if(!s)throw P.notBindable();return s}},controller:n=>{const e=ys(n.initialValue,ve(n.params));if(!e)throw P.shouldNeverHappen();const s=ks(e);if(!s)throw P.shouldNeverHappen();const a="expanded"in n.params?n.params.expanded:void 0,d="picker"in n.params?n.params.picker:void 0;return new As(n.document,{colorType:e.type,expanded:a??!1,formatter:s,parser:ws(e.type),pickerLayout:d??"popup",supportsAlpha:e.alpha,value:n.value,viewProps:n.viewProps})}};class se{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const s=this.asm_.toComponents(e).map((a,d)=>{var m,w;return(w=(m=this.components[d])===null||m===void 0?void 0:m.constrain(a))!==null&&w!==void 0?w:a});return this.asm_.fromComponents(s)}}const dr=E("pndtxt");class yh{constructor(e,s){this.textViews=s.textViews,this.element=e.createElement("div"),this.element.classList.add(dr()),this.textViews.forEach(a=>{const d=e.createElement("div");d.classList.add(dr("a")),d.appendChild(a.element),this.element.appendChild(d)})}}function wh(n,e,s){return new Xe(n,{arrayPosition:s===0?"fst":s===e.axes.length-1?"lst":"mid",baseStep:e.axes[s].baseStep,parser:e.parser,props:e.axes[s].textProps,value:it(0,{constraint:e.axes[s].constraint}),viewProps:e.viewProps})}class Ms{constructor(e,s){this.value=s.value,this.viewProps=s.viewProps,this.acs_=s.axes.map((a,d)=>wh(e,s,d)),this.acs_.forEach((a,d)=>{Ge({primary:this.value,secondary:a.value,forward:m=>s.assembly.toComponents(m.rawValue)[d],backward:(m,w)=>{const T=s.assembly.toComponents(m.rawValue);return T[d]=w.rawValue,s.assembly.fromComponents(T)}})}),this.view=new yh(e,{textViews:this.acs_.map(a=>a.view)})}}function ur(n,e){return"step"in n&&!g(n.step)?new _i(n.step,e):null}function pr(n){return!g(n.max)&&!g(n.min)?new Pe({max:n.max,min:n.min}):!g(n.max)||!g(n.min)?new Cn({max:n.max,min:n.min}):null}function xh(n){const e=Gt(n,Pe);if(e)return[e.values.get("min"),e.values.get("max")];const s=Gt(n,Cn);return s?[s.minValue,s.maxValue]:[void 0,void 0]}function kh(n,e){const s=[],a=ur(n,e);a&&s.push(a);const d=pr(n);d&&s.push(d);const m=vs(n.options);return m&&s.push(m),new ze(s)}const Ch={id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const s=et,a=st(e,{format:s.optional.function,max:s.optional.number,min:s.optional.number,options:s.optional.custom(vi),step:s.optional.number});return a?{initialValue:n,params:a}:null},binding:{reader:n=>Ln,constraint:n=>kh(n.params,n.initialValue),writer:n=>We},controller:n=>{var e;const s=n.value,a=n.constraint,d=a&&Gt(a,He);if(d)return new Ke(n.document,{props:new N({options:d.values.value("options")}),value:s,viewProps:n.viewProps});const m=(e="format"in n.params?n.params.format:void 0)!==null&&e!==void 0?e:yt(bi(a,s.rawValue)),w=a&&Gt(a,Pe);return w?new gs(n.document,{baseStep:Ee(a),parser:Yt,sliderProps:new N({maxValue:w.values.value("max"),minValue:w.values.value("min")}),textProps:N.fromObject({draggingScale:Se(a,s.rawValue),formatter:m}),value:s,viewProps:n.viewProps}):new Xe(n.document,{baseStep:Ee(a),parser:Yt,props:N.fromObject({draggingScale:Se(a,s.rawValue),formatter:m}),value:s,viewProps:n.viewProps})}};class ne{constructor(e=0,s=0){this.x=e,this.y=s}getComponents(){return[this.x,this.y]}static isObject(e){if(g(e))return!1;const s=e.x,a=e.y;return!(typeof s!="number"||typeof a!="number")}static equals(e,s){return e.x===s.x&&e.y===s.y}toObject(){return{x:this.x,y:this.y}}}const fr={toComponents:n=>n.getComponents(),fromComponents:n=>new ne(...n)},Re=E("p2d");class Ph{constructor(e,s){this.element=e.createElement("div"),this.element.classList.add(Re()),s.viewProps.bindClassModifiers(this.element),O(s.expanded,I(this.element,Re(void 0,"expanded")));const a=e.createElement("div");a.classList.add(Re("h")),this.element.appendChild(a);const d=e.createElement("button");d.classList.add(Re("b")),d.appendChild(ui(e,"p2dpad")),s.viewProps.bindDisabled(d),a.appendChild(d),this.buttonElement=d;const m=e.createElement("div");if(m.classList.add(Re("t")),a.appendChild(m),this.textElement=m,s.pickerLayout==="inline"){const w=e.createElement("div");w.classList.add(Re("p")),this.element.appendChild(w),this.pickerElement=w}else this.pickerElement=null}}const re=E("p2dp");class Eh{constructor(e,s){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=s.invertsY,this.maxValue_=s.maxValue,this.element=e.createElement("div"),this.element.classList.add(re()),s.layout==="popup"&&this.element.classList.add(re(void 0,"p")),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("div");a.classList.add(re("p")),s.viewProps.bindTabIndex(a),this.element.appendChild(a),this.padElement=a;const d=e.createElementNS(zt,"svg");d.classList.add(re("g")),this.padElement.appendChild(d),this.svgElem_=d;const m=e.createElementNS(zt,"line");m.classList.add(re("ax")),m.setAttributeNS(null,"x1","0"),m.setAttributeNS(null,"y1","50%"),m.setAttributeNS(null,"x2","100%"),m.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(m);const w=e.createElementNS(zt,"line");w.classList.add(re("ax")),w.setAttributeNS(null,"x1","50%"),w.setAttributeNS(null,"y1","0"),w.setAttributeNS(null,"x2","50%"),w.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(w);const T=e.createElementNS(zt,"line");T.classList.add(re("l")),T.setAttributeNS(null,"x1","50%"),T.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(T),this.lineElem_=T;const B=e.createElement("div");B.classList.add(re("m")),this.padElement.appendChild(B),this.markerElem_=B,s.value.emitter.on("change",this.onValueChange_),this.value=s.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,s]=this.value.rawValue.getComponents(),a=this.maxValue_,d=ot(e,-a,+a,0,100),m=ot(s,-a,+a,0,100),w=this.invertsY_?100-m:m;this.lineElem_.setAttributeNS(null,"x2",`${d}%`),this.lineElem_.setAttributeNS(null,"y2",`${w}%`),this.markerElem_.style.left=`${d}%`,this.markerElem_.style.top=`${w}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function _r(n,e,s){return[Pt(e[0],Xt(n)),Pt(e[1],Ye(n))*(s?1:-1)]}class Sh{constructor(e,s){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=s.value,this.viewProps=s.viewProps,this.baseSteps_=s.baseSteps,this.maxValue_=s.maxValue,this.invertsY_=s.invertsY,this.view=new Eh(e,{invertsY:this.invertsY_,layout:s.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new fe(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,s){if(!e.point)return;const a=this.maxValue_,d=ot(e.point.x,0,e.bounds.width,-a,+a),m=ot(this.invertsY_?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-a,+a);this.value.setRawValue(new ne(d,m),s)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){On(e.key)&&e.preventDefault();const[s,a]=_r(e,this.baseSteps_,this.invertsY_);s===0&&a===0||this.value.setRawValue(new ne(this.value.rawValue.x+s,this.value.rawValue.y+a),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[s,a]=_r(e,this.baseSteps_,this.invertsY_);s===0&&a===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ah{constructor(e,s){var a,d;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=s.value,this.viewProps=s.viewProps,this.foldable_=Ne.create(s.expanded),this.popC_=s.pickerLayout==="popup"?new En(e,{viewProps:this.viewProps}):null;const m=new Sh(e,{baseSteps:[s.axes[0].baseStep,s.axes[1].baseStep],invertsY:s.invertsY,layout:s.pickerLayout,maxValue:s.maxValue,value:this.value,viewProps:this.viewProps});m.view.allFocusableElements.forEach(w=>{w.addEventListener("blur",this.onPopupChildBlur_),w.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=m,this.textC_=new Ms(e,{assembly:fr,axes:s.axes,parser:s.parser,value:this.value,viewProps:this.viewProps}),this.view=new Ph(e,{expanded:this.foldable_.value("expanded"),pickerLayout:s.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(a=this.view.buttonElement)===null||a===void 0||a.addEventListener("blur",this.onPadButtonBlur_),(d=this.view.buttonElement)===null||d===void 0||d.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ge({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:w=>w.rawValue,backward:(w,T)=>T.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),es(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(e){if(!this.popC_)return;const s=this.view.element,a=e.relatedTarget;(!a||!s.contains(a))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const s=this.popC_.view.element,a=hn(e);a&&s.contains(a)||a&&a===this.view.buttonElement&&!ts(s.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}}class Me{constructor(e=0,s=0,a=0){this.x=e,this.y=s,this.z=a}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(g(e))return!1;const s=e.x,a=e.y,d=e.z;return!(typeof s!="number"||typeof a!="number"||typeof d!="number")}static equals(e,s){return e.x===s.x&&e.y===s.y&&e.z===s.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const mr={toComponents:n=>n.getComponents(),fromComponents:n=>new Me(...n)};function Rh(n){return Me.isObject(n)?new Me(n.x,n.y,n.z):new Me}function Mh(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function Th(n,e){return new se({assembly:mr,components:[Wt("x"in n?n.x:void 0,e.x),Wt("y"in n?n.y:void 0,e.y),Wt("z"in n?n.z:void 0,e.z)]})}function Ts(n,e){return{baseStep:Ee(e),constraint:e,textProps:N.fromObject({draggingScale:Se(e,n),formatter:yt(bi(e,n))})}}const Vh={id:"input-point3d",type:"input",accept:(n,e)=>{if(!Me.isObject(n))return null;const s=et,a=st(e,{x:s.optional.custom(ee),y:s.optional.custom(ee),z:s.optional.custom(ee)});return a?{initialValue:n,params:a}:null},binding:{reader:n=>Rh,constraint:n=>Th(n.params,n.initialValue),equals:Me.equals,writer:n=>Mh},controller:n=>{const e=n.value,s=n.constraint;if(!(s instanceof se))throw P.shouldNeverHappen();return new Ms(n.document,{assembly:mr,axes:[Ts(e.rawValue.x,s.components[0]),Ts(e.rawValue.y,s.components[1]),Ts(e.rawValue.z,s.components[2])],parser:Yt,value:e,viewProps:n.viewProps})}};class Te{constructor(e=0,s=0,a=0,d=0){this.x=e,this.y=s,this.z=a,this.w=d}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(g(e))return!1;const s=e.x,a=e.y,d=e.z,m=e.w;return!(typeof s!="number"||typeof a!="number"||typeof d!="number"||typeof m!="number")}static equals(e,s){return e.x===s.x&&e.y===s.y&&e.z===s.z&&e.w===s.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const gr={toComponents:n=>n.getComponents(),fromComponents:n=>new Te(...n)};function Lh(n){return Te.isObject(n)?new Te(n.x,n.y,n.z,n.w):new Te}function Fh(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function Oh(n,e){return new se({assembly:gr,components:[Wt("x"in n?n.x:void 0,e.x),Wt("y"in n?n.y:void 0,e.y),Wt("z"in n?n.z:void 0,e.z),Wt("w"in n?n.w:void 0,e.w)]})}function Ih(n,e){return{baseStep:Ee(e),constraint:e,textProps:N.fromObject({draggingScale:Se(e,n),formatter:yt(bi(e,n))})}}const Nh={id:"input-point4d",type:"input",accept:(n,e)=>{if(!Te.isObject(n))return null;const s=et,a=st(e,{x:s.optional.custom(ee),y:s.optional.custom(ee),z:s.optional.custom(ee),w:s.optional.custom(ee)});return a?{initialValue:n,params:a}:null},binding:{reader:n=>Lh,constraint:n=>Oh(n.params,n.initialValue),equals:Te.equals,writer:n=>Fh},controller:n=>{const e=n.value,s=n.constraint;if(!(s instanceof se))throw P.shouldNeverHappen();return new Ms(n.document,{assembly:gr,axes:e.rawValue.getComponents().map((a,d)=>Ih(a,s.components[d])),parser:Yt,value:e,viewProps:n.viewProps})}};function Bh(n){const e=[],s=vs(n.options);return s&&e.push(s),new ze(e)}const Dh={id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const a=st(e,{options:et.optional.custom(vi)});return a?{initialValue:n,params:a}:null},binding:{reader:n=>Fn,constraint:n=>Bh(n.params),writer:n=>We},controller:n=>{const e=n.document,s=n.value,a=n.constraint,d=a&&Gt(a,He);return d?new Ke(e,{props:new N({options:d.values.value("options")}),value:s,viewProps:n.viewProps}):new mi(e,{parser:m=>m,props:N.fromObject({formatter:ps}),value:s,viewProps:n.viewProps})}},Ze={monitor:{defaultInterval:200,defaultLineCount:3}},vr=E("mll");class jh{constructor(e,s){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=s.formatter,this.element=e.createElement("div"),this.element.classList.add(vr()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("textarea");a.classList.add(vr("i")),a.style.height=`calc(var(--bld-us) * ${s.lineCount})`,a.readOnly=!0,s.viewProps.bindDisabled(a),this.element.appendChild(a),this.textareaElem_=a,s.value.emitter.on("change",this.onValueUpdate_),this.value=s.value,this.update_()}update_(){const e=this.textareaElem_,s=e.scrollTop===e.scrollHeight-e.clientHeight,a=[];this.value.rawValue.forEach(d=>{d!==void 0&&a.push(this.formatter_(d))}),e.textContent=a.join(`
`),s&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class Vs{constructor(e,s){this.value=s.value,this.viewProps=s.viewProps,this.view=new jh(e,{formatter:s.formatter,lineCount:s.lineCount,value:this.value,viewProps:this.viewProps})}}const br=E("sgl");class Uh{constructor(e,s){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=s.formatter,this.element=e.createElement("div"),this.element.classList.add(br()),s.viewProps.bindClassModifiers(this.element);const a=e.createElement("input");a.classList.add(br("i")),a.readOnly=!0,a.type="text",s.viewProps.bindDisabled(a),this.element.appendChild(a),this.inputElement=a,s.value.emitter.on("change",this.onValueUpdate_),this.value=s.value,this.update_()}update_(){const e=this.value.rawValue,s=e[e.length-1];this.inputElement.value=s!==void 0?this.formatter_(s):""}onValueUpdate_(){this.update_()}}class Ls{constructor(e,s){this.value=s.value,this.viewProps=s.viewProps,this.view=new Uh(e,{formatter:s.formatter,value:this.value,viewProps:this.viewProps})}}const zh={id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const a=st(e,{lineCount:et.optional.number});return a?{initialValue:n,params:a}:null},binding:{reader:n=>An},controller:n=>{var e;return n.value.rawValue.length===1?new Ls(n.document,{formatter:Rn,value:n.value,viewProps:n.viewProps}):new Vs(n.document,{formatter:Rn,lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:Ze.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}},ae=E("grl");class Hh{constructor(e,s){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ae()),s.viewProps.bindClassModifiers(this.element),this.formatter_=s.formatter,this.props_=s.props,this.cursor_=s.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const a=e.createElementNS(zt,"svg");a.classList.add(ae("g")),a.style.height=`calc(var(--bld-us) * ${s.lineCount})`,this.element.appendChild(a),this.svgElem_=a;const d=e.createElementNS(zt,"polyline");this.svgElem_.appendChild(d),this.lineElem_=d;const m=e.createElement("div");m.classList.add(ae("t"),E("tt")()),this.element.appendChild(m),this.tooltipElem_=m,s.value.emitter.on("change",this.onValueUpdate_),this.value=s.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),s=this.value.rawValue.length-1,a=this.props_.get("minValue"),d=this.props_.get("maxValue"),m=[];this.value.rawValue.forEach((Z,tt)=>{if(Z===void 0)return;const be=ot(tt,0,s,0,e.width),Qe=ot(Z,a,d,e.height,0);m.push([be,Qe].join(","))}),this.lineElem_.setAttributeNS(null,"points",m.join(" "));const w=this.tooltipElem_,T=this.value.rawValue[this.cursor_.rawValue];if(T===void 0){w.classList.remove(ae("t","a"));return}const B=ot(this.cursor_.rawValue,0,s,0,e.width),z=ot(T,a,d,e.height,0);w.style.left=`${B}px`,w.style.top=`${z}px`,w.textContent=`${this.formatter_(T)}`,w.classList.contains(ae("t","a"))||(w.classList.add(ae("t","a"),ae("t","in")),di(w),w.classList.remove(ae("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Kh{constructor(e,s){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=s.props,this.value=s.value,this.viewProps=s.viewProps,this.cursor_=it(-1),this.view=new Hh(e,{cursor:this.cursor_,formatter:s.formatter,lineCount:s.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!ts(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const a=new fe(this.view.element);a.emitter.on("down",this.onGraphPointerDown_),a.emitter.on("move",this.onGraphPointerMove_),a.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const s=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(ot(e.offsetX,0,s.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(ot(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Fs(n){return"format"in n&&!g(n.format)?n.format:yt(2)}function $h(n){var e;return n.value.rawValue.length===1?new Ls(n.document,{formatter:Fs(n.params),value:n.value,viewProps:n.viewProps}):new Vs(n.document,{formatter:Fs(n.params),lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:Ze.monitor.defaultLineCount,value:n.value,viewProps:n.viewProps})}function qh(n){var e,s,a;return new Kh(n.document,{formatter:Fs(n.params),lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:Ze.monitor.defaultLineCount,props:N.fromObject({maxValue:(s="max"in n.params?n.params.max:null)!==null&&s!==void 0?s:100,minValue:(a="min"in n.params?n.params.min:null)!==null&&a!==void 0?a:0}),value:n.value,viewProps:n.viewProps})}function yr(n){return"view"in n&&n.view==="graph"}const Gh={id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const s=et,a=st(e,{format:s.optional.function,lineCount:s.optional.number,max:s.optional.number,min:s.optional.number,view:s.optional.string});return a?{initialValue:n,params:a}:null},binding:{defaultBufferSize:n=>yr(n)?64:1,reader:n=>Ln},controller:n=>yr(n.params)?qh(n):$h(n)},Yh={id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const s=et,a=st(e,{lineCount:s.optional.number,multiline:s.optional.boolean});return a?{initialValue:n,params:a}:null},binding:{reader:n=>Fn},controller:n=>{var e;const s=n.value;return s.rawValue.length>1||"multiline"in n.params&&n.params.multiline?new Vs(n.document,{formatter:ps,lineCount:(e=n.params.lineCount)!==null&&e!==void 0?e:Ze.monitor.defaultLineCount,value:s,viewProps:n.viewProps}):new Ls(n.document,{formatter:ps,value:s,viewProps:n.viewProps})}};function Xh(n,e){var s;const a=n.accept(e.target.read(),e.params);if(g(a))return null;const d=et,m={target:e.target,initialValue:a.initialValue,params:a.params},w=n.binding.reader(m),T=n.binding.constraint?n.binding.constraint(m):void 0,B=it(w(a.initialValue),{constraint:T,equals:n.binding.equals}),z=new wo({reader:w,target:e.target,value:B,writer:n.binding.writer(m)}),Z=d.optional.boolean(e.params.disabled).value,tt=d.optional.boolean(e.params.hidden).value,be=n.controller({constraint:T,document:e.document,initialValue:a.initialValue,params:a.params,value:z.value,viewProps:qt.create({disabled:Z,hidden:tt})});return new Ht(e.document,{binding:z,blade:Ie(),props:N.fromObject({label:"label"in e.params?(s=d.optional.string(e.params.label).value)!==null&&s!==void 0?s:null:e.target.key}),valueController:be})}function Wh(n,e){return e===0?new bo:new yo(n,e??Ze.monitor.defaultInterval)}function Jh(n,e){var s,a,d;const m=et,w=n.accept(e.target.read(),e.params);if(g(w))return null;const T={target:e.target,initialValue:w.initialValue,params:w.params},B=n.binding.reader(T),z=(a=(s=m.optional.number(e.params.bufferSize).value)!==null&&s!==void 0?s:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(w.params))!==null&&a!==void 0?a:1,Z=m.optional.number(e.params.interval).value,tt=new Po({reader:B,target:e.target,ticker:Wh(e.document,Z),value:xo(z)}),be=m.optional.boolean(e.params.disabled).value,Qe=m.optional.boolean(e.params.hidden).value,ti=n.controller({document:e.document,params:w.params,value:tt.value,viewProps:qt.create({disabled:be,hidden:Qe})});return new te(e.document,{binding:tt,blade:Ie(),props:N.fromObject({label:"label"in e.params?(d=m.optional.string(e.params.label).value)!==null&&d!==void 0?d:null:e.target.key}),valueController:ti})}class Zh{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e){e.type==="blade"?this.pluginsMap_.blades.unshift(e):e.type==="input"?this.pluginsMap_.inputs.unshift(e):e.type==="monitor"&&this.pluginsMap_.monitors.unshift(e)}createInput(e,s,a){const d=s.read();if(g(d))throw new P({context:{key:s.key},type:"nomatchingcontroller"});const m=this.pluginsMap_.inputs.reduce((w,T)=>w??Xh(T,{document:e,target:s,params:a}),null);if(m)return m;throw new P({context:{key:s.key},type:"nomatchingcontroller"})}createMonitor(e,s,a){const d=this.pluginsMap_.monitors.reduce((m,w)=>m??Jh(w,{document:e,params:a,target:s}),null);if(d)return d;throw new P({context:{key:s.key},type:"nomatchingcontroller"})}createBlade(e,s){const a=this.pluginsMap_.blades.reduce((d,m)=>d??vo(m,{document:e,params:s}),null);if(!a)throw new P({type:"nomatchingview",context:{params:s}});return a}createBladeApi(e){if(e instanceof Ht)return new ns(e);if(e instanceof te)return new rs(e);if(e instanceof De)return new fi(e,this);const s=this.pluginsMap_.blades.reduce((a,d)=>a??d.api({controller:e,pool:this}),null);if(!s)throw P.shouldNeverHappen();return s}}function Qh(){const n=new Zh;return[rc,Vh,Nh,Dh,Ch,bh,vh,fh,pl,zh,Yh,Gh,Wa,co,po,xn].forEach(e=>{n.register(e)}),n}function tc(n){return ne.isObject(n)?new ne(n.x,n.y):new ne}function ec(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function Wt(n,e){if(!n)return;const s=[],a=ur(n,e);a&&s.push(a);const d=pr(n);return d&&s.push(d),new ze(s)}function ic(n,e){return new se({assembly:fr,components:[Wt("x"in n?n.x:void 0,e.x),Wt("y"in n?n.y:void 0,e.y)]})}function wr(n,e){const[s,a]=n?xh(n):[];if(!g(s)||!g(a))return Math.max(Math.abs(s??0),Math.abs(a??0));const d=Ee(n);return Math.max(Math.abs(d)*10,Math.abs(e)*10)}function sc(n,e){const s=e instanceof se?e.components[0]:void 0,a=e instanceof se?e.components[1]:void 0,d=wr(s,n.x),m=wr(a,n.y);return Math.max(d,m)}function xr(n,e){return{baseStep:Ee(e),constraint:e,textProps:N.fromObject({draggingScale:Se(e,n),formatter:yt(bi(e,n))})}}function nc(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}const rc={id:"input-point2d",type:"input",accept:(n,e)=>{if(!ne.isObject(n))return null;const s=et,a=st(e,{expanded:s.optional.boolean,picker:s.optional.custom(Bn),x:s.optional.custom(ee),y:s.optional.object({inverted:s.optional.boolean,max:s.optional.number,min:s.optional.number,step:s.optional.number})});return a?{initialValue:n,params:a}:null},binding:{reader:n=>tc,constraint:n=>ic(n.params,n.initialValue),equals:ne.equals,writer:n=>ec},controller:n=>{const e=n.document,s=n.value,a=n.constraint;if(!(a instanceof se))throw P.shouldNeverHappen();const d="expanded"in n.params?n.params.expanded:void 0,m="picker"in n.params?n.params.picker:void 0;return new Ah(e,{axes:[xr(s.rawValue.x,a.components[0]),xr(s.rawValue.y,a.components[1])],expanded:d??!1,invertsY:nc(n.params),maxValue:sc(s.rawValue,a),parser:Yt,pickerLayout:m??"popup",value:s,viewProps:n.viewProps})}};class kr extends l{constructor(e){super(e),this.emitter_=new C,this.controller_.valueController.value.emitter.on("change",s=>{this.emitter_.emit("change",{event:new h(this,s.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get options(){return this.controller_.valueController.props.get("options")}set options(e){this.controller_.valueController.props.set("options",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,s){const a=s.bind(this);return this.emitter_.on(e,d=>{a(d.event)}),this}}class Cr extends l{constructor(e){super(e),this.emitter_=new C,this.controller_.valueController.value.emitter.on("change",s=>{this.emitter_.emit("change",{event:new h(this,s.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(e){this.controller_.valueController.sliderController.props.set("maxValue",e)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(e){this.controller_.valueController.sliderController.props.set("minValue",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,s){const a=s.bind(this);return this.emitter_.on(e,d=>{a(d.event)}),this}}class Pr extends l{constructor(e){super(e),this.emitter_=new C,this.controller_.valueController.value.emitter.on("change",s=>{this.emitter_.emit("change",{event:new h(this,s.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(e){this.controller_.props.set("label",e)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(e){this.controller_.valueController.props.set("formatter",e)}get value(){return this.controller_.valueController.value.rawValue}set value(e){this.controller_.valueController.value.rawValue=e}on(e,s){const a=s.bind(this);return this.emitter_.on(e,d=>{a(d.event)}),this}}const ac=function(){return{id:"list",type:"blade",accept(n){const e=et,s=st(n,{options:e.required.custom(vi),value:e.required.raw,view:e.required.constant("list"),label:e.optional.string});return s?{params:s}:null},controller(n){const e=new He(Dn(n.params.options)),s=it(n.params.value,{constraint:e}),a=new Ke(n.document,{props:new N({options:e.values.value("options")}),value:s,viewProps:n.viewProps});return new Ce(n.document,{blade:n.blade,props:N.fromObject({label:n.params.label}),valueController:a})},api(n){return!(n.controller instanceof Ce)||!(n.controller.valueController instanceof Ke)?null:new kr(n.controller)}}}();function oc(n){return n.reduce((e,s)=>Object.assign(e,{[s.presetKey]:s.read()}),{})}function lc(n,e){n.forEach(s=>{const a=e[s.target.presetKey];a!==void 0&&s.writer(s.target,s.reader(a))})}class hc extends as{constructor(e,s){super(e,s)}get element(){return this.controller_.view.element}importPreset(e){const s=this.controller_.rackController.rack.find(Ht).map(a=>a.binding);lc(s,e),this.refresh()}exportPreset(){const e=this.controller_.rackController.rack.find(Ht).map(s=>s.binding.target);return oc(e)}refresh(){this.controller_.rackController.rack.find(Ht).forEach(e=>{e.binding.read()}),this.controller_.rackController.rack.find(te).forEach(e=>{e.binding.read()})}}class cc extends hs{constructor(e,s){super(e,{expanded:s.expanded,blade:s.blade,props:s.props,root:!0,viewProps:s.viewProps})}}const dc={id:"slider",type:"blade",accept(n){const e=et,s=st(n,{max:e.required.number,min:e.required.number,view:e.required.constant("slider"),format:e.optional.function,label:e.optional.string,value:e.optional.number});return s?{params:s}:null},controller(n){var e,s;const a=(e=n.params.value)!==null&&e!==void 0?e:0,d=new Pe({max:n.params.max,min:n.params.min}),m=new gs(n.document,{baseStep:1,parser:Yt,sliderProps:new N({maxValue:d.values.value("max"),minValue:d.values.value("min")}),textProps:N.fromObject({draggingScale:Se(void 0,a),formatter:(s=n.params.format)!==null&&s!==void 0?s:il}),value:it(a,{constraint:d}),viewProps:n.viewProps});return new Ce(n.document,{blade:n.blade,props:N.fromObject({label:n.params.label}),valueController:m})},api(n){return!(n.controller instanceof Ce)||!(n.controller.valueController instanceof gs)?null:new Cr(n.controller)}},uc=function(){return{id:"text",type:"blade",accept(n){const e=et,s=st(n,{parse:e.required.function,value:e.required.raw,view:e.required.constant("text"),format:e.optional.function,label:e.optional.string});return s?{params:s}:null},controller(n){var e;const s=new mi(n.document,{parser:n.params.parse,props:N.fromObject({formatter:(e=n.params.format)!==null&&e!==void 0?e:a=>String(a)}),value:it(n.params.value),viewProps:n.viewProps});return new Ce(n.document,{blade:n.blade,props:N.fromObject({label:n.params.label}),valueController:s})},api(n){return!(n.controller instanceof Ce)||!(n.controller.valueController instanceof mi)?null:new Pr(n.controller)}}}();function pc(n){const e=n.createElement("div");return e.classList.add(E("dfw")()),n.body&&n.body.appendChild(e),e}function Er(n,e,s){if(n.querySelector(`style[data-tp-style=${e}]`))return;const a=n.createElement("style");a.dataset.tpStyle=e,a.textContent=s,n.head.appendChild(a)}class fc extends hc{constructor(e){var s,a;const d=e??{},m=(s=d.document)!==null&&s!==void 0?s:$a(),w=Qh(),T=new cc(m,{expanded:d.expanded,blade:Ie(),props:N.fromObject({title:d.title}),viewProps:qt.create()});super(T,w),this.pool_=w,this.containerElem_=(a=d.container)!==null&&a!==void 0?a:pc(m),this.containerElem_.appendChild(this.element),this.doc_=m,this.usesDefaultWrapper_=!d.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw P.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw P.alreadyDisposed();if(this.usesDefaultWrapper_){const s=e.parentElement;s&&s.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach(a=>{this.pool_.register(a),this.embedPluginStyle_(a)})}embedPluginStyle_(e){e.css&&Er(this.document,`plugin-${e.id}`,e.css)}setUpDefaultPlugins_(){Er(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(e=>{this.embedPluginStyle_(e)}),this.registerPlugin({plugins:[dc,ac,xn,uc]})}}const _c=new o("3.1.9");r.BladeApi=l,r.ButtonApi=x,r.FolderApi=as,r.InputBindingApi=ns,r.ListApi=kr,r.MonitorBindingApi=rs,r.Pane=fc,r.SeparatorApi=fn,r.SliderApi=Cr,r.TabApi=bn,r.TabPageApi=vn,r.TextApi=Pr,r.TpChangeEvent=h,r.VERSION=_c,Object.defineProperty(r,"__esModule",{value:!0})})})(zs,zs.exports);var gc=zs.exports;function $i(t){return[...Array(t).keys()]}function vc(t,i,r){let o=t[i],l=t[r],c=[...t];return c[i]=l,c[r]=o,c}function bc(t){return t.map(i=>({value:i,sort:Math.random()})).sort((i,r)=>i.sort-r.sort).map(({value:i})=>i)}function ye(t,i){return t+Math.floor(Math.random()*(i-t))}function yc(t){const{generation:i,individuals:r,offspringRatio:o,fitness:l,mutationRate:c}=t,h=Math.floor(r.length*o),u=r.length-h,_=ha(l),f=[...r].sort(_).slice(0,u),y=$i(u).map(v=>{let b=f[ye(0,f.length)],k=f[ye(0,f.length)],P=ye(1,b.length-2);return kc(xc(b,k,P),c)}),g=f.concat(y);return{...t,individuals:g,generation:i+1}}function wc(t){const i=[...t.individuals],r=ha(t.fitness);return i.sort(r)[0]}function ha(t){return(i,r)=>t(r)-t(i)}function xc(t,i,r){let o=t.slice(0,r);return i.forEach(l=>{o.findIndex(c=>JSON.stringify(c)===JSON.stringify(l))===-1&&o.push(l)}),o}function kc(t,i){var r=[...t];return $i(i).forEach(o=>{let l=ye(0,t.length),c=ye(0,t.length);r=vc(t,l,c)}),r}var ca=Object.defineProperty,Cc=(t,i,r)=>i in t?ca(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r,da=(t,i)=>{for(var r in i)ca(t,r,{get:i[r],enumerable:!0})},p=(t,i,r)=>(Cc(t,typeof i!="symbol"?i+"":i,r),r),V={move:"M",line:"L",curve:"C",arc:"A",close:"Z"},ua={};da(ua,{HALF_PI:()=>gt,NumArray:()=>$t,TWO_PI:()=>xt,decomposeMatrix:()=>ni,getComputedMatrix:()=>we,getPoT:()=>_a,lerp:()=>Et,mod:()=>Mt,setMatrix:()=>fa,toFixed:()=>dt});var ut;typeof window<"u"?ut=window:typeof global<"u"?ut=global:typeof self<"u"&&(ut=self);var pa,xt=Math.PI*2,gt=Math.PI*.5;function ni(t,i,r,o,l,c){let h;return arguments.length<=1?(h=t.a,i=t.b,r=t.c,o=t.d,l=t.e,c=t.f):h=t,{translateX:l,translateY:c,scaleX:Math.sqrt(h*h+i*i),scaleY:Math.sqrt(r*r+o*o),rotation:180*Math.atan2(i,h)/Math.PI}}function fa(t){pa=t}function we(t,i){i=i&&i.identity()||new pa;let r=t;const o=[];for(;r&&r._matrix;)o.push(r._matrix),r=r.parent;o.reverse();for(let l=0;l<o.length;l++){const h=o[l].elements;i.multiply(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8],h[9])}return i}function Et(t,i,r){return r*(i-t)+t}var Os=[2,4,8,16,32,64,128,256,512,1024,2048,4096];function _a(t){let i=0;for(;Os[i]&&Os[i]<t;)i++;return Os[i]}function Mt(t,i){for(;t<0;)t+=i;return t%i}var $t=ut.Float32Array||Array,Pc=Math.floor;function dt(t){return Pc(t*1e6)/1e6}var ma={};da(ma,{Curve:()=>Le,getAnchorsFromArcData:()=>Sc,getComponentOnCubicBezier:()=>ri,getControlPoints:()=>wa,getCurveBoundingBox:()=>va,getCurveFromPoints:()=>ya,getCurveLength:()=>ga,getReflection:()=>Hs,integrate:()=>ba,subdivide:()=>Ys});var A=class{constructor(){p(this,"_events",{}),p(this,"_bound",!1)}addEventListener(t,i){return(this._events[t]||(this._events[t]=[])).push(i),this._bound=!0,this}on(){return this.addEventListener.apply(this,arguments)}bind(){return this.addEventListener.apply(this,arguments)}removeEventListener(t,i){if(!this._events)return this;if(!t&&!i)return this._events={},this._bound=!1,this;const r=t?[t]:Object.keys(this._events);for(let o=0,l=r.length;o<l;o++){t=r[o];let c=this._events[t];if(c){let h=[];if(i)for(let u=0,_=c.length;u<_;u++){let f=c[u];f=f.handler?f.handler:f,i!==f&&h.push(f)}this._events[t]=h}}return this}off(){return this.removeEventListener.apply(this,arguments)}unbind(){return this.removeEventListener.apply(this,arguments)}dispatchEvent(t){if(!this._events)return this;const i=Array.prototype.slice.call(arguments,1),r=this._events[t];if(r)for(let o=0;o<r.length;o++)r[o].call(this,...i);return this}trigger(){return this.dispatchEvent.apply(this,arguments)}listen(t,i,r){const o=this;t&&(l.obj=t,l.name=i,l.handler=r,t.on(i,l));function l(){r.apply(o,arguments)}return o}ignore(t,i,r){return t.off(i,r),this}};p(A,"Types",{play:"play",pause:"pause",update:"update",render:"render",resize:"resize",change:"change",remove:"remove",insert:"insert",order:"order",load:"load"});p(A,"Methods",["addEventListener","on","removeEventListener","off","unbind","dispatchEvent","trigger","listen","ignore"]);var Sr={x:{enumerable:!0,get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this._bound&&this.dispatchEvent(A.Types.change))}},y:{enumerable:!0,get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this._bound&&this.dispatchEvent(A.Types.change))}}},Dt=class extends A{constructor(t=0,i=0){super(),p(this,"_x",0),p(this,"_y",0);for(let r in Sr)Object.defineProperty(this,r,Sr[r]);this.x=t,this.y=i}static add(t,i){return new Dt(t.x+i.x,t.y+i.y)}static sub(t,i){return new Dt(t.x-i.x,t.y-i.y)}static subtract(t,i){return Dt.sub(t,i)}static ratioBetween(t,i){return(t.x*i.x+t.y*i.y)/(t.length()*i.length())}static angleBetween(t,i){if(arguments.length>=4){const l=arguments[0]-arguments[2],c=arguments[1]-arguments[3];return Math.atan2(c,l)}const r=t.x-i.x,o=t.y-i.y;return Math.atan2(o,r)}static distanceBetween(t,i){return Math.sqrt(Dt.distanceBetweenSquared(t,i))}static distanceBetweenSquared(t,i){const r=t.x-i.x,o=t.y-i.y;return r*r+o*o}set(t,i){return this.x=t,this.y=i,this}copy(t){return this.x=t.x,this.y=t.y,this}clear(){return this.x=0,this.y=0,this}clone(){return new Dt(this.x,this.y)}add(t,i){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x+=t,this.y+=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x+=t.x,this.y+=t.y):(this.x+=t,this.y+=i),this)}addSelf(t){return this.add.apply(this,arguments)}sub(t,i){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x-=t,this.y-=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x-=t.x,this.y-=t.y):(this.x-=t,this.y-=i),this)}subtract(){return this.sub.apply(this,arguments)}subSelf(t){return this.sub.apply(this,arguments)}subtractSelf(t){return this.sub.apply(this,arguments)}multiply(t,i){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x*=t,this.y*=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x*=t.x,this.y*=t.y):(this.x*=t,this.y*=i),this)}multiplySelf(t){return this.multiply.apply(this,arguments)}multiplyScalar(t){return this.multiply(t)}divide(t,i){return arguments.length<=0?this:(arguments.length<=1?typeof t=="number"?(this.x/=t,this.y/=t):t&&typeof t.x=="number"&&typeof t.y=="number"&&(this.x/=t.x,this.y/=t.y):(this.x/=t,this.y/=i),isNaN(this.x)&&(this.x=0),isNaN(this.y)&&(this.y=0),this)}divideSelf(t){return this.divide.apply(this,arguments)}divideScalar(t){return this.divide(t)}negate(){return this.multiply(-1)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.sqrt(this.lengthSquared())}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return this.divideScalar(this.length())}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,r=this.y-t.y;return i*i+r*r}setLength(t){return this.normalize().multiplyScalar(t)}equals(t,i){return i=typeof i>"u"?1e-4:i,this.distanceTo(t)<i}lerp(t,i){const r=(t.x-this.x)*i+this.x,o=(t.y-this.y)*i+this.y;return this.set(r,o)}isZero(t){return t=typeof t>"u"?1e-4:t,this.length()<t}toString(){return this.x+", "+this.y}toObject(){return{x:this.x,y:this.y}}rotate(t){const i=this.x,r=this.y,o=Math.cos(t),l=Math.sin(t);return this.x=i*o-r*l,this.y=i*l+r*o,this}},L=Dt;p(L,"zero",new Dt);p(L,"left",new Dt(-1,0));p(L,"right",new Dt(1,0));p(L,"up",new Dt(0,-1));p(L,"down",new Dt(0,1));var G=class extends L{constructor(t=0,i=0,r=0,o=0,l=0,c=0,h=V.move){super(t,i),p(this,"controls",{left:new L,right:new L}),p(this,"_command",V.move),p(this,"_relative",!0),p(this,"_rx",0),p(this,"_ry",0),p(this,"_xAxisRotation",0),p(this,"_largeArcFlag",0),p(this,"_sweepFlag",1);for(let _ in Ar)Object.defineProperty(this,_,Ar[_]);this.command=h,this.relative=!0;const u=G.makeBroadcast(this);this.controls.left.set(r,o).addEventListener(A.Types.change,u),this.controls.right.set(l,c).addEventListener(A.Types.change,u)}static makeBroadcast(t){return i;function i(){t._bound&&t.dispatchEvent(A.Types.change)}}copy(t){return this.x=t.x,this.y=t.y,typeof t.command=="string"&&(this.command=t.command),t.controls&&(t.controls.left&&this.controls.left.copy(t.controls.left),t.controls.right&&this.controls.right.copy(t.controls.right)),typeof t.relative=="boolean"&&(this.relative=t.relative),typeof t.rx=="number"&&(this.rx=t.rx),typeof t.ry=="number"&&(this.ry=t.ry),typeof t.xAxisRotation=="number"&&(this.xAxisRotation=t.xAxisRotation),typeof t.largeArcFlag=="number"&&(this.largeArcFlag=t.largeArcFlag),typeof t.sweepFlag=="number"&&(this.sweepFlag=t.sweepFlag),this}clone(){return new G().copy(this)}toObject(){return{x:this.x,y:this.y,command:this.command,relative:this.relative,controls:{left:this.controls.left.toObject(),right:this.controls.right.toObject()},rx:this.rx,ry:this.ry,xAxisRotation:this.xAxisRotation,largeArcFlag:this.largeArcFlag,sweepFlag:this.sweepFlag}}toString(){return JSON.stringify(this.toObject())}},Ar={command:{enumerable:!0,get:function(){return this._command},set:function(t){this._command!==t&&(this._command=t,this._bound&&this.dispatchEvent(A.Types.change))}},relative:{enumerable:!0,get:function(){return this._relative},set:function(t){this._relative!==!!t&&(this._relative=!!t,this._bound&&this.dispatchEvent(A.Types.change))}},rx:{enumerable:!0,get:function(){return this._rx},set:function(t){this._rx!==t&&(this._rx=t,this._bound&&this.dispatchEvent(A.Types.change))}},ry:{enumerable:!0,get:function(){return this._ry},set:function(t){this._ry!==t&&(this._ry=t,this._bound&&this.dispatchEvent(A.Types.change))}},xAxisRotation:{enumerable:!0,get:function(){return this._xAxisRotation},set:function(t){this._xAxisRotation!==t&&(this._xAxisRotation=t,this._bound&&this.dispatchEvent(A.Types.change))}},largeArcFlag:{enumerable:!0,get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag!==t&&(this._largeArcFlag=t,this._bound&&this.dispatchEvent(A.Types.change))}},sweepFlag:{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag!==t&&(this._sweepFlag=t,this._bound&&this.dispatchEvent(A.Types.change))}}},Ec=0,vt={nextFrameID:null,Types:{webgl:"WebGLRenderer",svg:"SVGRenderer",canvas:"CanvasRenderer"},Version:"v0.8.10",PublishDate:"2022-06-09T16:09:22.888Z",Identifier:"two-",Resolution:12,AutoCalculateImportedMatrices:!0,Instances:[],uniqueId:function(){return Ec++}},Le={CollinearityEpsilon:Math.pow(10,-30),RecursionLimit:16,CuspLimit:0,Tolerance:{distance:.25,angle:0,epsilon:Number.EPSILON},abscissas:[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],weights:[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]]};function ri(t,i,r,o,l){const c=1-t;return c*c*c*i+3*c*c*t*r+3*c*t*t*o+t*t*t*l}function Ys(t,i,r,o,l,c,h,u,_){_=_||Le.RecursionLimit;const f=_+1;if(Math.abs(t-h)<.001&&Math.abs(i-u)<.001)return[new G(h,u)];const y=[];for(let g=0;g<f;g++){const v=g/f,b=ri(v,t,r,l,h),k=ri(v,i,o,c,u);y.push(new G(b,k))}return y}function ga(t,i,r,o,l,c,h,u,_){if(t===r&&i===o&&l===h&&c===u){const S=h-t,x=u-i;return Math.sqrt(S*S+x*x)}const f=9*(r-l)+3*(h-t),y=6*(t+l)-12*r,g=3*(r-t),v=9*(o-c)+3*(u-i),b=6*(i+c)-12*o,k=3*(o-i);function P(S){const x=(f*S+y)*S+g,C=(v*S+b)*S+k;return Math.sqrt(x*x+C*C)}return ba(P,0,1,_||Le.RecursionLimit)}function va(t,i,r,o,l,c,h,u){const _=[],f=[[],[]];let y,g,v,b,k,P,S,x;for(let M=0;M<2;++M){if(M==0?(g=6*t-12*r+6*l,y=-3*t+9*r-9*l+3*h,v=3*r-3*t):(g=6*i-12*o+6*c,y=-3*i+9*o-9*c+3*u,v=3*o-3*i),Math.abs(y)<1e-12){if(Math.abs(g)<1e-12)continue;b=-v/g,0<b&&b<1&&_.push(b);continue}S=g*g-4*v*y,x=Math.sqrt(S),!(S<0)&&(k=(-g+x)/(2*y),0<k&&k<1&&_.push(k),P=(-g-x)/(2*y),0<P&&P<1&&_.push(P))}let C=_.length,R=C,E;for(;C--;)b=_[C],E=1-b,f[0][C]=E*E*E*t+3*E*E*b*r+3*E*b*b*l+b*b*b*h,f[1][C]=E*E*E*i+3*E*E*b*o+3*E*b*b*c+b*b*b*u;return f[0][R]=t,f[1][R]=i,f[0][R+1]=h,f[1][R+1]=u,f[0].length=f[1].length=R+2,{min:{x:Math.min.apply(0,f[0]),y:Math.min.apply(0,f[1])},max:{x:Math.max.apply(0,f[0]),y:Math.max.apply(0,f[1])}}}function ba(t,i,r,o){let l=Le.abscissas[o-2],c=Le.weights[o-2],h=.5*(r-i),u=h+i,_=0,f=o+1>>1,y=o&1?c[_++]*t(u):0;for(;_<f;){const g=h*l[_];y+=c[_++]*(t(u+g)+t(u-g))}return h*y}function ya(t,i){const r=t.length,o=r-1;for(let l=0;l<r;l++){const c=t[l],h=i?Mt(l-1,r):Math.max(l-1,0),u=i?Mt(l+1,r):Math.min(l+1,o),_=t[h],f=c,y=t[u];wa(_,f,y),f.command=l===0?V.move:V.curve}}function wa(t,i,r){const o=L.angleBetween(t,i),l=L.angleBetween(r,i);let c=L.distanceBetween(t,i),h=L.distanceBetween(r,i),u=(o+l)/2;return c<1e-4||h<1e-4?(typeof i.relative=="boolean"&&!i.relative&&(i.controls.left.copy(i),i.controls.right.copy(i)),i):(c*=.33,h*=.33,l<o?u+=gt:u-=gt,i.controls.left.x=Math.cos(u)*c,i.controls.left.y=Math.sin(u)*c,u-=Math.PI,i.controls.right.x=Math.cos(u)*h,i.controls.right.y=Math.sin(u)*h,typeof i.relative=="boolean"&&!i.relative&&(i.controls.left.x+=i.x,i.controls.left.y+=i.y,i.controls.right.x+=i.x,i.controls.right.y+=i.y),i)}function Hs(t,i,r){return new L(2*t.x-(i.x+t.x)-(r?t.x:0),2*t.y-(i.y+t.y)-(r?t.y:0))}function Sc(t,i,r,o,l,c,h){const u=vt.Resolution;for(let _=0;_<u;_++){let f=(_+1)/u;h&&(f=1-f);const y=f*c+l,g=r*Math.cos(y),v=o*Math.sin(y),b=new G(g,v);b.command=V.line}}var Ac=ut.devicePixelRatio||1;function Rc(t){return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1}function Xs(t){return Ac/Rc(t)}var Rr=Array.prototype.slice;function Mc(t){if(t==null)return!1;const i=t.length;return typeof i=="number"&&i>=0&&i<4294967296}var F={isNaN:function(t){return typeof t=="number"&&t!==+t},isElement:function(t){return!!(t&&t.nodeType===1)},isObject:function(t){const i=typeof t;return i==="function"||i==="object"&&!!t},extend:function(t){const i=Rr.call(arguments,1);for(let r=0;r<i.length;r++){const o=i[r];for(let l in o)t[l]=o[l]}return t},defaults:function(t){const i=Rr.call(arguments,1);for(let r=0;r<i.length;r++){const o=i[r];for(let l in o)t[l]===void 0&&(t[l]=o[l])}return t},each:function(t,i,r){const o=r||this,l=!Mc(t)&&Object.keys(t),c=(l||t).length;for(let h=0;h<c;h++){const u=l?l[h]:h;i.call(o,t[u],u,t)}return t},performance:ut.performance&&ut.performance.now?ut.performance:Date},qi=class extends A{constructor(){super(),p(this,"_flagId",!1),p(this,"_flagClassName",!1),p(this,"_renderer",{}),p(this,"_id",""),p(this,"_className",""),p(this,"classList",[]);for(let t in Mr)Object.defineProperty(this,t,Mr[t])}flagReset(){this._flagId=this._flagClassName=!1}},Mr={renderer:{enumerable:!1,get:function(){return this._renderer}},id:{enumerable:!0,get:function(){return this._id},set:function(t){const i=this._id;t!==this._id&&(this._id=t,this._flagId=!0,this.parent&&(delete this.parent.children.ids[i],this.parent.children.ids[this._id]=this))}},className:{enumerable:!0,get:function(){return this._className},set:function(t){this._className!==t&&(this._flagClassName=!0,this.classList=t.split(/\s+?/),this._className=t)}}},Tc=Math.cos,Vc=Math.sin,Tr=Math.tan,Is=[],It=class extends A{constructor(t,i,r,o,l,c){super(),p(this,"elements",new $t(9)),p(this,"manual",!1);let h=t;Array.isArray(h)||(h=Array.prototype.slice.call(arguments)),this.identity(),h.length>0&&this.set(h)}static Multiply(t,i,r){if(i.length<=3){const M=t;let j,O,U;const D=i[0]||0,I=i[1]||0,q=i[2]||0;return j=M[0]*D+M[1]*I+M[2]*q,O=M[3]*D+M[4]*I+M[5]*q,U=M[6]*D+M[7]*I+M[8]*q,{x:j,y:O,z:U}}const o=t[0],l=t[1],c=t[2],h=t[3],u=t[4],_=t[5],f=t[6],y=t[7],g=t[8],v=i[0],b=i[1],k=i[2],P=i[3],S=i[4],x=i[5],C=i[6],R=i[7],E=i[8];return r=r||new $t(9),r[0]=o*v+l*P+c*C,r[1]=o*b+l*S+c*R,r[2]=o*k+l*x+c*E,r[3]=h*v+u*P+_*C,r[4]=h*b+u*S+_*R,r[5]=h*k+u*x+_*E,r[6]=f*v+y*P+g*C,r[7]=f*b+y*S+g*R,r[8]=f*k+y*x+g*E,r}set(t,i,r,o,l,c,h,u,_){if(typeof i>"u"){const f=t;t=f[0],i=f[1],r=f[2],o=f[3],l=f[4],c=f[5],h=f[6],u=f[7],_=f[8]}return this.elements[0]=t,this.elements[1]=i,this.elements[2]=r,this.elements[3]=o,this.elements[4]=l,this.elements[5]=c,this.elements[6]=h,this.elements[7]=u,this.elements[8]=_,this.trigger(A.Types.change)}copy(t){return this.elements[0]=t.elements[0],this.elements[1]=t.elements[1],this.elements[2]=t.elements[2],this.elements[3]=t.elements[3],this.elements[4]=t.elements[4],this.elements[5]=t.elements[5],this.elements[6]=t.elements[6],this.elements[7]=t.elements[7],this.elements[8]=t.elements[8],this.manual=t.manual,this.trigger(A.Types.change)}identity(){return this.elements[0]=It.Identity[0],this.elements[1]=It.Identity[1],this.elements[2]=It.Identity[2],this.elements[3]=It.Identity[3],this.elements[4]=It.Identity[4],this.elements[5]=It.Identity[5],this.elements[6]=It.Identity[6],this.elements[7]=It.Identity[7],this.elements[8]=It.Identity[8],this.trigger(A.Types.change)}multiply(t,i,r,o,l,c,h,u,_){if(typeof i>"u")return this.elements[0]*=t,this.elements[1]*=t,this.elements[2]*=t,this.elements[3]*=t,this.elements[4]*=t,this.elements[5]*=t,this.elements[6]*=t,this.elements[7]*=t,this.elements[8]*=t,this.trigger(A.Types.change);if(typeof o>"u"){t=t||0,i=i||0,r=r||0,l=this.elements;const nt=l[0]*t+l[1]*i+l[2]*r,Y=l[3]*t+l[4]*i+l[5]*r,wt=l[6]*t+l[7]*i+l[8]*r;return{x:nt,y:Y,z:wt}}const f=this.elements,y=[t,i,r,o,l,c,h,u,_],g=f[0],v=f[1],b=f[2],k=f[3],P=f[4],S=f[5],x=f[6],C=f[7],R=f[8],E=y[0],M=y[1],j=y[2],O=y[3],U=y[4],D=y[5],I=y[6],q=y[7],J=y[8];return this.elements[0]=g*E+v*O+b*I,this.elements[1]=g*M+v*U+b*q,this.elements[2]=g*j+v*D+b*J,this.elements[3]=k*E+P*O+S*I,this.elements[4]=k*M+P*U+S*q,this.elements[5]=k*j+P*D+S*J,this.elements[6]=x*E+C*O+R*I,this.elements[7]=x*M+C*U+R*q,this.elements[8]=x*j+C*D+R*J,this.trigger(A.Types.change)}inverse(t){const i=this.elements;t=t||new It;const r=i[0],o=i[1],l=i[2],c=i[3],h=i[4],u=i[5],_=i[6],f=i[7],y=i[8],g=y*h-u*f,v=-y*c+u*_,b=f*c-h*_;let k=r*g+o*v+l*b;return k?(k=1/k,t.elements[0]=g*k,t.elements[1]=(-y*o+l*f)*k,t.elements[2]=(u*o-l*h)*k,t.elements[3]=v*k,t.elements[4]=(y*r-l*_)*k,t.elements[5]=(-u*r+l*c)*k,t.elements[6]=b*k,t.elements[7]=(-f*r+o*_)*k,t.elements[8]=(h*r-o*c)*k,t):null}scale(t,i){return arguments.length<=1&&(i=t),this.multiply(t,0,0,0,i,0,0,0,1)}rotate(t){const i=Tc(t),r=Vc(t);return this.multiply(i,-r,0,r,i,0,0,0,1)}translate(t,i){return this.multiply(1,0,t,0,1,i,0,0,1)}skewX(t){const i=Tr(t);return this.multiply(1,i,0,0,1,0,0,0,1)}skewY(t){const i=Tr(t);return this.multiply(1,0,0,i,1,0,0,0,1)}toString(t){return Is.length=0,this.toTransformArray(t,Is),Is.map(dt).join(" ")}toTransformArray(t,i){const r=this.elements,o=!!i,l=r[0],c=r[1],h=r[2],u=r[3],_=r[4],f=r[5];if(t){const y=r[6],g=r[7],v=r[8];if(o){i[0]=l,i[1]=u,i[2]=y,i[3]=c,i[4]=_,i[5]=g,i[6]=h,i[7]=f,i[8]=v;return}return[l,u,y,c,_,g,h,f,v]}if(o){i[0]=l,i[1]=u,i[2]=c,i[3]=_,i[4]=h,i[5]=f;return}return[l,u,c,_,h,f]}toArray(t,i){const r=this.elements,o=!!i,l=r[0],c=r[1],h=r[2],u=r[3],_=r[4],f=r[5];if(t){const y=r[6],g=r[7],v=r[8];if(o){i[0]=l,i[1]=c,i[2]=h,i[3]=u,i[4]=_,i[5]=f,i[6]=y,i[7]=g,i[8]=v;return}return[l,c,h,u,_,f,y,g,v]}if(o){i[0]=l,i[1]=c,i[2]=h,i[3]=u,i[4]=_,i[5]=f;return}return[l,c,h,u,_,f]}toObject(){return{elements:this.toArray(!0),manual:!!this.manual}}clone(){return new It().copy(this)}},Zt=It;p(Zt,"Identity",[1,0,0,0,1,0,0,0,1]);fa(Zt);var de=class extends qi{constructor(){super(),p(this,"_flagMatrix",!0),p(this,"_flagScale",!1),p(this,"_matrix",null),p(this,"_worldMatrix",null),p(this,"_position",null),p(this,"_rotation",0),p(this,"_scale",1),p(this,"_skewX",0),p(this,"_skewY",0);for(let t in Pi)Object.defineProperty(this,t,Pi[t]);this._renderer.flagMatrix=xa.bind(this),this.isShape=!0,this.id=vt.Identifier+vt.uniqueId(),this.matrix=new Zt,this.worldMatrix=new Zt,this.position=new L,this.rotation=0,this.scale=1,this.skewX=0,this.skewY=0}get renderer(){return this._renderer}set renderer(t){this._renderer=t}get translation(){return Pi.position.get.apply(this,arguments)}set translation(t){Pi.position.set.apply(this,arguments)}addTo(t){return t.add(this),this}remove(){return this.parent?(this.parent.remove(this),this):this}clone(t){const i=new de;return i.position.copy(this.position),i.rotation=this.rotation,i.scale=this.scale,i.skewX=this.skewX,i.skewY=this.skewY,this.matrix.manual&&i.matrix.copy(this.matrix),t&&t.add(i),i._update()}_update(t){return!this._matrix.manual&&this._flagMatrix&&(this._matrix.identity().translate(this.position.x,this.position.y),this._scale instanceof L?this._matrix.scale(this._scale.x,this._scale.y):this._matrix.scale(this._scale),this._matrix.rotate(this.rotation),this._matrix.skewX(this.skewX),this._matrix.skewY(this.skewY)),t&&this.parent&&this.parent._update&&this.parent._update(),this}flagReset(){return this._flagMatrix=this._flagScale=!1,super.flagReset.call(this),this}},Pi={position:{enumerable:!0,get:function(){return this._position},set:function(t){this._position&&this._position.unbind(A.Types.change,this._renderer.flagMatrix),this._position=t,this._position.bind(A.Types.change,this._renderer.flagMatrix),xa.call(this)}},rotation:{enumerable:!0,get:function(){return this._rotation},set:function(t){this._rotation=t,this._flagMatrix=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(t){this._scale instanceof L&&this._scale.unbind(A.Types.change,this._renderer.flagMatrix),this._scale=t,this._scale instanceof L&&this._scale.bind(A.Types.change,this._renderer.flagMatrix),this._flagMatrix=!0,this._flagScale=!0}},skewX:{enumerable:!0,get:function(){return this._skewX},set:function(t){this._skewX=t,this._flagMatrix=!0}},skewY:{enumerable:!0,get:function(){return this._skewY},set:function(t){this._skewY=t,this._flagMatrix=!0}},matrix:{enumerable:!0,get:function(){return this._matrix},set:function(t){this._matrix=t,this._flagMatrix=!0}},worldMatrix:{enumerable:!0,get:function(){return we(this,this._worldMatrix),this._worldMatrix},set:function(t){this._worldMatrix=t}}};function xa(){this._flagMatrix=!0}var ue=class extends Array{constructor(){super(),p(this,"_events",new A),arguments[0]&&Array.isArray(arguments[0])?arguments[0].length>0&&this.push.apply(this,arguments[0]):arguments.length>0&&this.push.apply(this,arguments)}get _bound(){return this._events._bound}set _bound(t){this._events._bound=t}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.on.apply(this,arguments)}bind(){return this._events.bind.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.off.apply(this,arguments)}unbind(){return this._events.unbind.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.trigger.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}pop(){const t=super.pop.apply(this,arguments);return this.trigger(A.Types.remove,[t]),t}shift(){const t=super.shift.apply(this,arguments);return this.trigger(A.Types.remove,[t]),t}push(){const t=super.push.apply(this,arguments);return this.trigger(A.Types.insert,arguments),t}unshift(){const t=super.unshift.apply(this,arguments);return this.trigger(A.Types.insert,arguments),t}splice(){const t=super.splice.apply(this,arguments);if(this.trigger(A.Types.remove,t),arguments.length>2){const i=this.slice(arguments[0],arguments[0]+arguments.length-2);this.trigger(A.Types.insert,i),this.trigger(A.Types.order)}return t}sort(){return super.sort.apply(this,arguments),this.trigger(A.Types.order),this}reverse(){return super.reverse.apply(this,arguments),this.trigger(A.Types.order),this}indexOf(){return super.indexOf.apply(this,arguments)}},ka=class extends ue{constructor(t){t=Array.isArray(t)?t:Array.prototype.slice.call(arguments),super(t),p(this,"ids",{}),this.attach(t),this.on(A.Types.insert,this.attach),this.on(A.Types.remove,this.detach)}attach(t){for(let i=0;i<t.length;i++){const r=t[i];r&&r.id&&(this.ids[r.id]=r)}return this}detach(t){for(let i=0;i<t.length;i++)delete this.ids[t[i].id];return this}},Ei=Math.min,Si=Math.max,Ca=class extends de{constructor(t){super(),p(this,"_flagAdditions",!1),p(this,"_flagSubtractions",!1),p(this,"_flagOrder",!1),p(this,"_flagOpacity",!0),p(this,"_flagBeginning",!1),p(this,"_flagEnding",!1),p(this,"_flagLength",!1),p(this,"_flagMask",!1),p(this,"_fill","#fff"),p(this,"_stroke","#000"),p(this,"_linewidth",1),p(this,"_opacity",1),p(this,"_visible",!0),p(this,"_cap","round"),p(this,"_join","round"),p(this,"_miter",4),p(this,"_closed",!0),p(this,"_curved",!1),p(this,"_automatic",!0),p(this,"_beginning",0),p(this,"_ending",1),p(this,"_length",0),p(this,"_mask",null);for(let i in Vr)Object.defineProperty(this,i,Vr[i]);this._renderer.type="group",this.additions=[],this.subtractions=[],this.children=Array.isArray(t)?t:Array.prototype.slice.call(arguments)}static InsertChildren(t){for(let i=0;i<t.length;i++)Lr.call(this,t[i],this)}static RemoveChildren(t){for(let i=0;i<t.length;i++)Lr.call(this,t[i])}static OrderChildren(t){this._flagOrder=!0}clone(t){const i=new Ca,r=this.children.map(function(o){return o.clone()});return i.add(r),i.opacity=this.opacity,this.mask&&(i.mask=this.mask),i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i.className=this.className,this.matrix.manual&&i.matrix.copy(this.matrix),t&&t.add(i),i._update()}toObject(){const t={children:[],translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale instanceof L?this.scale.toObject():this.scale,opacity:this.opacity,className:this.className,mask:this.mask?this.mask.toObject():null};return this.matrix.manual&&(t.matrix=this.matrix.toObject()),F.each(this.children,function(i,r){t.children[r]=i.toObject()},this),t}corner(){const t=this.getBoundingClientRect(!0);for(let i=0;i<this.children.length;i++){const r=this.children[i];r.translation.x-=t.left,r.translation.y-=t.top}return this.mask&&(this.mask.translation.x-=t.left,this.mask.translation.y-=t.top),this}center(){const t=this.getBoundingClientRect(!0),i=t.left+t.width/2-this.translation.x,r=t.top+t.height/2-this.translation.y;for(let o=0;o<this.children.length;o++){const l=this.children[o];l.isShape&&(l.translation.x-=i,l.translation.y-=r)}return this.mask&&(this.mask.translation.x-=i,this.mask.translation.y-=r),this}getById(t){let i=null;function r(o){if(o.id===t)return o;if(o.children){for(let l=0;l<o.children.length;l++)if(i=r(o.children[l]),i)return i}return null}return r(this)}getByClassName(t){const i=[];function r(o){if(Array.prototype.indexOf.call(o.classList,t)>=0&&i.push(o),o.children)for(let l=0;l<o.children.length;l++){const c=o.children[l];r(c)}return i}return r(this)}getByType(t){const i=[];function r(o){if(o instanceof t&&i.push(o),o.children)for(let l=0;l<o.children.length;l++){const c=o.children[l];r(c)}return i}return r(this)}add(t){t instanceof Array?t=t.slice():t=Array.prototype.slice.call(arguments);for(let i=0;i<t.length;i++){const r=t[i];if(!(r&&r.id))continue;const o=Array.prototype.indexOf.call(this.children,r);o>=0&&this.children.splice(o,1),this.children.push(r)}return this}remove(t){const i=arguments.length,r=this.parent;if(i<=0&&r)return r.remove(this),this;t instanceof Array?t=t.slice():t=Array.prototype.slice.call(arguments);for(let o=0;o<t.length;o++){const l=t[o];if(!l||!this.children.ids[l.id])continue;const c=this.children.indexOf(l);c>=0&&this.children.splice(c,1)}return this}getBoundingClientRect(t){let i,r,o,l,c,h,u,_,f,y;this._update(!0);let g=1/0,v=-1/0,b=1/0,k=-1/0;const P=/texture|gradient/i;r=t?this._matrix:we(this);for(let S=0;S<this.children.length;S++){const x=this.children[S];!x.visible||P.test(x._renderer.type)||(i=x.getBoundingClientRect(t),u=typeof i.top!="number"||F.isNaN(i.top)||!isFinite(i.top),_=typeof i.left!="number"||F.isNaN(i.left)||!isFinite(i.left),f=typeof i.right!="number"||F.isNaN(i.right)||!isFinite(i.right),y=typeof i.bottom!="number"||F.isNaN(i.bottom)||!isFinite(i.bottom),!(u||_||f||y)&&(b=Ei(i.top,b),g=Ei(i.left,g),v=Si(i.right,v),k=Si(i.bottom,k)))}return t&&(o=r.multiply(g,b,1),l=r.multiply(g,k,1),c=r.multiply(v,b,1),h=r.multiply(v,k,1),b=Ei(o.y,l.y,c.y,h.y),g=Ei(o.x,l.x,c.x,h.x),v=Si(o.x,l.x,c.x,h.x),k=Si(o.y,l.y,c.y,h.y)),{top:b,left:g,right:v,bottom:k,width:v-g,height:k-b}}noFill(){return this.children.forEach(function(t){t.noFill()}),this}noStroke(){return this.children.forEach(function(t){t.noStroke()}),this}subdivide(){const t=arguments;return this.children.forEach(function(i){i.subdivide.apply(i,t)}),this}_update(){let t,i,r;if(this._flagBeginning||this._flagEnding){const o=Math.min(this._beginning,this._ending),l=Math.max(this._beginning,this._ending),c=this.length;let h=0;const u=o*c,_=l*c;for(t=0;t<this.children.length;t++)r=this.children[t],i=r.length,u>h+i?(r.beginning=1,r.ending=1):_<h?(r.beginning=0,r.ending=0):u>h&&u<h+i?(r.beginning=(u-h)/i,r.ending=1):_>h&&_<h+i?(r.beginning=0,r.ending=(_-h)/i):(r.beginning=0,r.ending=1),h+=i}return super._update.apply(this,arguments)}flagReset(){return this._flagAdditions&&(this.additions.length=0,this._flagAdditions=!1),this._flagSubtractions&&(this.subtractions.length=0,this._flagSubtractions=!1),this._flagOrder=this._flagMask=this._flagOpacity=this._flagBeginning=this._flagEnding=!1,super.flagReset.call(this),this}},ft=Ca;p(ft,"Children",ka);p(ft,"Properties",["fill","stroke","linewidth","cap","join","miter","closed","curved","automatic"]);var Vr={visible:{enumerable:!0,get:function(){return this._visible},set:function(t){this._flagVisible=this._visible!==t||this._flagVisible,this._visible=t}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(t){this._flagOpacity=this._opacity!==t||this._flagOpacity,this._opacity=t}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(t){this._flagBeginning=this._beginning!==t||this._flagBeginning,this._beginning=t}},ending:{enumerable:!0,get:function(){return this._ending},set:function(t){this._flagEnding=this._ending!==t||this._flagEnding,this._ending=t}},length:{enumerable:!0,get:function(){if(this._flagLength||this._length<=0){if(this._length=0,!this.children)return this._length;for(let t=0;t<this.children.length;t++){const i=this.children[t];this._length+=i.length}}return this._length}},fill:{enumerable:!0,get:function(){return this._fill},set:function(t){this._fill=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.fill=t}}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(t){this._stroke=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.stroke=t}}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(t){this._linewidth=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.linewidth=t}}},join:{enumerable:!0,get:function(){return this._join},set:function(t){this._join=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.join=t}}},miter:{enumerable:!0,get:function(){return this._miter},set:function(t){this._miter=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.miter=t}}},cap:{enumerable:!0,get:function(){return this._cap},set:function(t){this._cap=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.cap=t}}},closed:{enumerable:!0,get:function(){return this._closed},set:function(t){this._closed=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.closed=t}}},curved:{enumerable:!0,get:function(){return this._curved},set:function(t){this._curved=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.curved=t}}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(t){this._automatic=t;for(let i=0;i<this.children.length;i++){const r=this.children[i];r.automatic=t}}},children:{enumerable:!0,get:function(){return this._children},set:function(t){const i=ft.InsertChildren.bind(this),r=ft.RemoveChildren.bind(this),o=ft.OrderChildren.bind(this);this._children&&(this._children.unbind(),this._children.length>0&&r(this._children)),this._children=new ka(t),this._children.bind(A.Types.insert,i),this._children.bind(A.Types.remove,r),this._children.bind(A.Types.order,o),t.length>0&&i(t)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(t){this._mask=t,this._flagMask=!0,F.isObject(t)&&!t.clip&&(t.clip=!0)}}};function Lr(t,i){const r=t.parent;let o;if(r===i){l();return}if(r&&r.children.ids[t.id]&&(o=Array.prototype.indexOf.call(r.children,t),r.children.splice(o,1),c()),i){l();return}c(),r._flagAdditions&&r.additions.length===0&&(r._flagAdditions=!1),r._flagSubtractions&&r.subtractions.length===0&&(r._flagSubtractions=!1),delete t.parent;function l(){i.subtractions.length>0&&(o=Array.prototype.indexOf.call(i.subtractions,t),o>=0&&i.subtractions.splice(o,1)),i.additions.length>0&&(o=Array.prototype.indexOf.call(i.additions,t),o>=0&&i.additions.splice(o,1)),t.parent=i,i.additions.push(t),i._flagAdditions=!0}function c(){o=Array.prototype.indexOf.call(r.additions,t),o>=0&&r.additions.splice(o,1),o=Array.prototype.indexOf.call(r.subtractions,t),o<0&&(r.subtractions.push(t),r._flagSubtractions=!0)}}var Fr=new Zt,Ns=[],Ks=Math.max,Lc=Math.min,Or=Math.abs,Ai=Math.sin,Ri=Math.cos,Fc=Math.acos,zi=Math.sqrt,pt={isHidden:/(undefined|none|transparent)/i,alignments:{left:"start",middle:"center",right:"end"},shim:function(t,i){return t.tagName=t.nodeName=i||"canvas",t.nodeType=1,t.getAttribute=function(r){return this[r]},t.setAttribute=function(r,o){return this[r]=o,this},t},group:{renderChild:function(t){pt[t._renderer.type].render.call(t,this.ctx,!0,this.clip)},render:function(t){if(!this._visible)return this;this._update();const i=this._matrix.elements,r=this.parent;this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1);const o=this._mask,l=Mi(i),c=!l||!!o;if(this._renderer.context||(this._renderer.context={}),this._renderer.context.ctx=t,c&&(t.save(),l||t.transform(i[0],i[3],i[1],i[4],i[2],i[5])),o&&pt[o._renderer.type].render.call(o,t,!0),this._opacity>0&&this._scale!==0)for(let h=0;h<this.children.length;h++){const u=this.children[h];pt[u._renderer.type].render.call(u,t)}return c&&t.restore(),this.flagReset()}},path:{render:function(t,i,r){let o,l,c,h,u,_,f,y,g,v,b,k,P,S,x,C,R,E,M,j,O,U,D,I,q,J,nt,Y,wt,at,it,N,kt,Nt;if(Nt=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,wt=this._mask,at=this._clip,u=this._opacity*(Nt||1),_=this._visible,!i&&(!_||at||u===0))return this;this._update(),o=this._matrix.elements,l=this._stroke,c=this._linewidth,h=this._fill,f=this._cap,y=this._join,g=this._miter,v=this._closed,b=this._renderer.vertices,k=b.length,P=k-1,it=Mi(o),kt=this.dashes,it||(t.save(),t.transform(o[0],o[3],o[1],o[4],o[2],o[5])),wt&&pt[wt._renderer.type].render.call(wt,t,!0),h&&(typeof h=="string"?t.fillStyle=h:(pt[h._renderer.type].render.call(h,t,this),t.fillStyle=h._renderer.effect)),l&&(typeof l=="string"?t.strokeStyle=l:(pt[l._renderer.type].render.call(l,t,this),t.strokeStyle=l._renderer.effect),c&&(t.lineWidth=c),g&&(t.miterLimit=g),y&&(t.lineJoin=y),!v&&f&&(t.lineCap=f)),typeof u=="number"&&(t.globalAlpha=u),kt&&kt.length>0&&(t.lineDashOffset=kt.offset||0,t.setLineDash(kt)),t.beginPath();let Ut,Ct,Qt,et,st,rt,ci;for(let Tt=0;Tt<k;Tt++)switch(C=b[Tt],nt=C.x,Y=C.y,C.command){case V.close:t.closePath();break;case V.arc:Ut=C.rx,Ct=C.ry,Qt=C.xAxisRotation,et=C.largeArcFlag,st=C.sweepFlag,S=v?Mt(Tt-1,k):Ks(Tt-1,0),x=b[S],rt=x.x,ci=x.y,pt.renderSvgArcCommand(t,rt,ci,Ut,Ct,et,st,Qt,nt,Y);break;case V.curve:S=v?Mt(Tt-1,k):Math.max(Tt-1,0),x=b[S],D=x.controls&&x.controls.right||L.zero,I=C.controls&&C.controls.left||L.zero,x._relative?(O=D.x+x.x,U=D.y+x.y):(O=D.x,U=D.y),C._relative?(M=I.x+C.x,j=I.y+C.y):(M=I.x,j=I.y),t.bezierCurveTo(O,U,M,j,nt,Y),Tt>=P&&v&&(R=E,q=C.controls&&C.controls.right||L.zero,J=R.controls&&R.controls.left||L.zero,C._relative?(O=q.x+C.x,U=q.y+C.y):(O=q.x,U=q.y),R._relative?(M=J.x+R.x,j=J.y+R.y):(M=J.x,j=J.y),nt=R.x,Y=R.y,t.bezierCurveTo(O,U,M,j,nt,Y));break;case V.line:t.lineTo(nt,Y);break;case V.move:E=C,t.moveTo(nt,Y);break}return v&&t.closePath(),!at&&!r&&(pt.isHidden.test(h)||(N=h._renderer&&h._renderer.offset,N&&(t.save(),t.translate(-h._renderer.offset.x,-h._renderer.offset.y),t.scale(h._renderer.scale.x,h._renderer.scale.y)),t.fill(),N&&t.restore()),pt.isHidden.test(l)||(N=l._renderer&&l._renderer.offset,N&&(t.save(),t.translate(-l._renderer.offset.x,-l._renderer.offset.y),t.scale(l._renderer.scale.x,l._renderer.scale.y),t.lineWidth=c/l._renderer.scale.x),t.stroke(),N&&t.restore())),it||t.restore(),at&&!r&&t.clip(),kt&&kt.length>0&&t.setLineDash(Ns),this.flagReset()}},points:{render:function(t,i,r){let o,l,c,h,u,_,f,y,g,v,b,k,P,S,x,C;if(C=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,u=this._opacity*(C||1),_=this._visible,!i&&(!_||u===0))return this;this._update(),o=this._matrix.elements,l=this._stroke,c=this._linewidth,h=this._fill,y=this._renderer.collection,g=y.length,P=Mi(o),x=this.dashes,f=this._size,P||(t.save(),t.transform(o[0],o[3],o[1],o[4],o[2],o[5])),h&&(typeof h=="string"?t.fillStyle=h:(pt[h._renderer.type].render.call(h,t,this),t.fillStyle=h._renderer.effect)),l&&(typeof l=="string"?t.strokeStyle=l:(pt[l._renderer.type].render.call(l,t,this),t.strokeStyle=l._renderer.effect),c&&(t.lineWidth=c)),typeof u=="number"&&(t.globalAlpha=u),x&&x.length>0&&(t.lineDashOffset=x.offset||0,t.setLineDash(x)),t.beginPath();let R=f*.5,E;this._sizeAttenuation||(we(this,Fr),E=Fr.elements,E=ni(E[0],E[3],E[1],E[4],E[2],E[5]),R/=Math.max(E.scaleX,E.scaleY));for(let M=0;M<g;M++)v=y[M],b=v.x,k=v.y,t.moveTo(b+R,k),t.arc(b,k,R,0,xt);return r||(pt.isHidden.test(h)||(S=h._renderer&&h._renderer.offset,S&&(t.save(),t.translate(-h._renderer.offset.x,-h._renderer.offset.y),t.scale(h._renderer.scale.x,h._renderer.scale.y)),t.fill(),S&&t.restore()),pt.isHidden.test(l)||(S=l._renderer&&l._renderer.offset,S&&(t.save(),t.translate(-l._renderer.offset.x,-l._renderer.offset.y),t.scale(l._renderer.scale.x,l._renderer.scale.y),t.lineWidth=c/l._renderer.scale.x),t.stroke(),S&&t.restore())),P||t.restore(),x&&x.length>0&&t.setLineDash(Ns),this.flagReset()}},text:{render:function(t,i,r){const o=this.parent&&this.parent._renderer?this.parent._renderer.opacity:1,l=this._opacity*o,c=this._visible,h=this._mask,u=this._clip;if(!i&&(!c||u||l===0))return this;this._update();const _=this._matrix.elements,f=this._stroke,y=this._linewidth,g=this._fill,v=this._decoration,b=Mi(_),k=g._renderer&&g._renderer.offset&&f._renderer&&f._renderer.offset,P=this.dashes,S=pt.alignments[this._alignment]||this._alignment,x=this._baseline;let C,R,E,M,j,O,U,D,I,q,J;if(b||(t.save(),t.transform(_[0],_[3],_[1],_[4],_[2],_[5])),h&&pt[h._renderer.type].render.call(h,t,!0),k||(t.font=[this._style,this._weight,this._size+"px/"+this._leading+"px",this._family].join(" ")),t.textAlign=S,t.textBaseline=x,g&&(typeof g=="string"?t.fillStyle=g:(pt[g._renderer.type].render.call(g,t,this),t.fillStyle=g._renderer.effect)),f&&(typeof f=="string"?t.strokeStyle=f:(pt[f._renderer.type].render.call(f,t,this),t.strokeStyle=f._renderer.effect),y&&(t.lineWidth=y)),typeof l=="number"&&(t.globalAlpha=l),P&&P.length>0&&(t.lineDashOffset=P.offset||0,t.setLineDash(P)),!u&&!r&&(pt.isHidden.test(g)||(g._renderer&&g._renderer.offset?(O=g._renderer.scale.x,U=g._renderer.scale.y,t.save(),t.translate(-g._renderer.offset.x,-g._renderer.offset.y),t.scale(O,U),C=this._size/g._renderer.scale.y,R=this._leading/g._renderer.scale.y,t.font=[this._style,this._weight,C+"px/",R+"px",this._family].join(" "),E=g._renderer.offset.x/g._renderer.scale.x,M=g._renderer.offset.y/g._renderer.scale.y,t.fillText(this.value,E,M),t.restore()):t.fillText(this.value,0,0)),pt.isHidden.test(f)||(f._renderer&&f._renderer.offset?(O=f._renderer.scale.x,U=f._renderer.scale.y,t.save(),t.translate(-f._renderer.offset.x,-f._renderer.offset.y),t.scale(O,U),C=this._size/f._renderer.scale.y,R=this._leading/f._renderer.scale.y,t.font=[this._style,this._weight,C+"px/",R+"px",this._family].join(" "),E=f._renderer.offset.x/f._renderer.scale.x,M=f._renderer.offset.y/f._renderer.scale.y,j=y/f._renderer.scale.x,t.lineWidth=j,t.strokeText(this.value,E,M),t.restore()):t.strokeText(this.value,0,0))),/(underline|strikethrough)/i.test(v)){const nt=t.measureText(this.value);let Y=1;switch(v){case"underline":I=nt.actualBoundingBoxAscent,J=nt.actualBoundingBoxAscent;break;case"strikethrough":I=0,J=0,Y=.5;break}switch(x){case"top":I+=this._size*Y,J+=this._size*Y;break;case"baseline":case"bottom":I-=this._size*Y,J-=this._size*Y;break}switch(S){case"left":case"start":D=0,q=nt.width;break;case"right":case"end":D=-nt.width,q=0;break;default:D=-nt.width/2,q=nt.width/2}t.lineWidth=Math.max(Math.floor(this._size/15),1),t.strokeStyle=t.fillStyle,t.beginPath(),t.moveTo(D,I),t.lineTo(q,J),t.stroke()}return b||t.restore(),u&&!r&&t.clip(),P&&P.length>0&&t.setLineDash(Ns),this.flagReset()}},"linear-gradient":{render:function(t,i){if(i){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let r,o=this.left._x,l=this.left._y,c=this.right._x,h=this.right._y;/objectBoundingBox/i.test(this._units)&&(r=i.getBoundingClientRect(!0),o=(o-.5)*r.width,l=(l-.5)*r.height,c=(c-.5)*r.width,h=(h-.5)*r.height),this._renderer.effect=t.createLinearGradient(o,l,c,h);for(let u=0;u<this.stops.length;u++){const _=this.stops[u];this._renderer.effect.addColorStop(_._offset,_._color)}}return this.flagReset()}}},"radial-gradient":{render:function(t,i){if(i){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let r,o=this.center._x,l=this.center._y,c=this.focal._x,h=this.focal._y,u=this._radius;/objectBoundingBox/i.test(this._units)&&(r=i.getBoundingClientRect(!0),o=o*r.width*.5,l=l*r.height*.5,c=c*r.width*.5,h=h*r.height*.5,u*=Math.min(r.width,r.height)*.5),this._renderer.effect=t.createRadialGradient(o,l,0,c,h,u);for(let _=0;_<this.stops.length;_++){const f=this.stops[_];this._renderer.effect.addColorStop(f._offset,f._color)}}return this.flagReset()}}},texture:{render:function(t){this._update();const i=this.image;return(!this._renderer.effect||(this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)&&(this._renderer.effect=t.createPattern(this.image,this._repeat)),(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof L||(this._renderer.offset=new L),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,i&&(this._renderer.offset.x+=i.width/2,this._renderer.offset.y+=i.height/2,this._scale instanceof L?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof L||(this._renderer.scale=new L),this._scale instanceof L?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},renderSvgArcCommand:function(t,i,r,o,l,c,h,u,_,f){u=u*Math.PI/180,o=Or(o),l=Or(l);const y=(i-_)/2,g=(r-f)/2,v=Ri(u)*y+Ai(u)*g,b=-Ai(u)*y+Ri(u)*g,k=v*v,P=b*b;let S=o*o,x=l*l;const C=k/S+P/x;if(C>1){const Y=zi(C);o=Y*o,l=Y*l,S=o*o,x=l*l}const R=S*P+x*k,E=(S*x-R)/R;let M=zi(Ks(0,E));c===h&&(M=-M);const j=M*o*b/l,O=-M*l*v/o,U=Ri(u)*j-Ai(u)*O+(i+_)/2,D=Ai(u)*j+Ri(u)*O+(r+f)/2,I=Ir(1,0,(v-j)/o,(b-O)/l),q=Ir((v-j)/o,(b-O)/l,(-v-j)/o,(-b-O)/l)%xt,J=I+q;Oc(t,U,D,o,l,I,J,h===0,u)}},li=class extends A{constructor(t){super();const i=t.smoothing!==!1;this.domElement=t.domElement||document.createElement("canvas"),this.ctx=this.domElement.getContext("2d"),this.overdraw=t.overdraw||!1,typeof this.ctx.imageSmoothingEnabled<"u"&&(this.ctx.imageSmoothingEnabled=i),this.scene=new ft,this.scene.parent=this}setSize(t,i,r){return this.width=t,this.height=i,this.ratio=typeof r>"u"?Xs(this.ctx):r,this.domElement.width=t*this.ratio,this.domElement.height=i*this.ratio,this.domElement.style&&F.extend(this.domElement.style,{width:t+"px",height:i+"px"}),this.trigger(A.Types.resize,t,i,r)}render(){const t=this.ratio===1;return t||(this.ctx.save(),this.ctx.scale(this.ratio,this.ratio)),this.overdraw||this.ctx.clearRect(0,0,this.width,this.height),pt.group.render.call(this.scene,this.ctx),t||this.ctx.restore(),this}};p(li,"Utils",pt);function Oc(t,i,r,o,l,c,h,u,_){const f=h-c,y=Le.Tolerance.epsilon,g=Math.abs(f)<y;let v=Mt(f,xt);v<y&&(g?v=0:v=xt),u===!0&&!g&&(v===xt?v=-xt:v=v-xt);for(let b=0;b<vt.Resolution;b++){const k=b/(vt.Resolution-1),P=c+k*v;let S=i+o*Math.cos(P),x=r+l*Math.sin(P);if(_!==0){const C=Math.cos(_),R=Math.sin(_),E=S-i,M=x-r;S=E*C-M*R+i,x=E*R+M*C+r}t.lineTo(S,x)}}function Ir(t,i,r,o){const l=t*r+i*o,c=zi(t*t+i*i)*zi(r*r+o*o);let h=Fc(Ks(-1,Lc(1,l/c)));return t*o-i*r<0&&(h=-h),h}function Mi(t){return t[0]==1&&t[3]==0&&t[1]==0&&t[4]==1&&t[2]==0&&t[5]==0}var At={Image:null,isHeadless:!1,shim:function(t,i){return li.Utils.shim(t),typeof i<"u"&&(At.Image=i),At.isHeadless=!0,t}},St={hasEventListeners:typeof ut.addEventListener=="function",bind:function(t,i,r,o){return this.hasEventListeners?t.addEventListener(i,r,!!o):t.attachEvent("on"+i,r),St},unbind:function(t,i,r,o){return St.hasEventListeners?t.removeEventListeners(i,r,!!o):t.detachEvent("on"+i,r),St},getRequestAnimationFrame:function(){const t=["ms","moz","webkit","o"];let i=0,r=ut.requestAnimationFrame;if(!r){for(let l=0;l<t.length;l++)r=ut[t[l]+"RequestAnimationFrame"]||r;r=r||o}function o(l,c){const h=new Date().getTime(),u=Math.max(0,16-(h-i)),_=ut.setTimeout(f,u);i=h+u;function f(){l(h+u)}return _}return r}},Ve=ut.document?ut.document.createElement("div"):{};Ve.id="help-two-load";Object.defineProperty(St,"temp",{enumerable:!0,get:function(){return F.isElement(Ve)&&!ut.document.head.contains(Ve)&&(Ve.style.display="none",ut.document.head.appendChild(Ve)),Ve}});var Rt=class extends Error{constructor(t){super(),p(this,"name","Two.js"),p(this,"message"),this.message=t}},Gi=class{constructor(){p(this,"map",{})}add(t,i){return this.map[t]=i,this}remove(t){return delete this.map[t],this}get(t){return this.map[t]}contains(t){return t in this.map}};function Nr(t,i){if(i===0||i===1)return!0;const o=t._length*i;let l=0;for(let c=0;c<t._lengths.length;c++){const h=t._lengths[c];if(l>=o)return o-l>=0;l+=h}return!1}function Hi(t,i){const r=t._length;if(i<=0)return 0;if(i>=r)return t._lengths.length-1;for(let o=0,l=0;o<t._lengths.length;o++){if(l+t._lengths[o]>=i)return i-=l,Math.max(o-1,0)+i/t._lengths[o];l+=t._lengths[o]}return-1}function $s(t,i,r){let o,l,c,h,u,_,f,y;const g=i.controls&&i.controls.right,v=t.controls&&t.controls.left;return o=i.x,u=i.y,l=(g||i).x,_=(g||i).y,c=(v||t).x,f=(v||t).y,h=t.x,y=t.y,g&&i._relative&&(l+=i.x,_+=i.y),v&&t._relative&&(c+=t.x,f+=t.y),ga(o,u,l,_,c,f,h,y,r)}function Br(t,i,r){let o,l,c,h,u,_,f,y;const g=i.controls&&i.controls.right,v=t.controls&&t.controls.left;return o=i.x,u=i.y,l=(g||i).x,_=(g||i).y,c=(v||t).x,f=(v||t).y,h=t.x,y=t.y,g&&i._relative&&(l+=i.x,_+=i.y),v&&t._relative&&(c+=t.x,f+=t.y),Ys(o,u,l,_,c,f,h,y,r)}var ce=class extends qi{constructor(t,i,r){super(),p(this,"_flagOffset",!0),p(this,"_flagOpacity",!0),p(this,"_flagColor",!0),p(this,"_offset",0),p(this,"_opacity",1),p(this,"_color","#fff");for(let o in Dr)Object.defineProperty(this,o,Dr[o]);this._renderer.type="stop",this.offset=typeof t=="number"?t:ce.Index<=0?0:1,this.opacity=typeof r=="number"?r:1,this.color=typeof i=="string"?i:ce.Index<=0?"#fff":"#000",ce.Index=(ce.Index+1)%2}clone(t){const i=new ce;return F.each(ce.Properties,function(r){i[r]=this[r]},this),t&&t.stops&&t.stops.push(i),i}toObject(){const t={};return F.each(ce.Properties,function(i){t[i]=this[i]},this),t}flagReset(){return this._flagOffset=this._flagColor=this._flagOpacity=!1,super.flagReset.call(this),this}},pe=ce;p(pe,"Index",0);p(pe,"Properties",["offset","opacity","color"]);var Dr={offset:{enumerable:!0,get:function(){return this._offset},set:function(t){this._offset=t,this._flagOffset=!0,this.parent&&(this.parent._flagStops=!0)}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(t){this._opacity=t,this._flagOpacity=!0,this.parent&&(this.parent._flagStops=!0)}},color:{enumerable:!0,get:function(){return this._color},set:function(t){this._color=t,this._flagColor=!0,this.parent&&(this.parent._flagStops=!0)}}},Vi=class extends qi{constructor(t){super(),p(this,"_flagStops",!1),p(this,"_flagSpread",!1),p(this,"_flagUnits",!1),p(this,"_spread",""),p(this,"_units","");for(let i in jr)Object.defineProperty(this,i,jr[i]);this._renderer.type="gradient",this.id=vt.Identifier+vt.uniqueId(),this.classList=[],this._renderer.flagStops=Ic.bind(this),this._renderer.bindStops=Nc.bind(this),this._renderer.unbindStops=Bc.bind(this),this.spread="pad",this.units="objectBoundingBox",t&&(this.stops=t)}clone(t){const i=this.stops.map(function(o){return o.clone()}),r=new Vi(i);return F.each(Vi.Properties,function(o){r[o]=this[o]},this),t&&t.add(r),r}toObject(){const t={stops:this.stops.map(function(i){return i.toObject()})};return F.each(Vi.Properties,function(i){t[i]=this[i]},this),t}_update(){return(this._flagSpread||this._flagStops)&&this.trigger(A.Types.change),this}flagReset(){return this._flagSpread=this._flagUnits=this._flagStops=!1,super.flagReset.call(this),this}},_t=Vi;p(_t,"Stop",pe);p(_t,"Properties",["spread","stops","renderer","units"]);var jr={spread:{enumerable:!0,get:function(){return this._spread},set:function(t){this._spread=t,this._flagSpread=!0}},units:{enumerable:!0,get:function(){return this._units},set:function(t){this._units=t,this._flagUnits=!0}},stops:{enumerable:!0,get:function(){return this._stops},set:function(t){const i=this._renderer.bindStops,r=this._renderer.unbindStops;this._stops&&this._stops.unbind(A.Types.insert,i).unbind(A.Types.remove,r),this._stops=new ue((t||[]).slice(0)),this._stops.bind(A.Types.insert,i).bind(A.Types.remove,r),i(this._stops)}}};function Ic(){this._flagStops=!0}function Nc(t){let i=t.length;for(;i--;)t[i].bind(A.Types.change,this._renderer.flagStops),t[i].parent=this;this._renderer.flagStops()}function Bc(t){let i=t.length;for(;i--;)t[i].unbind(A.Types.change,this._renderer.flagStops),delete t[i].parent;this._renderer.flagStops()}var Pa=class extends _t{constructor(t,i,r,o,l){super(l),p(this,"_flagEndPoints",!1),p(this,"_left",null),p(this,"_right",null);for(let c in Ur)Object.defineProperty(this,c,Ur[c]);this._renderer.type="linear-gradient",this._renderer.flagEndPoints=Dc.bind(this),this.left=new L,this.right=new L,typeof t=="number"&&(this.left.x=t),typeof i=="number"&&(this.left.y=i),typeof r=="number"&&(this.right.x=r),typeof o=="number"&&(this.right.y=o)}clone(t){const i=this.stops.map(function(o){return o.clone()}),r=new Pa(this.left._x,this.left._y,this.right._x,this.right._y,i);return F.each(_t.Properties,function(o){r[o]=this[o]},this),t&&t.add(r),r}toObject(){const t=super.toObject.call(this);return t.left=this.left.toObject(),t.right=this.right.toObject(),t}_update(){return(this._flagEndPoints||this._flagSpread||this._flagStops)&&this.trigger(A.Types.change),this}flagReset(){return this._flagEndPoints=!1,super.flagReset.call(this),this}},ht=Pa;p(ht,"Properties",["left","right"]);p(ht,"Stop",pe);var Ur={left:{enumerable:!0,get:function(){return this._left},set:function(t){this._left instanceof L&&this._left.unbind(A.Types.change,this._renderer.flagEndPoints),this._left=t,this._left.bind(A.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}},right:{enumerable:!0,get:function(){return this._right},set:function(t){this._right instanceof L&&this._right.unbind(A.Types.change,this._renderer.flagEndPoints),this._right=t,this._right.bind(A.Types.change,this._renderer.flagEndPoints),this._flagEndPoints=!0}}};function Dc(){this._flagEndPoints=!0}var Li=class extends _t{constructor(t,i,r,o,l,c){super(o),p(this,"_flagRadius",!1),p(this,"_flagCenter",!1),p(this,"_flagFocal",!1),p(this,"_radius",0),p(this,"_center",null),p(this,"_focal",null);for(let h in zr)Object.defineProperty(this,h,zr[h]);this._renderer.type="radial-gradient",this._renderer.flagCenter=jc.bind(this),this._renderer.flagFocal=Uc.bind(this),this.center=new L,this.radius=typeof r=="number"?r:1,this.focal=new L,typeof t=="number"&&(this.center.x=t),typeof i=="number"&&(this.center.y=i),this.focal.copy(this.center),typeof l=="number"&&(this.focal.x=l),typeof c=="number"&&(this.focal.y=c)}clone(t){const i=this.stops.map(function(o){return o.clone()}),r=new Li(this.center._x,this.center._y,this._radius,i,this.focal._x,this.focal._y);return F.each(_t.Properties.concat(Li.Properties),function(o){r[o]=this[o]},this),t&&t.add(r),r}toObject(){const t=super.toObject.call(this);return F.each(Li.Properties,function(i){t[i]=this[i]},this),t.center=this.center.toObject(),t.focal=this.focal.toObject(),t}_update(){return(this._flagRadius||this._flatCenter||this._flagFocal||this._flagSpread||this._flagStops)&&this.trigger(A.Types.change),this}flagReset(){return this._flagRadius=this._flagCenter=this._flagFocal=!1,super.flagReset.call(this),this}},ct=Li;p(ct,"Stop",pe);p(ct,"Properties",["center","radius","focal"]);var zr={radius:{enumerable:!0,get:function(){return this._radius},set:function(t){this._radius=t,this._flagRadius=!0}},center:{enumerable:!0,get:function(){return this._center},set:function(t){this._center&&this._center.unbind(A.Types.change,this._renderer.flagCenter),this._center=t,this._center.bind(A.Types.change,this._renderer.flagCenter),this._flagCenter=!0}},focal:{enumerable:!0,get:function(){return this._focal},set:function(t){this._focal&&this._focal.unbind(A.Types.change,this._renderer.flagFocal),this._focal=t,this._focal.bind(A.Types.change,this._renderer.flagFocal),this._flagFocal=!0}}};function jc(){this._flagCenter=!0}function Uc(){this._flagFocal=!0}var Fi,Ea={video:/\.(mp4|webm|ogg)$/i,image:/\.(jpe?g|png|gif|tiff|webp)$/i,effect:/texture|gradient/i};ut.document&&(Fi=document.createElement("a"));var bt=class extends qi{constructor(t,i){super(),p(this,"_flagSrc",!1),p(this,"_flagImage",!1),p(this,"_flagVideo",!1),p(this,"_flagLoaded",!1),p(this,"_flagRepeat",!1),p(this,"_flagOffset",!1),p(this,"_flagScale",!1),p(this,"_src",""),p(this,"_image",null),p(this,"_loaded",!1),p(this,"_repeat","no-repeat"),p(this,"_scale",1),p(this,"_offset",null),this._renderer={};for(let r in Hr)Object.defineProperty(this,r,Hr[r]);if(this._renderer.type="texture",this._renderer.flagOffset=zc.bind(this),this._renderer.flagScale=Hc.bind(this),this.id=vt.Identifier+vt.uniqueId(),this.classList=[],this.loaded=!1,this.repeat="no-repeat",this.offset=new L,typeof i=="function"){const r=function(){this.unbind(A.Types.load,r),typeof i=="function"&&i()}.bind(this);this.bind(A.Types.load,r)}if(typeof t=="string")this.src=t;else if(typeof t=="object"){const r=Object.prototype.toString.call(t);(r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]"||r==="[object HTMLVideoElement]"||r==="[object Image]")&&(this.image=t)}this._update()}static getAbsoluteURL(t){return Fi?(Fi.href=t,Fi.href):t}static loadHeadlessBuffer(t,i){t.image.onload=i,t.image.src=t.src}static getTag(t){return t&&t.nodeName&&t.nodeName.toLowerCase()||"img"}static getImage(t){const i=bt.getAbsoluteURL(t);if(bt.ImageRegistry.contains(i))return bt.ImageRegistry.get(i);let r;return At.Image?(r=new At.Image,li.Utils.shim(r,"img")):ut.document?Ea.video.test(i)?r=document.createElement("video"):r=document.createElement("img"):console.warn("Two.js: no prototypical image defined for Two.Texture"),r.crossOrigin="anonymous",r}static load(t,i){let r=t.image,o=bt.getTag(r);t._flagImage&&(/canvas/i.test(o)?bt.Register.canvas(t,i):(t._src=!At.isHeadless&&r.getAttribute("two-src")||r.src,bt.Register[o](t,i))),t._flagSrc&&(r||(r=bt.getImage(t.src),t.image=r),o=bt.getTag(r),bt.Register[o](t,i))}clone(){const t=new bt(this.src);return t.repeat=this.repeat,t.offset.copy(this.origin),t.scale=this.scale,t}toObject(){return{src:this.src,repeat:this.repeat,origin:this.origin.toObject(),scale:typeof this.scale=="number"?this.scale:this.scale.toObject()}}_update(){return(this._flagSrc||this._flagImage)&&(this.trigger(A.Types.change),(this._flagSrc||this._flagImage)&&(this.loaded=!1,bt.load(this,function(){this.loaded=!0,this.trigger(A.Types.change).trigger(A.Types.load)}.bind(this)))),this._image&&this._image.readyState>=4&&(this._flagVideo=!0),this}flagReset(){return this._flagSrc=this._flagImage=this._flagLoaded=this._flagRepeat=this._flagVideo=this._flagScale=this._flagOffset=!1,super.flagReset.call(this),this}},Q=bt;p(Q,"Properties",["src","loaded","repeat","scale","offset","image"]);p(Q,"RegularExpressions",Ea);p(Q,"ImageRegistry",new Gi);p(Q,"Register",{canvas:function(t,i){t._src="#"+t.id,bt.ImageRegistry.add(t.src,t.image),typeof i=="function"&&i()},img:function(t,i){const r=t.image,o=function(c){!At.isHeadless&&r.removeEventListener&&typeof r.removeEventListener=="function"&&(r.removeEventListener("load",o,!1),r.removeEventListener("error",l,!1)),typeof i=="function"&&i()},l=function(c){throw!At.isHeadless&&typeof r.removeEventListener=="function"&&(r.removeEventListener("load",o,!1),r.removeEventListener("error",l,!1)),new Rt("unable to load "+t.src)};typeof r.width=="number"&&r.width>0&&typeof r.height=="number"&&r.height>0?o():!At.isHeadless&&typeof r.addEventListener=="function"&&(r.addEventListener("load",o,!1),r.addEventListener("error",l,!1)),t._src=bt.getAbsoluteURL(t._src),!(!At.isHeadless&&r&&r.getAttribute("two-src"))&&(At.isHeadless||r.setAttribute("two-src",t.src),bt.ImageRegistry.add(t.src,r),At.isHeadless?bt.loadHeadlessBuffer(t,o):t.image.src=t.src)},video:function(t,i){if(At.isHeadless)throw new Rt("video textures are not implemented in headless environments.");const r=function(l){t.image.removeEventListener("canplaythrough",r,!1),t.image.removeEventListener("error",o,!1),t.image.width=t.image.videoWidth,t.image.height=t.image.videoHeight,typeof i=="function"&&i()},o=function(l){throw t.image.removeEventListener("canplaythrough",r,!1),t.image.removeEventListener("error",o,!1),new Rt("unable to load "+t.src)};t._src=bt.getAbsoluteURL(t._src),t.image.getAttribute("two-src")||(t.image.setAttribute("two-src",t.src),bt.ImageRegistry.add(t.src,t.image)),t.image.readyState>=4?r():(t.image.addEventListener("canplaythrough",r,!1),t.image.addEventListener("error",o,!1),t.image.src=t.src,t.image.load())}});var Hr={src:{enumerable:!0,get:function(){return this._src},set:function(t){this._src=t,this._flagSrc=!0}},loaded:{enumerable:!0,get:function(){return this._loaded},set:function(t){this._loaded=t,this._flagLoaded=!0}},repeat:{enumerable:!0,get:function(){return this._repeat},set:function(t){this._repeat=t,this._flagRepeat=!0}},image:{enumerable:!0,get:function(){return this._image},set:function(t){const i=Q.getTag(t);let r;switch(i){case"canvas":r="#"+t.id;break;default:r=t.src}Q.ImageRegistry.contains(r)?this._image=Q.ImageRegistry.get(t.src):this._image=t,this._flagImage=!0}},offset:{enumerable:!0,get:function(){return this._offset},set:function(t){this._offset&&this._offset.unbind(A.Types.change,this._renderer.flagOffset),this._offset=t,this._offset.bind(A.Types.change,this._renderer.flagOffset),this._flagOffset=!0}},scale:{enumerable:!0,get:function(){return this._scale},set:function(t){this._scale instanceof L&&this._scale.unbind(A.Types.change,this._renderer.flagScale),this._scale=t,this._scale instanceof L&&this._scale.bind(A.Types.change,this._renderer.flagScale),this._flagScale=!0}}};function zc(){this._flagOffset=!0}function Hc(){this._flagScale=!0}var oe=Math.min,le=Math.max,Kc=Math.ceil,$c=Math.floor,qc=new L,ei=class extends de{constructor(t,i,r,o){super(),p(this,"_flagVertices",!0),p(this,"_flagLength",!0),p(this,"_flagFill",!0),p(this,"_flagStroke",!0),p(this,"_flagLinewidth",!0),p(this,"_flagOpacity",!0),p(this,"_flagVisible",!0),p(this,"_flagCap",!0),p(this,"_flagJoin",!0),p(this,"_flagMiter",!0),p(this,"_flagMask",!1),p(this,"_flagClip",!1),p(this,"_length",0),p(this,"_fill","#fff"),p(this,"_stroke","#000"),p(this,"_linewidth",1),p(this,"_opacity",1),p(this,"_visible",!0),p(this,"_cap","round"),p(this,"_join","round"),p(this,"_miter",4),p(this,"_closed",!0),p(this,"_curved",!1),p(this,"_automatic",!0),p(this,"_beginning",0),p(this,"_ending",1),p(this,"_mask",null),p(this,"_clip",!1),p(this,"_dashes",null);for(let l in Kr)Object.defineProperty(this,l,Kr[l]);this._renderer.type="path",this._renderer.flagVertices=Sa.bind(this),this._renderer.bindVertices=Aa.bind(this),this._renderer.unbindVertices=Ra.bind(this),this._renderer.flagFill=Ma.bind(this),this._renderer.flagStroke=Ta.bind(this),this._renderer.vertices=[],this._renderer.collection=[],this.closed=!!i,this.curved=!!r,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.linewidth=1,this.opacity=1,this.className="",this.visible=!0,this.cap="butt",this.join="miter",this.miter=4,this.vertices=t,this.automatic=!o,this.dashes=[],this.dashes.offset=0}clone(t){const i=new ei;for(let r=0;r<this.vertices.length;r++)i.vertices.push(this.vertices[r].clone());for(let r=0;r<ei.Properties.length;r++){const o=ei.Properties[r];i[o]=this[o]}return i.className=this.className,i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i.skewX=this.skewX,i.skewY=this.skewY,this.matrix.manual&&i.matrix.copy(this.matrix),t&&t.add(i),i._update()}toObject(){const t={vertices:this.vertices.map(function(i){return i.toObject()})};return F.each(ei.Properties,function(i){typeof this[i]<"u"&&(this[i].toObject?t[i]=this[i].toObject():t[i]=this[i])},this),t.className=this.className,t.translation=this.translation.toObject(),t.rotation=this.rotation,t.scale=this.scale instanceof L?this.scale.toObject():this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&(t.matrix=this.matrix.toObject()),t}noFill(){return this.fill="transparent",this}noStroke(){return this.stroke=void 0,this}corner(){const t=this.getBoundingClientRect(!0),i=t.width/2,r=t.height/2,o=t.left+t.width/2,l=t.top+t.height/2;for(let c=0;c<this.vertices.length;c++){const h=this.vertices[c];h.x-=o,h.y-=l,h.x+=i,h.y+=r}return this.mask&&(this.mask.translation.x-=o,this.mask.translation.x+=i,this.mask.translation.y-=l,this.mask.translation.y+=r),this}center(){const t=this.getBoundingClientRect(!0),i=t.left+t.width/2-this.translation.x,r=t.top+t.height/2-this.translation.y;for(let o=0;o<this.vertices.length;o++){const l=this.vertices[o];l.x-=i,l.y-=r}return this.mask&&(this.mask.translation.x-=i,this.mask.translation.y-=r),this}getBoundingClientRect(t){let i,r,o,l,c,h,u,_,f,y,g,v,b,k,P=1/0,S=-1/0,x=1/0,C=-1/0;if(this._update(!0),i=t?this._matrix:we(this),r=(this.linewidth||0)/2,o=this._renderer.vertices.length,o<=0)return{width:0,height:0};for(l=0;l<o;l++)if(h=this._renderer.vertices[l],c=this._renderer.vertices[(l+o-1)%o],c.controls&&h.controls){u=c.controls.right.x,_=c.controls.right.y,c.relative&&(u+=c.x,_+=c.y),f=h.controls.left.x,y=h.controls.left.y,h.relative&&(f+=h.x,y+=h.y);const R=va(c.x,c.y,u,_,f,y,h.x,h.y);x=oe(R.min.y-r,x),P=oe(R.min.x-r,P),S=le(R.max.x+r,S),C=le(R.max.y+r,C)}else l<=1&&(x=oe(c.y-r,x),P=oe(c.x-r,P),S=le(c.x+r,S),C=le(c.y+r,C)),x=oe(h.y-r,x),P=oe(h.x-r,P),S=le(h.x+r,S),C=le(h.y+r,C);return g=i.multiply(P,x,1),v=i.multiply(P,C,1),b=i.multiply(S,x,1),k=i.multiply(S,C,1),x=oe(g.y,v.y,b.y,k.y),P=oe(g.x,v.x,b.x,k.x),S=le(g.x,v.x,b.x,k.x),C=le(g.y,v.y,b.y,k.y),{top:x,left:P,right:S,bottom:C,width:S-P,height:C-x}}getPointAt(t,i){let r,o,l,c,h,u,_,f,y,g,v,b,k,P,S,x=this.length*Math.min(Math.max(t,0),1);const C=this.vertices.length,R=C-1;let E=null,M=null;for(let at=0,it=this._lengths.length,N=0;at<it;at++){if(N+this._lengths[at]>=x){this._closed?(r=Mt(at,C),o=Mt(at-1,C),at===0&&(r=o,o=at)):(r=at,o=Math.min(Math.max(at-1,0),R)),E=this.vertices[r],M=this.vertices[o],x-=N,this._lengths[at]!==0?t=x/this._lengths[at]:t=0;break}N+=this._lengths[at]}if(E===null||M===null)return null;if(E){if(!M)return E}else return M;S=M.controls&&M.controls.right,P=E.controls&&E.controls.left,h=M.x,g=M.y,u=(S||M).x,v=(S||M).y,_=(P||E).x,b=(P||E).y,f=E.x,k=E.y,S&&M.relative&&(u+=M.x,v+=M.y),P&&E.relative&&(_+=E.x,b+=E.y),c=ri(t,h,u,_,f),y=ri(t,g,v,b,k);const j=Et(h,u,t),O=Et(g,v,t),U=Et(u,_,t),D=Et(v,b,t),I=Et(_,f,t),q=Et(b,k,t),J=Et(j,U,t),nt=Et(O,D,t),Y=Et(U,I,t),wt=Et(D,q,t);return F.isObject(i)?(i.x=c,i.y=y,i instanceof G&&(i.controls.left.x=J,i.controls.left.y=nt,i.controls.right.x=Y,i.controls.right.y=wt,(typeof i.relative!="boolean"||i.relative)&&(i.controls.left.x-=c,i.controls.left.y-=y,i.controls.right.x-=c,i.controls.right.y-=y)),i.t=t,i):(l=new G(c,y,J-c,nt-y,Y-c,wt-y,this._curved?V.curve:V.line),l.t=t,l)}plot(){if(this.curved)return ya(this._collection,this.closed),this;for(let t=0;t<this._collection.length;t++)this._collection[t].command=t===0?V.move:V.line;return this}subdivide(t){this._update();const i=this.vertices.length-1,r=this._closed||this.vertices[i]._command===V.close;let o=this.vertices[i],l=[],c;return F.each(this.vertices,function(h,u){if(u<=0&&!r){o=h;return}if(h.command===V.move){l.push(new G(o.x,o.y)),u>0&&(l[l.length-1].command=V.line),o=h;return}c=Br(h,o,t),l=l.concat(c),F.each(c,function(_,f){f<=0&&o.command===V.move?_.command=V.move:_.command=V.line}),u>=i&&(this._closed&&this._automatic?(o=h,c=Br(h,o,t),l=l.concat(c),F.each(c,function(_,f){f<=0&&o.command===V.move?_.command=V.move:_.command=V.line})):r&&l.push(new G(h.x,h.y)),l[l.length-1].command=r?V.close:V.line),o=h},this),this._automatic=!1,this._curved=!1,this.vertices=l,this}_updateLength(t,i){i||this._update();const r=this.vertices.length,o=r-1,l=!1;let c=this.vertices[o],h=0;return typeof this._lengths>"u"&&(this._lengths=[]),F.each(this.vertices,function(u,_){if(_<=0&&!l||u.command===V.move){c=u,this._lengths[_]=0;return}this._lengths[_]=$s(u,c,t),h+=this._lengths[_],_>=o&&l&&(c=this.vertices[(_+1)%r],this._lengths[_+1]=$s(u,c,t),h+=this._lengths[_+1]),c=u},this),this._length=h,this._flagLength=!1,this}_update(){if(this._flagVertices){this._automatic&&this.plot(),this._flagLength&&this._updateLength(void 0,!0);const t=this._collection.length,i=this._closed,r=Math.min(this._beginning,this._ending),o=Math.max(this._beginning,this._ending),l=Hi(this,r*this._length),c=Hi(this,o*this._length),h=Kc(l),u=$c(c);let _,f,y,g,v,b;for(this._renderer.vertices.length=0,b=0;b<t;b++)this._renderer.collection.length<=b&&this._renderer.collection.push(new G),b>u&&!f?(v=this._renderer.collection[b].copy(this._collection[b]),this.getPointAt(o,v),v.command=this._renderer.collection[b].command,this._renderer.vertices.push(v),f=v,y=this._collection[b-1],y&&y.controls&&(v.relative?v.controls.right.clear():v.controls.right.copy(v),y.relative?this._renderer.collection[b-1].controls.right.copy(y.controls.right).lerp(L.zero,1-v.t):this._renderer.collection[b-1].controls.right.copy(y.controls.right).lerp(y,1-v.t))):b>=h&&b<=u&&(v=this._renderer.collection[b].copy(this._collection[b]),this._renderer.vertices.push(v),b===u&&Nr(this,o)?(f=v,!i&&f.controls&&(f.relative?f.controls.right.clear():f.controls.right.copy(f))):b===h&&Nr(this,r)&&(_=v,_.command=V.move,!i&&_.controls&&(_.relative?_.controls.left.clear():_.controls.left.copy(_))));h>0&&!_&&(b=h-1,v=this._renderer.collection[b].copy(this._collection[b]),this.getPointAt(r,v),v.command=V.move,this._renderer.vertices.unshift(v),g=this._collection[b+1],g&&g.controls&&(v.controls.left.clear(),g.relative?this._renderer.collection[b+1].controls.left.copy(g.controls.left).lerp(L.zero,v.t):(qc.copy(g),this._renderer.collection[b+1].controls.left.copy(g.controls.left).lerp(g,v.t))))}return de.prototype._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagCap=this._flagJoin=this._flagMiter=this._flagClip=!1,de.prototype.flagReset.call(this),this}},W=ei;p(W,"Properties",["fill","stroke","linewidth","opacity","visible","cap","join","miter","closed","curved","automatic","beginning","ending"]);p(W,"Utils",{getCurveLength:$s});var Kr={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(t){this._linewidth=t,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(t){this._opacity=t,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(t){this._visible=t,this._flagVisible=!0}},cap:{enumerable:!0,get:function(){return this._cap},set:function(t){this._cap=t,this._flagCap=!0}},join:{enumerable:!0,get:function(){return this._join},set:function(t){this._join=t,this._flagJoin=!0}},miter:{enumerable:!0,get:function(){return this._miter},set:function(t){this._miter=t,this._flagMiter=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(t){(this._fill instanceof _t||this._fill instanceof ht||this._fill instanceof ct||this._fill instanceof Q)&&this._fill.unbind(A.Types.change,this._renderer.flagFill),this._fill=t,this._flagFill=!0,(this._fill instanceof _t||this._fill instanceof ht||this._fill instanceof ct||this._fill instanceof Q)&&this._fill.bind(A.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(t){(this._stroke instanceof _t||this._stroke instanceof ht||this._stroke instanceof ct||this._stroke instanceof Q)&&this._stroke.unbind(A.Types.change,this._renderer.flagStroke),this._stroke=t,this._flagStroke=!0,(this._stroke instanceof _t||this._stroke instanceof ht||this._stroke instanceof ct||this._stroke instanceof Q)&&this._stroke.bind(A.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},closed:{enumerable:!0,get:function(){return this._closed},set:function(t){this._closed=!!t,this._flagVertices=!0}},curved:{enumerable:!0,get:function(){return this._curved},set:function(t){this._curved=!!t,this._flagVertices=!0}},automatic:{enumerable:!0,get:function(){return this._automatic},set:function(t){if(t===this._automatic)return;this._automatic=!!t;const i=this._automatic?"ignore":"listen";F.each(this.vertices,function(r){r[i]()})}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(t){this._beginning=t,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(t){this._ending=t,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(t){const i=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(A.Types.insert,i).unbind(A.Types.remove,r),t instanceof ue?this._collection=t:this._collection=new ue(t||[]),this._collection.bind(A.Types.insert,i).bind(A.Types.remove,r),i(this._collection)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(t){this._mask=t,this._flagMask=!0,F.isObject(t)&&!t.clip&&(t.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(t){typeof t.offset!="number"&&(t.offset=this.dashes&&this._dashes.offset||0),this._dashes=t}}};function Sa(){this._flagVertices=!0,this._flagLength=!0,this.parent&&(this.parent._flagLength=!0)}function Aa(t){let i=t.length;for(;i--;)t[i].bind(A.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function Ra(t){let i=t.length;for(;i--;)t[i].unbind(A.Types.change,this._renderer.flagVertices);this._renderer.flagVertices()}function Ma(){this._flagFill=!0}function Ta(){this._flagStroke=!0}var Va=class extends W{constructor(t,i,r,o){const l=[new G,new G,new G,new G];super(l,!0,!1,!0),p(this,"_flagWidth",0),p(this,"_flagHeight",0),p(this,"_width",0),p(this,"_height",0),p(this,"_origin",null);for(let c in $r)Object.defineProperty(this,c,$r[c]);this.width=typeof r=="number"?r:1,this.height=typeof o=="number"?o:1,this.origin=new L,typeof t=="number"&&(this.translation.x=t),typeof i=="number"&&(this.translation.y=i),this._update()}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){const t=this._width/2,i=this._height/2;!this._closed&&this.vertices.length===4&&this.vertices.push(new G),this.vertices[0].set(-t,-i).sub(this._origin).command=V.move,this.vertices[1].set(t,-i).sub(this._origin).command=V.line,this.vertices[2].set(t,i).sub(this._origin).command=V.line,this.vertices[3].set(-t,i).sub(this._origin).command=V.line,this.vertices[4]&&(this.vertices[4].set(-t,-i).sub(this._origin).command=V.line)}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(t){const i=new Va(0,0,this.width,this.height);i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i.skewX=this.skewX,i.skewY=this.skewY,this.matrix.manual&&i.matrix.copy(this.matrix);for(let r=0;r<W.Properties.length;r++){const o=W.Properties[r];i[o]=this[o]}return t&&t.add(i),i}toObject(){const t=super.toObject.call(this);return t.width=this.width,t.height=this.height,t.origin=this.origin.toObject(),t}},xe=Va;p(xe,"Properties",["width","height"]);var $r={width:{enumerable:!0,get:function(){return this._width},set:function(t){this._width=t,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(t){this._height=t,this._flagHeight=!0}},origin:{enumerable:!0,get:function(){return this._origin},set:function(t){this._origin&&this._origin.unbind(A.Types.change,this._renderer.flagVertices),this._origin=t,this._origin.bind(A.Types.change,this._renderer.flagVertices),this._renderer.flagVertices()}}},La=class extends xe{constructor(t,i,r,o,l,c){super(i,r,0,0),p(this,"_flagTexture",!1),p(this,"_flagColumns",!1),p(this,"_flagRows",!1),p(this,"_flagFrameRate",!1),p(this,"_flagIndex",!1),p(this,"_amount",1),p(this,"_duration",0),p(this,"_startTime",0),p(this,"_playing",!1),p(this,"_firstFrame",0),p(this,"_lastFrame",0),p(this,"_loop",!0),p(this,"_texture",null),p(this,"_columns",1),p(this,"_rows",1),p(this,"_frameRate",0),p(this,"_index",0),p(this,"_origin",null);for(let h in qr)Object.defineProperty(this,h,qr[h]);this.noStroke(),this.noFill(),t instanceof Q?this.texture=t:typeof t=="string"&&(this.texture=new Q(t)),this.origin=new L,this._update(),typeof o=="number"&&(this.columns=o),typeof l=="number"&&(this.rows=l),typeof c=="number"&&(this.frameRate=c),this.index=0}play(t,i,r){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=F.performance.now(),typeof t=="number"&&(this._firstFrame=t),typeof i=="number"&&(this._lastFrame=i),typeof r=="function"?this._onLastFrame=r:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=0,this}clone(t){const i=new La(this.texture,this.translation.x,this.translation.y,this.columns,this.rows,this.frameRate);return this.playing&&(i.play(this._firstFrame,this._lastFrame),i._loop=this._loop),t&&t.add(i),i}toObject(){const t=super.toObject.call(this);return t.texture=this.texture.toObject(),t.columns=this.columns,t.rows=this.rows,t.frameRate=this.frameRate,t.index=this.index,t._firstFrame=this._firstFrame,t._lastFrame=this._lastFrame,t._loop=this._loop,t}_update(){const t=this._texture,i=this._columns,r=this._rows;let o,l,c,h,u,_,f,y,g;if(t&&((this._flagColumns||this._flagRows)&&(this._amount=this._columns*this._rows),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._flagTexture&&(this.fill=t),t.loaded)){f=t.image.width,y=t.image.height,o=f/i,l=y/r,h=this._amount,this.width!==o&&(this.width=o),this.height!==l&&(this.height=l),this._playing&&this._frameRate>0&&(F.isNaN(this._lastFrame)&&(this._lastFrame=h-1),c=F.performance.now()-this._startTime,g=this._lastFrame+1,u=1e3*(g-this._firstFrame)/this._frameRate,this._loop?c=c%u:c=Math.min(c,u),_=Et(this._firstFrame,g,c/u),_=Math.floor(_),_!==this._index&&(this._index=_,_>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()));const v=this._index%i,b=Math.floor(this._index/i),k=-o*v+(f-o)/2,P=-l*b+(y-l)/2;k!==t.offset.x&&(t.offset.x=k),P!==t.offset.y&&(t.offset.y=P)}return super._update.call(this),this}flagReset(){return this._flagTexture=this._flagColumns=this._flagRows=this._flagFrameRate=!1,super.flagReset.call(this),this}},Yi=La;p(Yi,"Properties",["texture","columns","rows","frameRate","index"]);var qr={texture:{enumerable:!0,get:function(){return this._texture},set:function(t){this._texture=t,this._flagTexture=!0}},columns:{enumerable:!0,get:function(){return this._columns},set:function(t){this._columns=t,this._flagColumns=!0}},rows:{enumerable:!0,get:function(){return this._rows},set:function(t){this._rows=t,this._flagRows=!0}},frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(t){this._index=t,this._flagIndex=!0}}},Bs=Math.cos,Ds=Math.sin,Oi=class extends W{constructor(t,i,r,o){const l=o?Math.max(o,2):4,c=[];for(let h=0;h<l;h++)c.push(new G(0,0,0,0,0,0));super(c,!0,!0,!0),p(this,"_flagRadius",!1),p(this,"_radius",0);for(let h in Gr)Object.defineProperty(this,h,Gr[h]);typeof r=="number"&&(this.radius=r),this._update(),typeof t=="number"&&(this.translation.x=t),typeof i=="number"&&(this.translation.y=i)}_update(){if(this._flagVertices||this._flagRadius){let t=this.vertices.length;!this._closed&&t>2&&(t-=1);const i=4/3*Math.tan(Math.PI/(t*2)),r=this._radius,o=r*i;for(let l=0;l<this.vertices.length;l++){const h=l/t*xt,u=r*Bs(h),_=r*Ds(h),f=o*Bs(h-gt),y=o*Ds(h-gt),g=o*Bs(h+gt),v=o*Ds(h+gt),b=this.vertices[l];b.command=l===0?V.move:V.curve,b.set(u,_),b.controls.left.set(f,y),b.controls.right.set(g,v)}}return super._update.call(this),this}flagReset(){return this._flagRadius=!1,super.flagReset.call(this),this}clone(t){const i=new Oi(0,0,this.radius,this.vertices.length);i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i.skewX=this.skewX,i.skewY=this.skewY,this.matrix.manual&&i.matrix.copy(this.matrix);for(let r=0;r<W.Properties.length;r++){const o=W.Properties[r];i[o]=this[o]}return t&&t.add(i),i}toObject(){const t=super.toObject.call(this);for(let i=0;i<Oi.Properties.length;i++){const r=Oi.Properties[i];t[r]=this[r]}return t}},Xi=Oi;p(Xi,"Properties",["radius"]);var Gr={radius:{enumerable:!0,get:function(){return this._radius},set:function(t){this._radius=t,this._flagRadius=!0}}},js=Math.cos,Us=Math.sin,Ii=class extends W{constructor(t,i,r,o,l){typeof o!="number"&&typeof r=="number"&&(o=r);const c=l?Math.max(l,2):4,h=[];for(let u=0;u<c;u++)h.push(new G);super(h,!0,!0,!0),p(this,"_flagWidth",!1),p(this,"_flagHeight",!1),p(this,"_width",0),p(this,"_height",0);for(let u in Yr)Object.defineProperty(this,u,Yr[u]);typeof r=="number"&&(this.width=r*2),typeof o=="number"&&(this.height=o*2),this._update(),typeof t=="number"&&(this.translation.x=t),typeof i=="number"&&(this.translation.y=i)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight){let t=this.vertices.length;!this._closed&&t>2&&(t-=1);const i=4/3*Math.tan(Math.PI/(this.vertices.length*2)),r=this._width/2,o=this._height/2;for(let l=0;l<this.vertices.length;l++){const h=l/t*xt,u=r*js(h),_=o*Us(h),f=r*i*js(h-gt),y=o*i*Us(h-gt),g=r*i*js(h+gt),v=o*i*Us(h+gt),b=this.vertices[l];b.command=l===0?V.move:V.curve,b.set(u,_),b.controls.left.set(f,y),b.controls.right.set(g,v)}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=!1,super.flagReset.call(this),this}clone(t){const i=this.width/2,r=this.height/2,o=this.vertices.length,l=new Ii(0,0,i,r,o);l.translation.copy(this.translation),l.rotation=this.rotation,l.scale=this.scale,l.skewX=this.skewX,l.skewY=this.skewY,this.matrix.manual&&l.matrix.copy(this.matrix);for(let c=0;c<W.Properties.length;c++){const h=W.Properties[c];l[h]=this[h]}return t&&t.add(l),l}toObject(){const t=super.toObject.call(this);for(let i=0;i<Ii.Properties.length;i++){const r=Ii.Properties[i];t[r]=this[r]}return t}},Wi=Ii;p(Wi,"Properties",["width","height"]);var Yr={width:{enumerable:!0,get:function(){return this._width},set:function(t){this._width=t,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(t){this._height=t,this._flagHeight=!0}}},Ws=class extends W{constructor(t,i,r,o){const l=[new G(t,i),new G(r,o)];super(l);for(let c in Xr)Object.defineProperty(this,c,Xr[c]);this.vertices[0].command=V.move,this.vertices[1].command=V.line,this.automatic=!1}},Xr={left:{enumerable:!0,get:function(){return this.vertices[0]},set:function(t){if(F.isObject(t))this.vertices.splice(0,1,t);else{const i=new Rt("Two.Line.x argument is not an object.");console.warn(i.name,i.message)}}},right:{enumerable:!0,get:function(){return this.vertices[0]},set:function(t){if(F.isObject(t))this.vertices.splice(1,1,t);else{const i=new Rt("Two.Line.y argument is not an object.");console.warn(i.name,i.message)}}}},Ni=class extends W{constructor(t,i,r,o,l){typeof l>"u"&&typeof r=="number"&&typeof o=="number"&&(l=Math.floor(Math.min(r,o)/12));const c=[];for(let h=0;h<10;h++)c.push(new G(0,0,0,0,0,0,h===0?V.move:V.curve));super(c),p(this,"_flagWidth",!1),p(this,"_flagHeight",!1),p(this,"_flagRadius",!1),p(this,"_width",0),p(this,"_height",0),p(this,"_radius",12);for(let h in Wr)Object.defineProperty(this,h,Wr[h]);this.closed=!0,this.automatic=!1,this._renderer.flagRadius=Gc.bind(this),typeof r=="number"&&(this.width=r),typeof o=="number"&&(this.height=o),typeof l=="number"&&(this.radius=l),this._update(),typeof t=="number"&&(this.translation.x=t),typeof i=="number"&&(this.translation.y=i)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagRadius){const t=this._width,i=this._height;let r,o;this._radius instanceof L?(r=this._radius.x,o=this._radius.y):(r=this._radius,o=this._radius);let l,c=t/2,h=i/2;l=this.vertices[0],l.x=-(c-r),l.y=-h,l=this.vertices[1],l.x=c-r,l.y=-h,l.controls.left.clear(),l.controls.right.x=r,l.controls.right.y=0,l=this.vertices[2],l.x=c,l.y=-(h-o),l.controls.right.clear(),l.controls.left.clear(),l=this.vertices[3],l.x=c,l.y=h-o,l.controls.left.clear(),l.controls.right.x=0,l.controls.right.y=o,l=this.vertices[4],l.x=c-r,l.y=h,l.controls.right.clear(),l.controls.left.clear(),l=this.vertices[5],l.x=-(c-r),l.y=h,l.controls.left.clear(),l.controls.right.x=-r,l.controls.right.y=0,l=this.vertices[6],l.x=-c,l.y=h-o,l.controls.left.clear(),l.controls.right.clear(),l=this.vertices[7],l.x=-c,l.y=-(h-o),l.controls.left.clear(),l.controls.right.x=0,l.controls.right.y=-o,l=this.vertices[8],l.x=-(c-r),l.y=-h,l.controls.left.clear(),l.controls.right.clear(),l=this.vertices[9],l.copy(this.vertices[8])}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagRadius=!1,super.flagReset.call(this),this}clone(t){const i=this.width,r=this.height,o=this.radius,l=new Ni(0,0,i,r,o);l.translation.copy(this.translation),l.rotation=this.rotation,l.scale=this.scale,l.skewX=this.skewX,l.skewY=this.skewY,this.matrix.manual&&l.matrix.copy(this.matrix);for(let c=0;c<W.Properties.length;c++){const h=W.Properties[c];l[h]=this[h]}return t&&t.add(l),l}toObject(){const t=super.toObject.call(this);for(let i=0;i<Ni.Properties.length;i++){const r=Ni.Properties[i];t[r]=this[r]}return t.radius=typeof this.radius=="number"?this.radius:this.radius.toObject(),t}},Ji=Ni;p(Ji,"Properties",["width","height","radius"]);var Wr={width:{enumerable:!0,get:function(){return this._width},set:function(t){this._width=t,this._flagWidth=!0}},height:{enumerable:!0,get:function(){return this._height},set:function(t){this._height=t,this._flagHeight=!0}},radius:{enumerable:!0,get:function(){return this._radius},set:function(t){this._radius instanceof L&&this._radius.unbind(A.Types.change,this._renderer.flagRadius),this._radius=t,this._radius instanceof L&&this._radius.bind(A.Types.change,this._renderer.flagRadius),this._flagRadius=!0}}};function Gc(){this._flagRadius=!0}var Jr=Math.min,Zr=Math.max,Jt=class extends de{constructor(t,i,r,o){super(),p(this,"_flagValue",!0),p(this,"_flagFamily",!0),p(this,"_flagSize",!0),p(this,"_flagLeading",!0),p(this,"_flagAlignment",!0),p(this,"_flagBaseline",!0),p(this,"_flagStyle",!0),p(this,"_flagWeight",!0),p(this,"_flagDecoration",!0),p(this,"_flagFill",!0),p(this,"_flagStroke",!0),p(this,"_flagLinewidth",!0),p(this,"_flagOpacity",!0),p(this,"_flagVisible",!0),p(this,"_flagMask",!1),p(this,"_flagClip",!1),p(this,"_value",""),p(this,"_family","sans-serif"),p(this,"_size",13),p(this,"_leading",17),p(this,"_alignment","center"),p(this,"_baseline","middle"),p(this,"_style","normal"),p(this,"_weight",500),p(this,"_decoration","none"),p(this,"_fill","#000"),p(this,"_stroke","transparent"),p(this,"_linewidth",1),p(this,"_opacity",1),p(this,"_visible",!0),p(this,"_mask",null),p(this,"_clip",!1),p(this,"_dashes",null);for(let l in Qr)Object.defineProperty(this,l,Qr[l]);if(this._renderer.type="text",this._renderer.flagFill=Yc.bind(this),this._renderer.flagStroke=Xc.bind(this),this.value=t,typeof i=="number"&&(this.translation.x=i),typeof r=="number"&&(this.translation.y=r),this.dashes=[],this.dashes.offset=0,!F.isObject(o))return this;for(let l=0;l<Jt.Properties.length;l++){const c=Jt.Properties[l];c in o&&(this[c]=o[c])}}clone(t){const i=new Jt(this.value);i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale;for(let r=0;r<Jt.Properties.length;r++){const o=Jt.Properties[r];i[o]=this[o]}return this.matrix.manual&&i.matrix.copy(this.matrix),t&&t.add(i),i._update()}toObject(){const t={translation:this.translation.toObject(),rotation:this.rotation,scale:this.scale};this.matrix.manual&&(t.matrix=this.matrix.toObject());for(let i=0;i<Jt.Properties.length;i++){const r=Jt.Properties[i];t[r]=this[r]}return t}noFill(){return this.fill="transparent",this}noStroke(){return this.stroke=void 0,this.linewidth=void 0,this}getBoundingClientRect(t){let i,r,o,l,c,h,u,_,f;this._update(!0),i=t?this._matrix:we(this);const y=this.leading,g=this.value.length*this.size*Jt.Ratio,v=(this._linewidth||0)/2;switch(this.alignment){case"left":h=-v,u=g+v;break;case"right":h=-(g+v),u=v;break;default:h=-(g/2+v),u=g/2+v}switch(this.baseline){case"top":_=-v,f=y+v;break;case"bottom":_=-(y+v),f=v;break;default:_=-(y/2+v),f=y/2+v}return r=i.multiply(h,_,1),o=i.multiply(h,f,1),l=i.multiply(u,_,1),c=i.multiply(u,f,1),_=Jr(r.y,o.y,l.y,c.y),h=Jr(r.x,o.x,l.x,c.x),u=Zr(r.x,o.x,l.x,c.x),f=Zr(r.y,o.y,l.y,c.y),{top:_,left:h,right:u,bottom:f,width:u-h,height:f-_}}flagReset(){return super.flagReset.call(this),this._flagValue=this._flagFamily=this._flagSize=this._flagLeading=this._flagAlignment=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagClip=this._flagDecoration=this._flagClassName=this._flagBaseline=this._flagWeight=this._flagStyle=!1,this}},Bt=Jt;p(Bt,"Ratio",.6);p(Bt,"Properties",["value","family","size","leading","alignment","linewidth","style","weight","decoration","baseline","opacity","visible","fill","stroke"]);var Qr={value:{enumerable:!0,get:function(){return this._value},set:function(t){this._value=t,this._flagValue=!0}},family:{enumerable:!0,get:function(){return this._family},set:function(t){this._family=t,this._flagFamily=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(t){this._size=t,this._flagSize=!0}},leading:{enumerable:!0,get:function(){return this._leading},set:function(t){this._leading=t,this._flagLeading=!0}},alignment:{enumerable:!0,get:function(){return this._alignment},set:function(t){this._alignment=t,this._flagAlignment=!0}},linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(t){this._linewidth=t,this._flagLinewidth=!0}},style:{enumerable:!0,get:function(){return this._style},set:function(t){this._style=t,this._flagStyle=!0}},weight:{enumerable:!0,get:function(){return this._weight},set:function(t){this._weight=t,this._flagWeight=!0}},decoration:{enumerable:!0,get:function(){return this._decoration},set:function(t){this._decoration=t,this._flagDecoration=!0}},baseline:{enumerable:!0,get:function(){return this._baseline},set:function(t){this._baseline=t,this._flagBaseline=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(t){this._opacity=t,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(t){this._visible=t,this._flagVisible=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(t){(this._fill instanceof _t||this._fill instanceof ht||this._fill instanceof ct||this._fill instanceof Q)&&this._fill.unbind(A.Types.change,this._renderer.flagFill),this._fill=t,this._flagFill=!0,(this._fill instanceof _t||this._fill instanceof ht||this._fill instanceof ct||this._fill instanceof Q)&&this._fill.bind(A.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(t){(this._stroke instanceof _t||this._stroke instanceof ht||this._stroke instanceof ct||this._stroke instanceof Q)&&this._stroke.unbind(A.Types.change,this._renderer.flagStroke),this._stroke=t,this._flagStroke=!0,(this._stroke instanceof _t||this._stroke instanceof ht||this._stroke instanceof ct||this._stroke instanceof Q)&&this._stroke.bind(A.Types.change,this._renderer.flagStroke)}},mask:{enumerable:!0,get:function(){return this._mask},set:function(t){this._mask=t,this._flagMask=!0,F.isObject(t)&&!t.clip&&(t.clip=!0)}},clip:{enumerable:!0,get:function(){return this._clip},set:function(t){this._clip=t,this._flagClip=!0}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(t){typeof t.offset!="number"&&(t.offset=this.dashes&&this._dashes.offset||0),this._dashes=t}}};function Yc(){this._flagFill=!0}function Xc(){this._flagStroke=!0}var Kt={path:/[+-]?(?:\d*\.\d+|\d+)(?:[eE][+-]\d+)?/g,cssBackgroundImage:/url\(['"]?#([\w\d-_]*)['"]?\)/i,unitSuffix:/[a-zA-Z%]*/i},Wc={start:"left",middle:"center",end:"right"},ta=["id","class","transform","xmlns","viewBox"],Jc=["x","y","width","height","href","xlink:href"];function Zc(t){return Wc[t]}function Qc(t){const i=t.getAttribute("dominant-baseline"),r=t.getAttribute("alignment-baseline");return i||r}function ai(t){return t.replace(/svg:/ig,"").toLowerCase()}function ea(t,i){if(i.x+=t.translateX,i.y+=t.translateY,i.x*=t.scaleX,i.y*=t.scaleY,t.rotation!==0){const r=i.length();i.x=r*Math.cos(t.rotation),i.y=r*Math.sin(t.rotation)}}function td(t,i){i||(i={});const r=t.split(";");for(let o=0;o<r.length;o++){const l=r[o].split(":"),c=l[0],h=l[1];typeof c>"u"||typeof h>"u"||(i[c]=h.replace(/\s/,""))}return i}function ed(t){const i={},r=id(t),o=Math.max(r.length,t.style.length);for(let l=0;l<o;l++){const c=t.style[l],h=r[l];c&&(i[c]=t.style[c]),h&&(i[h]=t.getAttribute(h))}return i}function id(t){const i=t.getAttributeNames();for(let r=0;r<ta.length;r++){const o=ta[r],l=Array.prototype.indexOf.call(i,o);l>=0&&i.splice(l,1)}return i}function sd(t,i){const r=i.split(/[\s,]/),o=-parseFloat(r[0]),l=-parseFloat(r[1]),c=parseFloat(r[2]),h=parseFloat(r[3]);if(o&&l)for(let g=0;g<t.children.length;g++){const v=t.children[g];"translation"in v?v.translation.add(o,l):"x"in v?v.x=o:"y"in v&&(v.y=l)}const u=typeof t.x=="number",_=typeof t.y=="number",f=typeof t.width=="number",y=typeof t.height=="number";return u&&(t.translation.x+=t.x),_&&(t.translation.y+=t.y),(f||y)&&(t.scale=new L(1,1)),f&&(t.scale.x=t.width/c),y&&(t.scale.y=t.height/h),t.mask=new xe(0,0,c,h),t.mask.origin.set(-c/2,-h/2),t}function Ft(t,i,r){const o={},l={},c={};let h,u,_,f,y,g,v,b,k,P,S,x,C,R,E,M,j;if(ut.getComputedStyle){const O=ut.getComputedStyle(t);for(h=O.length;h--;)_=O[h],f=O[_],typeof f<"u"&&(o[_]=f)}for(h=0;h<t.attributes.length;h++)g=t.attributes[h],/style/i.test(g.nodeName)?td(g.value,c):l[g.nodeName]=g.value;typeof o.opacity<"u"&&(o["stroke-opacity"]=o.opacity,o["fill-opacity"]=o.opacity,delete o.opacity),r&&F.defaults(o,r),F.extend(o,c,l),o.visible=!(typeof o.display>"u"&&/none/i.test(o.display))||typeof o.visibility>"u"&&/hidden/i.test(o.visibility);for(_ in o)switch(f=o[_],_){case"gradientTransform":if(/none/i.test(f)||(u=t.gradientTransform&&t.gradientTransform.baseVal&&t.gradientTransform.baseVal.length>0?t.gradientTransform.baseVal[0].matrix:t.getCTM?t.getCTM():null,u===null))break;switch(v=ni(u),i._renderer.type){case"linear-gradient":ea(v,i.left),ea(v,i.right);break;case"radial-gradient":i.center.x+=v.translateX,i.center.y+=v.translateY,i.focal.x+=v.translateX,i.focal.y+=v.translateY,i.radius*=Math.max(v.scaleX,v.scaleY);break}break;case"transform":if(/none/i.test(f)||(u=t.transform&&t.transform.baseVal&&t.transform.baseVal.length>0?t.transform.baseVal[0].matrix:t.getCTM?t.getCTM():null,u===null))break;v=ni(u),i.translation.set(v.translateX,v.translateY),i.rotation=Math.PI*(v.rotation/180),i.scale=new L(v.scaleX,v.scaleY),b=parseFloat((o.x+"").replace("px")),k=parseFloat((o.y+"").replace("px")),b&&(i.translation.x=b),k&&(i.translation.y=k);break;case"visible":if(i instanceof ft){i._visible=f;break}i.visible=f;break;case"stroke-linecap":if(i instanceof ft){i._cap=f;break}i.cap=f;break;case"stroke-linejoin":if(i instanceof ft){i._join=f;break}i.join=f;break;case"stroke-miterlimit":if(i instanceof ft){i._miter=f;break}i.miter=f;break;case"stroke-width":if(i instanceof ft){i._linewidth=parseFloat(f);break}i.linewidth=parseFloat(f);break;case"opacity":case"stroke-opacity":case"fill-opacity":if(i instanceof ft){i._opacity=parseFloat(f);break}i.opacity=parseFloat(f);break;case"clip-path":if(Kt.cssBackgroundImage.test(f)&&(P=f.replace(Kt.cssBackgroundImage,"$1"),lt.defs.current&&lt.defs.current.contains(P)&&(x=lt.defs.current.get(P),x&&x.childNodes.length>0)))switch(x=x.childNodes[0],C=ai(x.nodeName),i.mask=lt[C].call(this,x,{}),i._renderer.type){case"text":case"path":i.position.add(i.mask.position),i.mask.position.clear();break}break;case"fill":case"stroke":y=(i instanceof ft?"_":"")+_,Kt.cssBackgroundImage.test(f)?(P=f.replace(Kt.cssBackgroundImage,"$1"),lt.defs.current&&lt.defs.current.contains(P)?(x=lt.defs.current.get(P),x.object||(C=ai(x.nodeName),x.object=lt[C].call(this,x,{})),x=x.object):(S=rd(this),x=S.getById(P)),i[y]=x):i[y]=/none/i.test(f)?"transparent":f;break;case"id":i.id=f;break;case"class":case"className":i.classList=f.split(" "),i._flagClassName=!0;break;case"x":case"y":if(R=i instanceof _t,E=i instanceof ht,M=i instanceof ct,R||E||M)break;f.match("[a-z%]$")&&!f.endsWith("px")&&(j=new Rt("only pixel values are supported with the "+_+" attribute."),console.warn(j.name,j.message)),i.translation[_]=parseFloat(f);break;case"font-family":i instanceof Bt&&(i.family=f);break;case"font-size":i instanceof Bt&&(i.size=f);break;case"font-weight":i instanceof Bt&&(i.weight=f);break;case"font-style":i instanceof Bt&&(i.style=f);break;case"text-decoration":i instanceof Bt&&(i.decoration=f);break;case"line-height":i instanceof Bt&&(i.leading=f);break}return Object.keys(t.dataset).length&&(i.dataset=t.dataset),o}function nd(t,i){for(let r=0,o=t.childNodes.length;r<o;r++){const l=t.childNodes[r];!l.id||ai(t.nodeName)==="#text"||i.add(l.id,l)}}function rd(t){for(;t.parent;)t=t.parent;return t.scene}var lt={svg:function(t){const i=lt.defs.current=new Gi,r=t.getElementsByTagName("defs");for(let k=0;k<r.length;k++)nd(r[k],i);const o=lt.g.call(this,t),l=t.getAttribute("viewBox"),c=t.getAttribute("x"),h=t.getAttribute("y"),u=t.getAttribute("width"),_=t.getAttribute("height");o.defs=i;const f=l!==null,y=c!==null,g=h!==null,v=u!==null,b=_!==null;return y&&(o.x=parseFloat(c.replace(Kt.unitSuffix,""))),g&&(o.y=parseFloat(h.replace(Kt.unitSuffix,""))),v&&(o.width=parseFloat(u.replace(Kt.unitSuffix,""))),b&&(o.height=parseFloat(_.replace(Kt.unitSuffix,""))),f&&sd(o,l),delete lt.defs.current,o},defs:function(t){return null},use:function(t,i){let r;const o=t.getAttribute("href")||t.getAttribute("xlink:href");if(!o)return r=new Rt("encountered <use /> with no href."),console.warn(r.name,r.message),null;const l=o.slice(1);if(!lt.defs.current.contains(l))return r=new Rt("unable to find element for reference "+o+"."),console.warn(r.name,r.message),null;const h=lt.defs.current.get(l).cloneNode(!0);for(let _=0;_<t.attributes.length;_++){const f=t.attributes[_],y=Jc.includes(f.nodeName),g=!h.hasAttribute(f.nodeName);(y||g)&&h.setAttribute(f.nodeName,f.value)}const u=ai(h.nodeName);return lt[u].call(this,h,i)},g:function(t,i){const r=new ft;Ft.call(this,t,r,i),this.add(r);const o=ed.call(this,t);for(let l=0,c=t.childNodes.length;l<c;l++){const h=t.childNodes[l],u=h.nodeName;if(!u)return;const _=ai(u);if(_ in lt){const f=lt[_].call(r,h,o);f&&!f.parent&&r.add(f)}}return r},polygon:function(t,i){let r;typeof t=="string"?r=t:r=t.getAttribute("points");const o=[];r.replace(/(-?[\d.eE-]+)[,|\s](-?[\d.eE-]+)/g,function(c,h,u){o.push(new G(parseFloat(h),parseFloat(u)))});const l=new W(o,!0).noStroke();return l.fill="black",Ft.call(this,t,l,i),l},polyline:function(t,i){const r=lt.polygon.call(this,t,i);return r.closed=!1,r},path:function(t,i){let r;typeof t=="string"?r=t:r=t.getAttribute("d");let o=[],l=!1,c=!1;if(r){let u=new G,_,f,y=r.match(/[a-df-z][^a-df-z]*/ig);const g=y.length-1;F.each(y.slice(0),function(v,b){const k=v.slice(1).trim().match(Kt.path),P=v[0],S=P.toLowerCase();let x,C,R,E,M;const j=[];switch(b===0&&(y=[]),S){case"h":case"v":k.length>1&&(x=1);break;case"m":case"l":case"t":k.length>2&&(x=2);break;case"s":case"q":k.length>4&&(x=4);break;case"c":k.length>6&&(x=6);break;case"a":k.length>7&&(x=7);break}if(x){for(C=0,R=k.length,M=0;C<R;C+=x){if(E=P,M>0)switch(P){case"m":E="l";break;case"M":E="L";break}j.push(E+k.slice(C,C+x).join(" ")),M++}y=Array.prototype.concat.apply(y,j)}else y.push(v)}),F.each(y,function(v,b){let k,P,S;const x=v[0],C=x.toLowerCase();f=v.slice(1).trim().match(Kt.path),c=x===C;let R,E,M,j,O,U,D,I,q,J,nt,Y,wt,at,it,N,kt;switch(C){case"z":if(b>=g)l=!0;else{P=u.x,S=u.y,k=new G(P,S,void 0,void 0,void 0,void 0,V.close);for(let Nt=o.length-1;Nt>=0;Nt--){const Ut=o[Nt];if(/m/i.test(Ut.command)){u=Ut;break}}}break;case"m":case"l":_=void 0,P=parseFloat(f[0]),S=parseFloat(f[1]),k=new G(P,S,void 0,void 0,void 0,void 0,/m/i.test(C)?V.move:V.line),c&&k.addSelf(u),u=k;break;case"h":case"v":J=/h/i.test(C)?"x":"y",nt=/x/i.test(J)?"y":"x",k=new G(void 0,void 0,void 0,void 0,void 0,void 0,V.line),k[J]=parseFloat(f[0]),k[nt]=u[nt],c&&(k[J]+=u[J]),u=k;break;case"c":case"s":R=u.x,E=u.y,_||(_=new L),/c/i.test(C)?(M=parseFloat(f[0]),j=parseFloat(f[1]),O=parseFloat(f[2]),U=parseFloat(f[3]),D=parseFloat(f[4]),I=parseFloat(f[5])):(q=Hs(u,_,c),M=q.x,j=q.y,O=parseFloat(f[0]),U=parseFloat(f[1]),D=parseFloat(f[2]),I=parseFloat(f[3])),c&&(M+=R,j+=E,O+=R,U+=E,D+=R,I+=E),u.controls.right.set(M-u.x,j-u.y),k=new G(D,I,O-D,U-I,void 0,void 0,V.curve),u=k,_=k.controls.left;break;case"t":case"q":R=u.x,E=u.y,_||(_=new L),/q/i.test(C)?(M=parseFloat(f[0]),j=parseFloat(f[1]),O=parseFloat(f[0]),U=parseFloat(f[1]),D=parseFloat(f[2]),I=parseFloat(f[3])):(q=Hs(u,_,c),M=q.x,j=q.y,O=q.x,U=q.y,D=parseFloat(f[0]),I=parseFloat(f[1])),c&&(M+=R,j+=E,O+=R,U+=E,D+=R,I+=E),u.controls.right.set((M-u.x)*.33,(j-u.y)*.33),k=new G(D,I,O-D,U-I,void 0,void 0,V.curve),u=k,_=k.controls.left;break;case"a":R=u.x,E=u.y,wt=parseFloat(f[0]),at=parseFloat(f[1]),it=parseFloat(f[2]),N=parseFloat(f[3]),kt=parseFloat(f[4]),D=parseFloat(f[5]),I=parseFloat(f[6]),c&&(D+=R,I+=E),Y=new G(D,I),Y.command=V.arc,Y.rx=wt,Y.ry=at,Y.xAxisRotation=it,Y.largeArcFlag=N,Y.sweepFlag=kt,k=Y,u=Y,_=void 0;break}k&&(Array.isArray(k)?o=o.concat(k):o.push(k))})}r=new W(o,l,void 0,!0).noStroke(),r.fill="black";const h=r.getBoundingClientRect(!0);return h.centroid={x:h.left+h.width/2,y:h.top+h.height/2},F.each(r.vertices,function(u){u.subSelf(h.centroid)}),Ft.call(this,t,r,i),r.translation.addSelf(h.centroid),r},circle:function(t,i){const r=parseFloat(t.getAttribute("cx")),o=parseFloat(t.getAttribute("cy")),l=parseFloat(t.getAttribute("r")),c=new Xi(0,0,l).noStroke();return c.fill="black",Ft.call(this,t,c,i),c.translation.x=r,c.translation.y=o,c},ellipse:function(t,i){const r=parseFloat(t.getAttribute("cx")),o=parseFloat(t.getAttribute("cy")),l=parseFloat(t.getAttribute("rx")),c=parseFloat(t.getAttribute("ry")),h=new Wi(0,0,l,c).noStroke();return h.fill="black",Ft.call(this,t,h,i),h.translation.x=r,h.translation.y=o,h},rect:function(t,i){const r=parseFloat(t.getAttribute("rx")),o=parseFloat(t.getAttribute("ry"));if(!F.isNaN(r)||!F.isNaN(o))return lt["rounded-rect"](t);const l=parseFloat(t.getAttribute("width")),c=parseFloat(t.getAttribute("height")),h=l/2,u=c/2,_=new xe(0,0,l,c).noStroke();return _.fill="black",Ft.call(this,t,_,i),_.translation.x+=h,_.translation.y+=u,_},"rounded-rect":function(t,i){const r=parseFloat(t.getAttribute("rx"))||0,o=parseFloat(t.getAttribute("ry"))||0,l=parseFloat(t.getAttribute("width")),c=parseFloat(t.getAttribute("height")),h=l/2,u=c/2,_=new L(r,o),f=new Ji(0,0,l,c,_).noStroke();return f.fill="black",Ft.call(this,t,f,i),f.translation.x+=h,f.translation.y+=u,f},line:function(t,i){const r=parseFloat(t.getAttribute("x1")),o=parseFloat(t.getAttribute("y1")),l=parseFloat(t.getAttribute("x2")),c=parseFloat(t.getAttribute("y2")),h=new Ws(r,o,l,c).noFill();return Ft.call(this,t,h,i),h},lineargradient:function(t,i){let r=t.getAttribute("gradientUnits"),o=t.getAttribute("spreadMethod");r||(r="objectBoundingBox"),o||(o="pad");let l=parseFloat(t.getAttribute("x1")||0),c=parseFloat(t.getAttribute("y1")||0),h=parseFloat(t.getAttribute("x2")||0),u=parseFloat(t.getAttribute("y2")||0);const _=(h+l)/2,f=(u+c)/2;/userSpaceOnUse/i.test(r)&&(l-=_,c-=f,h-=_,u-=f);const y=[];for(let v=0;v<t.children.length;v++){const b=t.children[v];let k=b.getAttribute("offset");/%/ig.test(k)&&(k=parseFloat(k.replace(/%/ig,""))/100),k=parseFloat(k);let P=b.getAttribute("stop-color"),S=b.getAttribute("stop-opacity"),x=b.getAttribute("style"),C;P===null&&(C=x?x.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,P=C&&C.length>1?C[1]:void 0),S===null?(C=x?x.match(/stop-opacity:\s?([0-9.-]*)/):!1,S=C&&C.length>1?parseFloat(C[1]):1):S=parseFloat(S),y.push(new pe(k,P,S))}const g=new ht(l,c,h,u,y);return g.spread=o,g.units=r,Ft.call(this,t,g,i),g},radialgradient:function(t,i){let r=t.getAttribute("gradientUnits"),o=t.getAttribute("spreadMethod");r||(r="objectBoundingBox"),o||(o="pad");let l=parseFloat(t.getAttribute("cx"))||0,c=parseFloat(t.getAttribute("cy"))||0,h=parseFloat(t.getAttribute("r")),u=parseFloat(t.getAttribute("fx")),_=parseFloat(t.getAttribute("fy"));F.isNaN(u)&&(u=l),F.isNaN(_)&&(_=c);const f=Math.abs(l+u)/2,y=Math.abs(c+_)/2;/userSpaceOnUse/i.test(r)&&(l-=f,c-=y,u-=f,_-=y);const g=[];for(let b=0;b<t.children.length;b++){const k=t.children[b];let P=k.getAttribute("offset");/%/ig.test(P)&&(P=parseFloat(P.replace(/%/ig,""))/100),P=parseFloat(P);let S=k.getAttribute("stop-color"),x=k.getAttribute("stop-opacity"),C=k.getAttribute("style"),R;S===null&&(R=C?C.match(/stop-color:\s?([#a-fA-F0-9]*)/):!1,S=R&&R.length>1?R[1]:void 0),x===null?(R=C?C.match(/stop-opacity:\s?([0-9.-]*)/):!1,x=R&&R.length>1?parseFloat(R[1]):1):x=parseFloat(x),g.push(new pe(P,S,x))}const v=new ct(l,c,h,g,u,_);return v.spread=o,v.units=r,Ft.call(this,t,v,i),v},text:function(t,i){const r=Zc(t.getAttribute("text-anchor"))||"left",o=Qc(t)||"baseline",l=t.textContent,c=new Bt(l);return Ft.call(this,t,c,i),c.alignment=r,c.baseline=o,c},clippath:function(t,i){return lt.defs.current&&!lt.defs.current.contains(t.id)&&lt.defs.current.add(t.id,t),null},image:function(t,i){let r;const o=t.getAttribute("href")||t.getAttribute("xlink:href");if(!o)return r=new Rt("encountered <image /> with no href."),console.warn(r.name,r.message),null;const l=parseFloat(t.getAttribute("x"))||0,c=parseFloat(t.getAttribute("y"))||0,h=parseFloat(t.getAttribute("width")),u=parseFloat(t.getAttribute("height")),_=new Yi(o,l,c);return F.isNaN(h)||(_.width=h),F.isNaN(u)||(_.height=u),Ft.call(this,t,_,i),_}};function Fa(t,i){const r=new XMLHttpRequest;return r.open("GET",t),r.onreadystatechange=function(){r.readyState===4&&r.status===200&&i(r.responseText)},r.send(),r}var qs=class extends xe{constructor(t,i,r,o){super(i,r,0,0),p(this,"_flagTextures",!1),p(this,"_flagFrameRate",!1),p(this,"_flagIndex",!1),p(this,"_amount",1),p(this,"_duration",0),p(this,"_index",0),p(this,"_startTime",0),p(this,"_playing",!1),p(this,"_firstFrame",0),p(this,"_lastFrame",0),p(this,"_loop",!0),p(this,"_textures",null),p(this,"_frameRate",0),p(this,"_origin",null);for(let l in ia)Object.defineProperty(this,l,ia[l]);this._renderer.flagTextures=ad.bind(this),this._renderer.bindTextures=od.bind(this),this._renderer.unbindTextures=ld.bind(this),this.noStroke(),this.noFill(),Array.isArray(t)?this.textures=t.map(sa.bind(this)):this.textures=[sa(t)],this.origin=new L,this._update(),typeof o=="number"?this.frameRate=o:this.frameRate=qs.DefaultFrameRate,this.index=0}play(t,i,r){return this._playing=!0,this._firstFrame=0,this._lastFrame=this.amount-1,this._startTime=F.performance.now(),typeof t=="number"&&(this._firstFrame=t),typeof i=="number"&&(this._lastFrame=i),typeof r=="function"?this._onLastFrame=r:delete this._onLastFrame,this._index!==this._firstFrame&&(this._startTime-=1e3*Math.abs(this._index-this._firstFrame)/this._frameRate),this}pause(){return this._playing=!1,this}stop(){return this._playing=!1,this._index=this._firstFrame,this}clone(t){const i=new qs(this.textures,this.translation.x,this.translation.y,this.frameRate);return i._loop=this._loop,this._playing&&i.play(),t&&t.add(i),i}toObject(){const t=super.toObject.call(this);return t.textures=this.textures.map(function(i){return i.toObject()}),t.frameRate=this.frameRate,t.index=this.index,t._firstFrame=this._firstFrame,t._lastFrame=this._lastFrame,t._loop=this._loop,t}_update(){const t=this._textures;let i,r,o,l,c,h,u,_;return t&&(this._flagTextures&&(this._amount=t.length),this._flagFrameRate&&(this._duration=1e3*this._amount/this._frameRate),this._playing&&this._frameRate>0?(l=this._amount,F.isNaN(this._lastFrame)&&(this._lastFrame=l-1),o=F.performance.now()-this._startTime,_=this._lastFrame+1,c=1e3*(_-this._firstFrame)/this._frameRate,this._loop?o=o%c:o=Math.min(o,c),u=Et(this._firstFrame,_,o/c),u=Math.floor(u),u!==this._index&&(this._index=u,h=t[this._index],h.loaded&&(i=h.image.width,r=h.image.height,this.width!==i&&(this.width=i),this.height!==r&&(this.height=r),this.fill=h,u>=this._lastFrame-1&&this._onLastFrame&&this._onLastFrame()))):(this._flagIndex||!(this.fill instanceof Q))&&(h=t[this._index],h.loaded&&(i=h.image.width,r=h.image.height,this.width!==i&&(this.width=i),this.height!==r&&(this.height=r)),this.fill=h)),super._update.call(this),this}flagReset(){return this._flagTextures=this._flagFrameRate=!1,super.flagReset.call(this),this}},Zi=qs;p(Zi,"Properties",["textures","frameRate","index"]);p(Zi,"DefaultFrameRate",30);var ia={frameRate:{enumerable:!0,get:function(){return this._frameRate},set:function(t){this._frameRate=t,this._flagFrameRate=!0}},index:{enumerable:!0,get:function(){return this._index},set:function(t){this._index=t,this._flagIndex=!0}},textures:{enumerable:!0,get:function(){return this._textures},set:function(t){const i=this._renderer.bindTextures,r=this._renderer.unbindTextures;this._textures&&this._textures.unbind(A.Types.insert,i).unbind(A.Types.remove,r),this._textures=new ue((t||[]).slice(0)),this._textures.bind(A.Types.insert,i).bind(A.Types.remove,r),i(this._textures)}}};function ad(){this._flagTextures=!0}function od(t){let i=t.length;for(;i--;)t[i].bind(A.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function ld(t){let i=t.length;for(;i--;)t[i].unbind(A.Types.change,this._renderer.flagTextures);this._renderer.flagTextures()}function sa(t){if(t instanceof Q)return t;if(typeof t=="string")return new Q(t)}var Bi=class extends W{constructor(t,i,r,o,l,c,h){const u=h||vt.Resolution*3,_=[];for(let f=0;f<u;f++)_.push(new G);super(_,!0,!1,!0),p(this,"_flagStartAngle",!1),p(this,"_flagEndAngle",!1),p(this,"_flagInnerRadius",!1),p(this,"_flagOuterRadius",!1),p(this,"_startAngle",0),p(this,"_endAngle",xt),p(this,"_innerRadius",0),p(this,"_outerRadius",0);for(let f in na)Object.defineProperty(this,f,na[f]);typeof r=="number"&&(this.innerRadius=r),typeof o=="number"&&(this.outerRadius=o),typeof l=="number"&&(this.startAngle=l),typeof c=="number"&&(this.endAngle=c),this._update(),typeof t=="number"&&(this.translation.x=t),typeof i=="number"&&(this.translation.y=i)}_update(){if(this._flagVertices||this._flagStartAngle||this._flagEndAngle||this._flagInnerRadius||this._flagOuterRadius){const t=this._startAngle,i=this._endAngle,r=this._innerRadius,o=this._outerRadius,l=Mt(t,xt)===Mt(i,xt),c=r>0,h=this.vertices;let u=c?h.length/2:h.length,_,f=0,y,g,v,b,k,P,S,x,C;for(l?u--:c||(u-=2),y=0,g=u-1;y<u;y++){switch(v=y/g,b=h[f],k=v*(i-t)+t,P=(i-t)/u,S=o*Math.cos(k),x=o*Math.sin(k),y){case 0:_=V.move;break;default:_=V.curve}b.command=_,b.x=S,b.y=x,b.controls.left.clear(),b.controls.right.clear(),b.command===V.curve&&(C=o*P/Math.PI,b.controls.left.x=C*Math.cos(k-gt),b.controls.left.y=C*Math.sin(k-gt),b.controls.right.x=C*Math.cos(k+gt),b.controls.right.y=C*Math.sin(k+gt),y===1&&b.controls.left.multiplyScalar(2),y===g&&b.controls.right.multiplyScalar(2)),f++}if(c){for(l?(h[f].command=V.close,f++):(u--,g=u-1),y=0;y<u;y++)v=y/g,b=h[f],k=(1-v)*(i-t)+t,P=(i-t)/u,S=r*Math.cos(k),x=r*Math.sin(k),_=V.curve,y<=0&&(_=l?V.move:V.line),b.command=_,b.x=S,b.y=x,b.controls.left.clear(),b.controls.right.clear(),b.command===V.curve&&(C=r*P/Math.PI,b.controls.left.x=C*Math.cos(k+gt),b.controls.left.y=C*Math.sin(k+gt),b.controls.right.x=C*Math.cos(k-gt),b.controls.right.y=C*Math.sin(k-gt),y===1&&b.controls.left.multiplyScalar(2),y===g&&b.controls.right.multiplyScalar(2)),f++;h[f].copy(h[0]),h[f].command=V.line}else l||(h[f].command=V.line,h[f].x=0,h[f].y=0,f++,h[f].copy(h[0]),h[f].command=V.line)}return super._update.call(this),this}flagReset(){return super.flagReset.call(this),this._flagStartAngle=this._flagEndAngle=this._flagInnerRadius=this._flagOuterRadius=!1,this}clone(t){const i=this.innerRadius,r=this.outerRadius,o=this.startAngle,l=this.endAngle,c=this.vertices.length,h=new Bi(0,0,i,r,o,l,c);h.translation.copy(this.translation),h.rotation=this.rotation,h.scale=this.scale,h.skewX=this.skewX,h.skewY=this.skewY,this.matrix.manual&&h.matrix.copy(this.matrix);for(let u=0;u<W.Properties.length;u++){const _=W.Properties[u];h[_]=this[_]}return t&&t.add(h),h}toObject(){const t=super.toObject.call(this);for(let i=0;i<Bi.Properties.length;i++){const r=Bi.Properties[i];t[r]=this[r]}return t}},Js=Bi;p(Js,"Properties",["startAngle","endAngle","innerRadius","outerRadius"]);var na={startAngle:{enumerable:!0,get:function(){return this._startAngle},set:function(t){this._startAngle=t,this._flagStartAngle=!0}},endAngle:{enumerable:!0,get:function(){return this._endAngle},set:function(t){this._endAngle=t,this._flagEndAngle=!0}},innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this._flagOuterRadius=!0}}},hd=Math.ceil,cd=Math.floor,ii=class extends de{constructor(t){super(),p(this,"_flagVertices",!0),p(this,"_flagLength",!0),p(this,"_flagFill",!0),p(this,"_flagStroke",!0),p(this,"_flagLinewidth",!0),p(this,"_flagOpacity",!0),p(this,"_flagVisible",!0),p(this,"_flagSize",!0),p(this,"_flagSizeAttenuation",!0),p(this,"_length",0),p(this,"_fill","#fff"),p(this,"_stroke","#000"),p(this,"_linewidth",1),p(this,"_opacity",1),p(this,"_visible",!0),p(this,"_size",1),p(this,"_sizeAttenuation",!1),p(this,"_beginning",0),p(this,"_ending",1),p(this,"_dashes",null),p(this,"noFill",W.prototype.noFill),p(this,"noStroke",W.prototype.noStroke),p(this,"corner",W.prototype.corner),p(this,"center",W.prototype.center),p(this,"getBoundingClientRect",W.prototype.getBoundingClientRect),p(this,"_updateLength",W.prototype._updateLength);for(let i in ra)Object.defineProperty(this,i,ra[i]);this._renderer.type="points",this._renderer.flagVertices=Sa.bind(this),this._renderer.bindVertices=Aa.bind(this),this._renderer.unbindVertices=Ra.bind(this),this._renderer.flagFill=Ma.bind(this),this._renderer.flagStroke=Ta.bind(this),this._renderer.vertices=null,this._renderer.collection=null,this.sizeAttenuation=!1,this.beginning=0,this.ending=1,this.fill="#fff",this.stroke="#000",this.className="",this.visible=!0,this.vertices=t,this.dashes=[],this.dashes.offset=0}clone(t){const i=new ii;for(let r=0;r<this.vertices.length;r++)i.vertices.push(this.vertices[r].clone());for(let r=0;r<ii.Properties.length;r++){const o=ii.Properties[r];i[o]=this[o]}return i.className=this.className,i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i.skewX=this.skewX,i.skewY=this.skewY,this.matrix.manual&&i.matrix.copy(this.matrix),t&&t.add(i),i._update()}toObject(){const t={vertices:this.vertices.map(function(i){return i.toObject()})};return F.each(ii.Properties,function(i){t[i]=this[i]},this),t.className=this.className,t.translation=this.translation.toObject(),t.rotation=this.rotation,t.scale=this.scale instanceof L?this.scale.toObject():this.scale,t.skewX=this.skewX,t.skewY=this.skewY,this.matrix.manual&&(t.matrix=this.matrix.toObject()),t}subdivide(t){this._update();let i=[];for(let r=0;r<this.vertices.length;r++){const o=this.vertices[r],l=this.vertices[r-1];if(!l)continue;const c=o.x,h=o.y,u=l.x,_=l.y,f=Ys(c,h,c,h,u,_,u,_,t);i=i.concat(f)}return this.vertices=i,this}_update(){if(this._flagVertices){this._flagLength&&this._updateLength(void 0,!0);const t=Math.min(this._beginning,this._ending),i=Math.max(this._beginning,this._ending),r=Hi(this,t*this._length),o=Hi(this,i*this._length),l=hd(r),c=cd(o);let h=0,u;this._renderer.vertices=[],this._renderer.collection=[];for(let _=0;_<this._collection.length;_++)_>=l&&_<=c&&(u=this._collection[_],this._renderer.collection.push(u),this._renderer.vertices[h*2+0]=u.x,this._renderer.vertices[h*2+1]=u.y,h++)}return super._update.apply(this,arguments),this}flagReset(){return this._flagVertices=this._flagLength=this._flagFill=this._flagStroke=this._flagLinewidth=this._flagOpacity=this._flagVisible=this._flagSize=this._flagSizeAttenuation=!1,super.flagReset.call(this),this}},Zs=ii;p(Zs,"Properties",["fill","stroke","linewidth","opacity","visible","size","sizeAttenuation","beginning","ending"]);var ra={linewidth:{enumerable:!0,get:function(){return this._linewidth},set:function(t){this._linewidth=t,this._flagLinewidth=!0}},opacity:{enumerable:!0,get:function(){return this._opacity},set:function(t){this._opacity=t,this._flagOpacity=!0}},visible:{enumerable:!0,get:function(){return this._visible},set:function(t){this._visible=t,this._flagVisible=!0}},size:{enumerable:!0,get:function(){return this._size},set:function(t){this._size=t,this._flagSize=!0}},sizeAttenuation:{enumerable:!0,get:function(){return this._sizeAttenuation},set:function(t){this._sizeAttenuation=t,this._flagSizeAttenuation=!0}},fill:{enumerable:!0,get:function(){return this._fill},set:function(t){(this._fill instanceof _t||this._fill instanceof ht||this._fill instanceof ct||this._fill instanceof Q)&&this._fill.unbind(A.Types.change,this._renderer.flagFill),this._fill=t,this._flagFill=!0,(this._fill instanceof _t||this._fill instanceof ht||this._fill instanceof ct||this._fill instanceof Q)&&this._fill.bind(A.Types.change,this._renderer.flagFill)}},stroke:{enumerable:!0,get:function(){return this._stroke},set:function(t){(this._stroke instanceof _t||this._stroke instanceof ht||this._stroke instanceof ct||this._stroke instanceof Q)&&this._stroke.unbind(A.Types.change,this._renderer.flagStroke),this._stroke=t,this._flagStroke=!0,(this._stroke instanceof _t||this._stroke instanceof ht||this._stroke instanceof ct||this._stroke instanceof Q)&&this._stroke.bind(A.Types.change,this._renderer.flagStroke)}},length:{get:function(){return this._flagLength&&this._updateLength(),this._length}},beginning:{enumerable:!0,get:function(){return this._beginning},set:function(t){this._beginning=t,this._flagVertices=!0}},ending:{enumerable:!0,get:function(){return this._ending},set:function(t){this._ending=t,this._flagVertices=!0}},vertices:{enumerable:!0,get:function(){return this._collection},set:function(t){const i=this._renderer.bindVertices,r=this._renderer.unbindVertices;this._collection&&this._collection.unbind(A.Types.insert,i).unbind(A.Types.remove,r),t instanceof ue?this._collection=t:this._collection=new ue(t||[]),this._collection.bind(A.Types.insert,i).bind(A.Types.remove,r),i(this._collection)}},dashes:{enumerable:!0,get:function(){return this._dashes},set:function(t){typeof t.offset!="number"&&(t.offset=this.dashes&&this._dashes.offset||0),this._dashes=t}}},dd=Math.cos,ud=Math.sin,Di=class extends W{constructor(t,i,r,o){o=Math.max(o||0,3),super(),p(this,"_flagWidth",!1),p(this,"_flagHeight",!1),p(this,"_flagSides",!1),p(this,"_radius",0),p(this,"_width",0),p(this,"_height",0),p(this,"_sides",0);for(let l in aa)Object.defineProperty(this,l,aa[l]);this.closed=!0,this.automatic=!1,typeof r=="number"&&(this.radius=r),typeof o=="number"&&(this.sides=o),this._update(),typeof t=="number"&&(this.translation.x=t),typeof i=="number"&&(this.translation.y=i)}_update(){if(this._flagVertices||this._flagWidth||this._flagHeight||this._flagSides){const t=this._sides,i=t+1;let r=this.vertices.length;r>t&&(this.vertices.splice(t-1,r-t),r=t);for(let o=0;o<i;o++){const l=(o+.5)/t,c=xt*l+Math.PI/2,h=this._width*dd(c)/2,u=this._height*ud(c)/2;o>=r?this.vertices.push(new G(h,u)):this.vertices[o].set(h,u),this.vertices[o].command=o===0?V.move:V.line}}return super._update.call(this),this}flagReset(){return this._flagWidth=this._flagHeight=this._flagSides=!1,super.flagReset.call(this),this}clone(t){const i=new Di(0,0,0,this.sides);i.translation.copy(this.translation),i.rotation=this.rotation,i.scale=this.scale,i.skewX=this.skewX,i.skewY=this.skewY,i.width=this.width,i.height=this.height,this.matrix.manual&&i.matrix.copy(this.matrix);for(let r=0;r<W.Properties.length;r++){const o=W.Properties[r];i[o]=this[o]}return t&&t.add(i),i}toObject(){const t=super.toObject.call(this);for(let i=0;i<Di.Properties.length;i++){const r=Di.Properties[i];t[r]=this[r]}return t}},Qs=Di;p(Qs,"Properties",["width","height","sides"]);var aa={radius:{enumerable:!0,get:function(){return this._radius},set:function(t){this._radius=t,this.width=t*2,this.height=t*2}},width:{enumerable:!0,get:function(){return this._width},set:function(t){this._width=t,this._flagWidth=!0,this._radius=Math.max(this.width,this.height)/2}},height:{enumerable:!0,get:function(){return this._height},set:function(t){this._height=t,this._flagHeight=!0,this._radius=Math.max(this.width,this.height)/2}},sides:{enumerable:!0,get:function(){return this._sides},set:function(t){this._sides=t,this._flagSides=!0}}},pd=Math.cos,fd=Math.sin,ji=class extends W{constructor(t,i,r,o,l){arguments.length<=3&&(o=r,r=o/2),(typeof l!="number"||l<=0)&&(l=5),super(),p(this,"_flagInnerRadius",!1),p(this,"_flagOuterRadius",!1),p(this,"_flagSides",!1),p(this,"_innerRadius",0),p(this,"_outerRadius",0),p(this,"_sides",0);for(let c in oa)Object.defineProperty(this,c,oa[c]);this.closed=!0,this.automatic=!1,typeof r=="number"&&(this.innerRadius=r),typeof o=="number"&&(this.outerRadius=o),typeof l=="number"&&(this.sides=l),this._update(),typeof t=="number"&&(this.translation.x=t),typeof i=="number"&&(this.translation.y=i)}_update(){if(this._flagVertices||this._flagInnerRadius||this._flagOuterRadius||this._flagSides){const t=this._sides*2,i=t+1;let r=this.vertices.length;r>t&&(this.vertices.splice(t-1,r-t),r=t);for(let o=0;o<i;o++){const l=(o+.5)/t,c=xt*l,h=(o%2?this._outerRadius:this._innerRadius)/2,u=h*pd(c),_=h*fd(c);o>=r?this.vertices.push(new G(u,_)):this.vertices[o].set(u,_),this.vertices[o].command=o===0?V.move:V.line}}return super._update.call(this),this}flagReset(){return this._flagInnerRadius=this._flagOuterRadius=this._flagSides=!1,super.flagReset.call(this),this}clone(t){const i=this.innerRadius,r=this.outerRadius,o=this.sides,l=new ji(0,0,i,r,o);l.translation.copy(this.translation),l.rotation=this.rotation,l.scale=this.scale,l.skewX=this.skewX,l.skewY=this.skewY,this.matrix.manual&&l.matrix.copy(this.matrix);for(let c=0;c<W.Properties.length;c++){const h=W.Properties[c];l[h]=this[h]}return t&&t.add(l),l}toObject(){const t=super.toObject.call(this);for(let i=0;i<ji.Properties.length;i++){const r=ji.Properties[i];t[r]=this[r]}return t}},tn=ji;p(tn,"Properties",["innerRadius","outerRadius","sides"]);var oa={innerRadius:{enumerable:!0,get:function(){return this._innerRadius},set:function(t){this._innerRadius=t,this._flagInnerRadius=!0}},outerRadius:{enumerable:!0,get:function(){return this._outerRadius},set:function(t){this._outerRadius=t,this._flagOuterRadius=!0}},sides:{enumerable:!0,get:function(){return this._sides},set:function(t){this._sides=t,this._flagSides=!0}}},la=new Zt,H={version:1.1,ns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",alignments:{left:"start",center:"middle",right:"end"},createElement:function(t,i){const r=t,o=document.createElementNS(H.ns,r);return r==="svg"&&(i=F.defaults(i||{},{version:H.version})),i&&Object.keys(i).length>0&&H.setAttributes(o,i),o},setAttributes:function(t,i){const r=Object.keys(i);for(let o=0;o<r.length;o++)/href/.test(r[o])?t.setAttributeNS(H.xlink,r[o],i[r[o]]):t.setAttribute(r[o],i[r[o]]);return this},removeAttributes:function(t,i){for(let r in i)t.removeAttribute(r);return this},toString:function(t,i){let r=t.length,o=r-1,l,c="";for(let h=0;h<r;h++){const u=t[h],_=i?Mt(h-1,r):Math.max(h-1,0),f=t[_];let y,g,v,b,k,P,S,x,C,R,E,M,j,O,U,D=dt(u.x),I=dt(u.y);switch(u.command){case V.close:y=V.close;break;case V.arc:E=u.rx,M=u.ry,j=u.xAxisRotation,O=u.largeArcFlag,U=u.sweepFlag,y=V.arc+" "+E+" "+M+" "+j+" "+O+" "+U+" "+D+" "+I;break;case V.curve:S=f.controls&&f.controls.right||L.zero,x=u.controls&&u.controls.left||L.zero,f.relative?(v=dt(S.x+f.x),b=dt(S.y+f.y)):(v=dt(S.x),b=dt(S.y)),u.relative?(k=dt(x.x+u.x),P=dt(x.y+u.y)):(k=dt(x.x),P=dt(x.y)),y=(h===0?V.move:V.curve)+" "+v+" "+b+" "+k+" "+P+" "+D+" "+I;break;case V.move:l=u,y=V.move+" "+D+" "+I;break;default:y=u.command+" "+D+" "+I}h>=o&&i&&(u.command===V.curve&&(g=l,C=u.controls&&u.controls.right||u,R=g.controls&&g.controls.left||g,u.relative?(v=dt(C.x+u.x),b=dt(C.y+u.y)):(v=dt(C.x),b=dt(C.y)),g.relative?(k=dt(R.x+g.x),P=dt(R.y+g.y)):(k=dt(R.x),P=dt(R.y)),D=dt(g.x),I=dt(g.y),y+=" C "+v+" "+b+" "+k+" "+P+" "+D+" "+I),u.command!==V.close&&(y+=" Z")),c+=y+" "}return c},pointsToString:function(t,i){let r="";const o=i*.5;for(let l=0;l<t.length;l++){const c=t[l].x,h=t[l].y-o;r+=V.move+" "+c+" "+h+" ",r+="a "+o+" "+o+" 0 1 0 0.001 0 Z"}return r},getClip:function(t,i){let r=t._renderer.clip;return r||(r=t._renderer.clip=H.createElement("clipPath",{"clip-rule":"nonzero"}),i.defs.appendChild(r)),r},group:{appendChild:function(t){const i=t._renderer.elem;if(!i)return;const r=i.nodeName;!r||/(radial|linear)gradient/i.test(r)||t._clip||this.elem.appendChild(i)},removeChild:function(t){const i=t._renderer.elem;!i||i.parentNode!=this.elem||!i.nodeName||t._clip||this.elem.removeChild(i)},orderChild:function(t){this.elem.appendChild(t._renderer.elem)},renderChild:function(t){H[t._renderer.type].render.call(t,this)},render:function(t){if(!this._visible&&!this._flagVisible||this._opacity===0&&!this._flagOpacity)return this;this._update(),this._renderer.elem||(this._renderer.elem=H.createElement("g",{id:this.id}),t.appendChild(this._renderer.elem));const i=this._matrix.manual||this._flagMatrix,r={domElement:t,elem:this._renderer.elem};i&&this._renderer.elem.setAttribute("transform","matrix("+this._matrix.toString()+")");for(let o=0;o<this.children.length;o++){const l=this.children[o];H[l._renderer.type].render.call(l,t)}return this._flagId&&this._renderer.elem.setAttribute("id",this._id),this._flagOpacity&&this._renderer.elem.setAttribute("opacity",this._opacity),this._flagVisible&&this._renderer.elem.setAttribute("display",this._visible?"inline":"none"),this._flagClassName&&this._renderer.elem.setAttribute("class",this.classList.join(" ")),this._flagAdditions&&this.additions.forEach(H.group.appendChild,r),this._flagSubtractions&&this.subtractions.forEach(H.group.removeChild,r),this._flagOrder&&this.children.forEach(H.group.orderChild,r),this._flagMask&&(this._mask?(H[this._mask._renderer.type].render.call(this._mask,t),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.dataset&&Object.assign(this._renderer.elem.dataset,this.dataset),this.flagReset()}},path:{render:function(t){if(this._opacity===0&&!this._flagOpacity)return this;this._update();const i={};if((this._matrix.manual||this._flagMatrix)&&(i.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(i.id=this._id),this._flagVertices){const o=H.toString(this._renderer.vertices,this._closed);i.d=o}if(this._fill&&this._fill._renderer&&(this._fill._update(),H[this._fill._renderer.type].render.call(this._fill,t,!0)),this._flagFill&&(i.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),H[this._stroke._renderer.type].render.call(this._stroke,t,!0)),this._flagStroke&&(i.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(i["stroke-width"]=this._linewidth),this._flagOpacity&&(i["stroke-opacity"]=this._opacity,i["fill-opacity"]=this._opacity),this._flagClassName&&(i.class=this.classList.join(" ")),this._flagVisible&&(i.visibility=this._visible?"visible":"hidden"),this._flagCap&&(i["stroke-linecap"]=this._cap),this._flagJoin&&(i["stroke-linejoin"]=this._join),this._flagMiter&&(i["stroke-miterlimit"]=this._miter),this.dashes&&this.dashes.length>0&&(i["stroke-dasharray"]=this.dashes.join(" "),i["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?H.setAttributes(this._renderer.elem,i):(i.id=this._id,this._renderer.elem=H.createElement("path",i),t.appendChild(this._renderer.elem)),this._flagClip){const o=H.getClip(this,t),l=this._renderer.elem;this._clip?(l.removeAttribute("id"),o.setAttribute("id",this.id),o.appendChild(l)):(o.removeAttribute("id"),l.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(l))}return this._flagMask&&(this._mask?(H[this._mask._renderer.type].render.call(this._mask,t),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this.flagReset()}},points:{render:function(t){if(this._opacity===0&&!this._flagOpacity)return this;this._update();const i={};if((this._matrix.manual||this._flagMatrix)&&(i.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(i.id=this._id),this._flagVertices||this._flagSize||this._flagSizeAttenuation){let o=this._size;if(!this._sizeAttenuation){we(this,la);const c=la.elements,h=ni(c[0],c[3],c[1],c[4],c[2],c[5]);o/=Math.max(h.scaleX,h.scaleY)}const l=H.pointsToString(this._renderer.collection,o);i.d=l}return this._fill&&this._fill._renderer&&(this._fill._update(),H[this._fill._renderer.type].render.call(this._fill,t,!0)),this._flagFill&&(i.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),H[this._stroke._renderer.type].render.call(this._stroke,t,!0)),this._flagStroke&&(i.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(i["stroke-width"]=this._linewidth),this._flagOpacity&&(i["stroke-opacity"]=this._opacity,i["fill-opacity"]=this._opacity),this._flagClassName&&(i.class=this.classList.join(" ")),this._flagVisible&&(i.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(i["stroke-dasharray"]=this.dashes.join(" "),i["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?H.setAttributes(this._renderer.elem,i):(i.id=this._id,this._renderer.elem=H.createElement("path",i),t.appendChild(this._renderer.elem)),this.flagReset()}},text:{render:function(t){this._update();const i={};if((this._matrix.manual||this._flagMatrix)&&(i.transform="matrix("+this._matrix.toString()+")"),this._flagId&&(i.id=this._id),this._flagFamily&&(i["font-family"]=this._family),this._flagSize&&(i["font-size"]=this._size),this._flagLeading&&(i["line-height"]=this._leading),this._flagAlignment&&(i["text-anchor"]=H.alignments[this._alignment]||this._alignment),this._flagBaseline&&(i["alignment-baseline"]=i["dominant-baseline"]=this._baseline),this._flagStyle&&(i["font-style"]=this._style),this._flagWeight&&(i["font-weight"]=this._weight),this._flagDecoration&&(i["text-decoration"]=this._decoration),this._fill&&this._fill._renderer&&(this._fill._update(),H[this._fill._renderer.type].render.call(this._fill,t,!0)),this._flagFill&&(i.fill=this._fill&&this._fill.id?"url(#"+this._fill.id+")":this._fill),this._stroke&&this._stroke._renderer&&(this._stroke._update(),H[this._stroke._renderer.type].render.call(this._stroke,t,!0)),this._flagStroke&&(i.stroke=this._stroke&&this._stroke.id?"url(#"+this._stroke.id+")":this._stroke),this._flagLinewidth&&(i["stroke-width"]=this._linewidth),this._flagOpacity&&(i.opacity=this._opacity),this._flagClassName&&(i.class=this.classList.join(" ")),this._flagVisible&&(i.visibility=this._visible?"visible":"hidden"),this.dashes&&this.dashes.length>0&&(i["stroke-dasharray"]=this.dashes.join(" "),i["stroke-dashoffset"]=this.dashes.offset||0),this._renderer.elem?H.setAttributes(this._renderer.elem,i):(i.id=this._id,this._renderer.elem=H.createElement("text",i),t.defs.appendChild(this._renderer.elem)),this._flagClip){const o=H.getClip(this,t),l=this._renderer.elem;this._clip?(l.removeAttribute("id"),o.setAttribute("id",this.id),o.appendChild(l)):(o.removeAttribute("id"),l.setAttribute("id",this.id),this.parent._renderer.elem.appendChild(l))}return this._flagMask&&(this._mask?(H[this._mask._renderer.type].render.call(this._mask,t),this._renderer.elem.setAttribute("clip-path","url(#"+this._mask.id+")")):this._renderer.elem.removeAttribute("clip-path")),this._flagValue&&(this._renderer.elem.textContent=this._value),this.flagReset()}},"linear-gradient":{render:function(t,i){i||this._update();const r={};if(this._flagId&&(r.id=this._id),this._flagEndPoints&&(r.x1=this.left._x,r.y1=this.left._y,r.x2=this.right._x,r.y2=this.right._y),this._flagSpread&&(r.spreadMethod=this._spread),this._flagUnits&&(r.gradientUnits=this._units),this._renderer.elem?H.setAttributes(this._renderer.elem,r):(r.id=this._id,this._renderer.elem=H.createElement("linearGradient",r),t.defs.appendChild(this._renderer.elem)),this._flagStops){const o=this._renderer.elem.childNodes.length!==this.stops.length;if(o)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let l=0;l<this.stops.length;l++){const c=this.stops[l],h={};c._flagOffset&&(h.offset=100*c._offset+"%"),c._flagColor&&(h["stop-color"]=c._color),c._flagOpacity&&(h["stop-opacity"]=c._opacity),c._renderer.elem?H.setAttributes(c._renderer.elem,h):c._renderer.elem=H.createElement("stop",h),o&&this._renderer.elem.appendChild(c._renderer.elem),c.flagReset()}}return this.flagReset()}},"radial-gradient":{render:function(t,i){i||this._update();const r={};if(this._flagId&&(r.id=this._id),this._flagCenter&&(r.cx=this.center._x,r.cy=this.center._y),this._flagFocal&&(r.fx=this.focal._x,r.fy=this.focal._y),this._flagRadius&&(r.r=this._radius),this._flagSpread&&(r.spreadMethod=this._spread),this._flagUnits&&(r.gradientUnits=this._units),this._renderer.elem?H.setAttributes(this._renderer.elem,r):(r.id=this._id,this._renderer.elem=H.createElement("radialGradient",r),t.defs.appendChild(this._renderer.elem)),this._flagStops){const o=this._renderer.elem.childNodes.length!==this.stops.length;if(o)for(;this._renderer.elem.lastChild;)this._renderer.elem.removeChild(this._renderer.elem.lastChild);for(let l=0;l<this.stops.length;l++){const c=this.stops[l],h={};c._flagOffset&&(h.offset=100*c._offset+"%"),c._flagColor&&(h["stop-color"]=c._color),c._flagOpacity&&(h["stop-opacity"]=c._opacity),c._renderer.elem?H.setAttributes(c._renderer.elem,h):c._renderer.elem=H.createElement("stop",h),o&&this._renderer.elem.appendChild(c._renderer.elem),c.flagReset()}}return this.flagReset()}},texture:{render:function(t,i){i||this._update();const r={},o={x:0,y:0},l=this.image;if(this._flagId&&(r.id=this._id),this._flagLoaded&&this.loaded)switch(l.nodeName.toLowerCase()){case"canvas":o.href=o["xlink:href"]=l.toDataURL("image/png");break;case"img":case"image":o.href=o["xlink:href"]=this.src;break}if((this._flagOffset||this._flagLoaded||this._flagScale)&&(r.x=this._offset.x,r.y=this._offset.y,l&&(r.x-=l.width/2,r.y-=l.height/2,this._scale instanceof L?(r.x*=this._scale.x,r.y*=this._scale.y):(r.x*=this._scale,r.y*=this._scale)),r.x>0&&(r.x*=-1),r.y>0&&(r.y*=-1)),(this._flagScale||this._flagLoaded||this._flagRepeat)&&(r.width=0,r.height=0,l)){switch(o.width=r.width=l.width,o.height=r.height=l.height,this._repeat){case"no-repeat":r.width+=1,r.height+=1;break}this._scale instanceof L?(r.width*=this._scale.x,r.height*=this._scale.y):(r.width*=this._scale,r.height*=this._scale)}return(this._flagScale||this._flagLoaded)&&(this._renderer.image?H.setAttributes(this._renderer.image,o):this._renderer.image=H.createElement("image",o)),this._renderer.elem?Object.keys(r).length!==0&&H.setAttributes(this._renderer.elem,r):(r.id=this._id,r.patternUnits="userSpaceOnUse",this._renderer.elem=H.createElement("pattern",r),t.defs.appendChild(this._renderer.elem)),this._renderer.elem&&this._renderer.image&&!this._renderer.appended&&(this._renderer.elem.appendChild(this._renderer.image),this._renderer.appended=!0),this.flagReset()}}},Oa=class extends A{constructor(t){super(),this.domElement=t.domElement||H.createElement("svg"),this.scene=new ft,this.scene.parent=this,this.defs=H.createElement("defs"),this.domElement.appendChild(this.defs),this.domElement.defs=this.defs,this.domElement.style.overflow="hidden"}setSize(t,i){return this.width=t,this.height=i,H.setAttributes(this.domElement,{width:t,height:i}),this.trigger(A.Types.resize,t,i)}render(){return H.group.render.call(this.scene,this.domElement),this}};p(Oa,"Utils",H);var Ot={create:function(t,i,r){const o=t.createShader(t[r]);if(t.shaderSource(o,i),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS)){const c=t.getShaderInfoLog(o);throw t.deleteShader(o),new Rt("unable to compile shader "+o+": "+c)}return o},types:{vertex:"VERTEX_SHADER",fragment:"FRAGMENT_SHADER"},path:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform mat3 u_matrix;
      uniform vec2 u_resolution;
      uniform vec4 u_rect;

      varying vec2 v_textureCoords;

      void main() {
        vec2 rectCoords = (a_position * (u_rect.zw - u_rect.xy)) + u_rect.xy;
        vec2 projected = (u_matrix * vec3(rectCoords, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;
      varying vec2 v_textureCoords;

      void main() {
        vec4 texel = texture2D(u_image, v_textureCoords);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `},points:{vertex:`
      precision mediump float;
      attribute vec2 a_position;

      uniform float u_size;
      uniform mat3 u_matrix;
      uniform vec2 u_resolution;

      varying vec2 v_textureCoords;

      void main() {
        vec2 projected = (u_matrix * vec3(a_position, 1.0)).xy;
        vec2 normal = projected / u_resolution;
        vec2 clipspace = (normal * 2.0) - 1.0;

        gl_PointSize = u_size;
        gl_Position = vec4(clipspace * vec2(1.0, -1.0), 0.0, 1.0);
        v_textureCoords = a_position;
      }
    `,fragment:`
      precision mediump float;

      uniform sampler2D u_image;

      void main() {
        vec4 texel = texture2D(u_image, gl_PointCoord);
        if (texel.a == 0.0) {
          discard;
        }
        gl_FragColor = texel;
      }
    `}},Ti=Zt.Multiply,_d=[1,0,0,0,1,0,0,0,1],he=new $t(9),md=li.Utils,Gs=new $t([0,0,1,0,0,1,0,1,1,0,1,1]),K={precision:.9,isHidden:/(undefined|none|transparent)/i,canvas:ut.document?ut.document.createElement("canvas"):{getContext:function(){}},alignments:{left:"start",middle:"center",right:"end"},matrix:new Zt,group:{removeChild:function(t,i){if(t.children)for(let r=0;r<t.children.length;r++)K.group.removeChild(t.children[r],i);t._renderer.texture&&(i.deleteTexture(t._renderer.texture),delete t._renderer.texture),t._renderer.positionBuffer&&(i.deleteBuffer(t._renderer.positionBuffer),delete t._renderer.positionBuffer)},render:function(t,i){if(!this._visible)return;this._update();const r=this.parent,o=r._matrix&&r._matrix.manual||r._flagMatrix,l=this._matrix.manual||this._flagMatrix;(o||l)&&(this._renderer.matrix||(this._renderer.matrix=new $t(9)),this._matrix.toTransformArray(!0,he),Ti(he,r._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof L||(this._renderer.scale=new L),this._scale instanceof L?(this._renderer.scale.x=this._scale.x,this._renderer.scale.y=this._scale.y):(this._renderer.scale.x=this._scale,this._renderer.scale.y=this._scale),/renderer/i.test(r._renderer.type)||(this._renderer.scale.x*=r._renderer.scale.x,this._renderer.scale.y*=r._renderer.scale.y),o&&(this._flagMatrix=!0)),this._mask&&(t.clear(t.STENCIL_BUFFER_BIT),t.enable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,1,0),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.colorMask(!1,!1,!1,!1),K[this._mask._renderer.type].render.call(this._mask,t,i,this),t.stencilFunc(t.EQUAL,1,255),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.colorMask(!0,!0,!0,!0)),this._flagOpacity=r._flagOpacity||this._flagOpacity,this._renderer.opacity=this._opacity*(r&&r._renderer?r._renderer.opacity:1);let c;if(this._flagSubtractions)for(c=0;c<this.subtractions.length;c++)K.group.removeChild(this.subtractions[c],t);for(c=0;c<this.children.length;c++){const h=this.children[c];K[h._renderer.type].render.call(h,t,i)}return this._mask&&t.disable(t.STENCIL_TEST),this.flagReset()}},path:{updateCanvas:function(t){let i,r,o,l,c,h,u,_,f,y,g,v,b,k;const P=t._renderer.vertices,S=this.canvas,x=this.ctx,C=t._renderer.scale,R=t._stroke,E=t._linewidth,M=t._fill,j=t._renderer.opacity||t._opacity,O=t._cap,U=t._join,D=t._miter,I=t._closed,q=t.dashes,J=P.length,nt=J-1;S.width=Math.max(Math.ceil(t._renderer.rect.width*C.x),1),S.height=Math.max(Math.ceil(t._renderer.rect.height*C.y),1);const Y=t._renderer.rect.centroid,wt=Y.x,at=Y.y;x.clearRect(0,0,S.width,S.height),M&&(typeof M=="string"?x.fillStyle=M:(K[M._renderer.type].render.call(M,x,t),x.fillStyle=M._renderer.effect)),R&&(typeof R=="string"?x.strokeStyle=R:(K[R._renderer.type].render.call(R,x,t),x.strokeStyle=R._renderer.effect),E&&(x.lineWidth=E),D&&(x.miterLimit=D),U&&(x.lineJoin=U),!I&&O&&(x.lineCap=O)),typeof j=="number"&&(x.globalAlpha=j),q&&q.length>0&&(x.lineDashOffset=q.offset||0,x.setLineDash(q));let it,N,kt,Nt,Ut,Ct,Qt,et;x.save(),x.scale(C.x,C.y),x.translate(wt,at),x.beginPath();for(let st=0;st<P.length;st++){const rt=P[st];switch(v=rt.x,b=rt.y,rt.command){case V.close:x.closePath();break;case V.arc:N=rt.rx,kt=rt.ry,Nt=rt.xAxisRotation,Ut=rt.largeArcFlag,Ct=rt.sweepFlag,i=I?Mt(st-1,J):Math.max(st-1,0),r=P[i],Qt=r.x,et=r.y,md.renderSvgArcCommand(x,Qt,et,N,kt,Ut,Ct,Nt,v,b);break;case V.curve:i=I?Mt(st-1,J):Math.max(st-1,0),r=P[i],_=r.controls&&r.controls.right||L.zero,f=rt.controls&&rt.controls.left||L.zero,r._relative?(h=_.x+r.x,u=_.y+r.y):(h=_.x,u=_.y),rt._relative?(l=f.x+rt.x,c=f.y+rt.y):(l=f.x,c=f.y),x.bezierCurveTo(h,u,l,c,v,b),st>=nt&&I&&(o=it,y=rt.controls&&rt.controls.right||L.zero,g=o.controls&&o.controls.left||L.zero,rt._relative?(h=y.x+rt.x,u=y.y+rt.y):(h=y.x,u=y.y),o._relative?(l=g.x+o.x,c=g.y+o.y):(l=g.x,c=g.y),v=o.x,b=o.y,x.bezierCurveTo(h,u,l,c,v,b));break;case V.line:x.lineTo(v,b);break;case V.move:it=rt,x.moveTo(v,b);break}}I&&x.closePath(),K.isHidden.test(M)||(k=M._renderer&&M._renderer.offset,k&&(x.save(),x.translate(-M._renderer.offset.x,-M._renderer.offset.y),x.scale(M._renderer.scale.x,M._renderer.scale.y)),x.fill(),k&&x.restore()),K.isHidden.test(R)||(k=R._renderer&&R._renderer.offset,k&&(x.save(),x.translate(-R._renderer.offset.x,-R._renderer.offset.y),x.scale(R._renderer.scale.x,R._renderer.scale.y),x.lineWidth=E/R._renderer.scale.x),x.stroke(),k&&x.restore()),x.restore()},getBoundingClientRect:function(t,i,r){let o=1/0,l=-1/0,c=1/0,h=-1/0,u,_;t.forEach(function(f){const y=f.x,g=f.y,v=f.controls;let b,k,P,S,x,C;c=Math.min(g,c),o=Math.min(y,o),l=Math.max(y,l),h=Math.max(g,h),f.controls&&(x=v.left,C=v.right,!(!x||!C)&&(b=f._relative?x.x+y:x.x,k=f._relative?x.y+g:x.y,P=f._relative?C.x+y:C.x,S=f._relative?C.y+g:C.y,!(!b||!k||!P||!S)&&(c=Math.min(k,S,c),o=Math.min(b,P,o),l=Math.max(b,P,l),h=Math.max(k,S,h))))}),typeof i=="number"&&(c-=i,o-=i,l+=i,h+=i),u=l-o,_=h-c,r.top=c,r.left=o,r.right=l,r.bottom=h,r.width=u,r.height=_,r.centroid||(r.centroid={}),r.centroid.x=-o,r.centroid.y=-c},render:function(t,i,r){if(!this._visible||!this._opacity)return this;this._update();const o=r||this.parent,l=i[this._renderer.type],c=o._matrix.manual||o._flagMatrix,h=this._matrix.manual||this._flagMatrix,u=this._renderer.parent!==o,_=this._flagVertices||this._flagFill||this._fill instanceof ht&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof ct&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof Q&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof ht&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof ct&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof Q&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||o._flagOpacity||this._flagVisible||this._flagCap||this._flagJoin||this._flagMiter||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((c||h||u)&&(this._renderer.matrix||(this._renderer.matrix=new $t(9)),this._matrix.toTransformArray(!0,he),Ti(he,o._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof L||(this._renderer.scale=new L),this._scale instanceof L?(this._renderer.scale.x=this._scale.x*o._renderer.scale.x,this._renderer.scale.y=this._scale.y*o._renderer.scale.y):(this._renderer.scale.x=this._scale*o._renderer.scale.x,this._renderer.scale.y=this._scale*o._renderer.scale.y),u&&(this._renderer.parent=o)),this._mask&&(t.clear(t.STENCIL_BUFFER_BIT),t.enable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,1,0),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.colorMask(!1,!1,!1,!1),K[this._mask._renderer.type].render.call(this._mask,t,i,this),t.stencilFunc(t.EQUAL,1,255),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.colorMask(!0,!0,!0,!0)),_?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*o._renderer.opacity,K.path.getBoundingClientRect(this._renderer.vertices,this._linewidth,this._renderer.rect),K.updateTexture.call(K,t,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture)return this;i.current!==l&&(t.useProgram(l),t.bindBuffer(t.ARRAY_BUFFER,i.buffers.position),t.vertexAttribPointer(l.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(l.position),t.bufferData(t.ARRAY_BUFFER,Gs,t.STATIC_DRAW),i.resolution.flagged||t.uniform2f(t.getUniformLocation(l,"u_resolution"),i.resolution.width,i.resolution.height),i.current=l),i.resolution.flagged&&t.uniform2f(t.getUniformLocation(l,"u_resolution"),i.resolution.width,i.resolution.height),t.bindTexture(t.TEXTURE_2D,this._renderer.texture);const f=this._renderer.rect;return t.uniformMatrix3fv(l.matrix,!1,this._renderer.matrix),t.uniform4f(l.rect,f.left,f.top,f.right,f.bottom),t.drawArrays(t.TRIANGLES,0,6),this._mask&&t.disable(t.STENCIL_TEST),this.flagReset()}},points:{updateCanvas:function(t){let i;const r=this.canvas,o=this.ctx,l=t._stroke,c=t._linewidth,h=t._fill,u=t._renderer.opacity||t._opacity,_=t.dashes,f=t._size;let y=f;K.isHidden.test(l)||(y+=c),r.width=_a(y),r.height=r.width;const g=y/r.width,v=r.width/2,b=r.height/2;o.clearRect(0,0,r.width,r.height),h&&(typeof h=="string"?o.fillStyle=h:(K[h._renderer.type].render.call(h,o,t),o.fillStyle=h._renderer.effect)),l&&(typeof l=="string"?o.strokeStyle=l:(K[l._renderer.type].render.call(l,o,t),o.strokeStyle=l._renderer.effect),c&&(o.lineWidth=c/g)),typeof u=="number"&&(o.globalAlpha=u),_&&_.length>0&&(o.lineDashOffset=_.offset||0,o.setLineDash(_)),o.save(),o.translate(v,b),o.scale(K.precision,K.precision),o.beginPath(),o.arc(0,0,f/g*.5,0,xt),o.restore(),closed&&o.closePath(),K.isHidden.test(h)||(i=h._renderer&&h._renderer.offset,i&&(o.save(),o.translate(-h._renderer.offset.x,-h._renderer.offset.y),o.scale(h._renderer.scale.x,h._renderer.scale.y)),o.fill(),i&&o.restore()),K.isHidden.test(l)||(i=l._renderer&&l._renderer.offset,i&&(o.save(),o.translate(-l._renderer.offset.x,-l._renderer.offset.y),o.scale(l._renderer.scale.x,l._renderer.scale.y),o.lineWidth=c/l._renderer.scale.x),o.stroke(),i&&o.restore())},render:function(t,i,r){if(!this._visible||!this._opacity)return this;this._update();let o=this._size;const l=r||this.parent,c=i[this._renderer.type],h=this._sizeAttenuation,u=this._stroke,_=this._linewidth,f=l._matrix.manual||l._flagMatrix,y=this._matrix.manual||this._flagMatrix,g=this._renderer.parent!==l,v=this._renderer.vertices,b=this._renderer.collection.length,k=this._flagVertices,P=this._flagFill||this._fill instanceof ht&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof ct&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof Q&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof ht&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof ct&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof Q&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||l._flagOpacity||this._flagVisible||this._flagScale||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((f||y||g)&&(this._renderer.matrix||(this._renderer.matrix=new $t(9)),this._matrix.toTransformArray(!0,he),Ti(he,l._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof L||(this._renderer.scale=new L),this._scale instanceof L?(this._renderer.scale.x=this._scale.x*l._renderer.scale.x,this._renderer.scale.y=this._scale.y*l._renderer.scale.y):(this._renderer.scale.x=this._scale*l._renderer.scale.x,this._renderer.scale.y=this._scale*l._renderer.scale.y),g&&(this._renderer.parent=l)),k){const S=this._renderer.positionBuffer;S&&t.deleteBuffer(S),this._renderer.positionBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._renderer.positionBuffer),t.vertexAttribPointer(c.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(c.position),t.bufferData(t.ARRAY_BUFFER,v,t.STATIC_DRAW)}return P?(this._renderer.opacity=this._opacity*l._renderer.opacity,K.updateTexture.call(K,t,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture?this:(K.isHidden.test(u)||(o+=_),o/=K.precision,h&&(o*=Math.max(this._renderer.scale.x,this._renderer.scale.y)),i.current!==c&&(t.useProgram(c),i.resolution.flagged||t.uniform2f(t.getUniformLocation(c,"u_resolution"),i.resolution.width,i.resolution.height),i.current=c),i.resolution.flagged&&t.uniform2f(t.getUniformLocation(c,"u_resolution"),i.resolution.width,i.resolution.height),t.bindTexture(t.TEXTURE_2D,this._renderer.texture),t.uniformMatrix3fv(c.matrix,!1,this._renderer.matrix),t.uniform1f(c.size,o*i.resolution.ratio),t.drawArrays(t.POINTS,0,b),this.flagReset())}},text:{updateCanvas:function(t){const i=this.canvas,r=this.ctx,o=t._renderer.scale,l=t._stroke,c=t._linewidth*o,h=t._fill,u=t._renderer.opacity||t._opacity,_=t.dashes,f=t._decoration;i.width=Math.max(Math.ceil(t._renderer.rect.width*o.x),1),i.height=Math.max(Math.ceil(t._renderer.rect.height*o.y),1);const y=t._renderer.rect.centroid,g=y.x,v=y.y;let b,k,P,S,x,C,R,E,M,j,O;const U=h._renderer&&h._renderer.offset&&l._renderer&&l._renderer.offset;if(r.clearRect(0,0,i.width,i.height),U||(r.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" ")),r.textAlign="center",r.textBaseline="middle",h&&(typeof h=="string"?r.fillStyle=h:(K[h._renderer.type].render.call(h,r,t),r.fillStyle=h._renderer.effect)),l&&(typeof l=="string"?r.strokeStyle=l:(K[l._renderer.type].render.call(l,r,t),r.strokeStyle=l._renderer.effect),c&&(r.lineWidth=c)),typeof u=="number"&&(r.globalAlpha=u),_&&_.length>0&&(r.lineDashOffset=_.offset||0,r.setLineDash(_)),r.save(),r.scale(o.x,o.y),r.translate(g,v),K.isHidden.test(h)||(h._renderer&&h._renderer.offset?(C=h._renderer.scale.x,R=h._renderer.scale.y,r.save(),r.translate(-h._renderer.offset.x,-h._renderer.offset.y),r.scale(C,R),b=t._size/h._renderer.scale.y,k=t._leading/h._renderer.scale.y,r.font=[t._style,t._weight,b+"px/",k+"px",t._family].join(" "),P=h._renderer.offset.x/h._renderer.scale.x,S=h._renderer.offset.y/h._renderer.scale.y,r.fillText(t.value,P,S),r.restore()):r.fillText(t.value,0,0)),K.isHidden.test(l)||(l._renderer&&l._renderer.offset?(C=l._renderer.scale.x,R=l._renderer.scale.y,r.save(),r.translate(-l._renderer.offset.x,-l._renderer.offset.y),r.scale(C,R),b=t._size/l._renderer.scale.y,k=t._leading/l._renderer.scale.y,r.font=[t._style,t._weight,b+"px/",k+"px",t._family].join(" "),P=l._renderer.offset.x/l._renderer.scale.x,S=l._renderer.offset.y/l._renderer.scale.y,x=c/l._renderer.scale.x,r.lineWidth=x,r.strokeText(t.value,P,S),r.restore()):r.strokeText(t.value,0,0)),/(underline|strikethrough)/i.test(f)){const D=r.measureText(t.value);switch(f){case"underline":M=D.actualBoundingBoxAscent,O=D.actualBoundingBoxAscent;break;case"strikethrough":M=0,O=0;break}E=-D.width/2,j=D.width/2,r.lineWidth=Math.max(Math.floor(t._size/15),1),r.strokeStyle=r.fillStyle,r.beginPath(),r.moveTo(E,M),r.lineTo(j,O),r.stroke()}r.restore()},getBoundingClientRect:function(t,i){const r=K.ctx;r.font=[t._style,t._weight,t._size+"px/"+t._leading+"px",t._family].join(" "),r.textAlign="center",r.textBaseline=t._baseline;let o=r.measureText(t._value).width*1.25,l=Math.max(t._size,t._leading)*1.25;this._linewidth&&!K.isHidden.test(this._stroke)&&(o+=this._linewidth*2,l+=this._linewidth*2);const c=o/2,h=l/2;switch(K.alignments[t._alignment]||t._alignment){case K.alignments.left:i.left=0,i.right=o;break;case K.alignments.right:i.left=-o,i.right=0;break;default:i.left=-c,i.right=c}switch(t._baseline){case"bottom":i.top=-l,i.bottom=0;break;case"top":i.top=0,i.bottom=l;break;default:i.top=-h,i.bottom=h}i.width=o,i.height=l,i.centroid||(i.centroid={}),i.centroid.x=c,i.centroid.y=h},render:function(t,i,r){if(!this._visible||!this._opacity)return this;this._update();const o=r||this.parent,l=i[this._renderer.type],c=o._matrix.manual||o._flagMatrix,h=this._matrix.manual||this._flagMatrix,u=this._renderer.parent!==o,_=this._flagVertices||this._flagFill||this._fill instanceof ht&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagEndPoints)||this._fill instanceof ct&&(this._fill._flagSpread||this._fill._flagStops||this._fill._flagRadius||this._fill._flagCenter||this._fill._flagFocal)||this._fill instanceof Q&&(this._fill._flagLoaded&&this._fill.loaded||this._fill._flagImage||this._fill._flagVideo||this._fill._flagRepeat||this._fill._flagOffset||this._fill._flagScale)||this._stroke instanceof ht&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagEndPoints)||this._stroke instanceof ct&&(this._stroke._flagSpread||this._stroke._flagStops||this._stroke._flagRadius||this._stroke._flagCenter||this._stroke._flagFocal)||this._stroke instanceof Q&&(this._stroke._flagLoaded&&this._stroke.loaded||this._stroke._flagImage||this._stroke._flagVideo||this._stroke._flagRepeat||this._stroke._flagOffset||this._fill._flagScale)||this._flagStroke||this._flagLinewidth||this._flagOpacity||o._flagOpacity||this._flagVisible||this._flagScale||this._flagValue||this._flagFamily||this._flagSize||this._flagLeading||this._flagAlignment||this._flagBaseline||this._flagStyle||this._flagWeight||this._flagDecoration||this.dashes&&this.dashes.length>0||!this._renderer.texture;if((c||h||u)&&(this._renderer.matrix||(this._renderer.matrix=new $t(9)),this._matrix.toTransformArray(!0,he),Ti(he,o._renderer.matrix,this._renderer.matrix),this._renderer.scale instanceof L||(this._renderer.scale=new L),this._scale instanceof L?(this._renderer.scale.x=this._scale.x*o._renderer.scale.x,this._renderer.scale.y=this._scale.y*o._renderer.scale.y):(this._renderer.scale.x=this._scale*o._renderer.scale.x,this._renderer.scale.y=this._scale*o._renderer.scale.y),u&&(this._renderer.parent=o)),this._mask&&(t.clear(t.STENCIL_BUFFER_BIT),t.enable(t.STENCIL_TEST),t.stencilFunc(t.ALWAYS,1,0),t.stencilOp(t.KEEP,t.KEEP,t.REPLACE),t.colorMask(!1,!1,!1,!1),K[this._mask._renderer.type].render.call(this._mask,t,i,this),t.stencilFunc(t.EQUAL,1,255),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.colorMask(!0,!0,!0,!0)),_?(this._renderer.rect||(this._renderer.rect={}),this._renderer.opacity=this._opacity*o._renderer.opacity,K.text.getBoundingClientRect(this,this._renderer.rect),K.updateTexture.call(K,t,this)):(this._fill&&this._fill._update&&this._fill._update(),this._stroke&&this._stroke._update&&this._stroke._update()),this._clip&&!r||!this._renderer.texture)return this;i.current!==l&&(t.useProgram(l),t.bindBuffer(t.ARRAY_BUFFER,i.buffers.position),t.vertexAttribPointer(l.position,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(l.position),t.bufferData(t.ARRAY_BUFFER,Gs,t.STATIC_DRAW),i.resolution.flagged||t.uniform2f(t.getUniformLocation(l,"u_resolution"),i.resolution.width,i.resolution.height),i.current=l),i.resolution.flagged&&t.uniform2f(t.getUniformLocation(l,"u_resolution"),i.resolution.width,i.resolution.height),t.bindTexture(t.TEXTURE_2D,this._renderer.texture);const f=this._renderer.rect;return t.uniformMatrix3fv(l.matrix,!1,this._renderer.matrix),t.uniform4f(l.rect,f.left,f.top,f.right,f.bottom),t.drawArrays(t.TRIANGLES,0,6),this._mask&&t.disable(t.STENCIL_TEST),this.flagReset()}},"linear-gradient":{render:function(t,i){if(!(!t.canvas.getContext("2d")||!i)){if(this._update(),!this._renderer.effect||this._flagEndPoints||this._flagStops||this._flagUnits){let r,o=this.left._x,l=this.left._y,c=this.right._x,h=this.right._y;/objectBoundingBox/i.test(this._units)&&(r=i.getBoundingClientRect(!0),o=(o-.5)*r.width,l=(l-.5)*r.height,c=(c-.5)*r.width,h=(h-.5)*r.height),this._renderer.effect=t.createLinearGradient(o,l,c,h);for(let u=0;u<this.stops.length;u++){const _=this.stops[u];this._renderer.effect.addColorStop(_._offset,_._color)}}return this.flagReset()}}},"radial-gradient":{render:function(t,i){if(!(!t.canvas.getContext("2d")||!i)){if(this._update(),!this._renderer.effect||this._flagCenter||this._flagFocal||this._flagRadius||this._flagStops||this._flagUnits){let r,o=this.center._x,l=this.center._y,c=this.focal._x,h=this.focal._y,u=this._radius;/objectBoundingBox/i.test(this._units)&&(r=i.getBoundingClientRect(!0),o=o*r.width*.5,l=l*r.height*.5,c=c*r.width*.5,h=h*r.height*.5,u*=Math.min(r.width,r.height)*.5),this._renderer.effect=t.createRadialGradient(o,l,0,c,h,u);for(let _=0;_<this.stops.length;_++){const f=this.stops[_];this._renderer.effect.addColorStop(f._offset,f._color)}}return this.flagReset()}}},texture:{render:function(t,i){if(!t.canvas.getContext("2d"))return;this._update();const r=this.image;if((this._flagLoaded||this._flagImage||this._flagVideo||this._flagRepeat)&&this.loaded)this._renderer.effect=t.createPattern(r,this._repeat);else if(!this._renderer.effect)return this.flagReset();return(this._flagOffset||this._flagLoaded||this._flagScale)&&(this._renderer.offset instanceof L||(this._renderer.offset=new L),this._renderer.offset.x=-this._offset.x,this._renderer.offset.y=-this._offset.y,r&&(this._renderer.offset.x+=r.width/2,this._renderer.offset.y+=r.height/2,this._scale instanceof L?(this._renderer.offset.x*=this._scale.x,this._renderer.offset.y*=this._scale.y):(this._renderer.offset.x*=this._scale,this._renderer.offset.y*=this._scale))),(this._flagScale||this._flagLoaded)&&(this._renderer.scale instanceof L||(this._renderer.scale=new L),this._scale instanceof L?this._renderer.scale.copy(this._scale):this._renderer.scale.set(this._scale,this._scale)),this.flagReset()}},updateTexture:function(t,i){if(this[i._renderer.type].updateCanvas.call(K,i),this.canvas.width<=0||this.canvas.height<=0){i._renderer.texture&&t.deleteTexture(i._renderer.texture),delete i._renderer.texture;return}i._renderer.texture||(i._renderer.texture=t.createTexture()),t.bindTexture(t.TEXTURE_2D,i._renderer.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.canvas)},program:{create:function(t,i){let r,o,l;if(r=t.createProgram(),F.each(i,function(c){t.attachShader(r,c)}),t.linkProgram(r),o=t.getProgramParameter(r,t.LINK_STATUS),!o)throw l=t.getProgramInfoLog(r),t.deleteProgram(r),new Rt("unable to link program: "+l);return r}},TextureRegistry:new Gi};K.ctx=K.canvas.getContext("2d");var Ia=class extends A{constructor(t){super();let i,r,o,l;if(this.domElement=t.domElement||document.createElement("canvas"),typeof t.offscreenElement<"u"&&(K.canvas=t.offscreenElement,K.ctx=K.canvas.getContext("2d")),this.scene=new ft,this.scene.parent=this,this._renderer={type:"renderer",matrix:new $t(_d),scale:1,opacity:1},this._flagMatrix=!0,t=F.defaults(t||{},{antialias:!1,alpha:!0,premultipliedAlpha:!0,stencil:!0,preserveDrawingBuffer:!0,overdraw:!1}),this.overdraw=t.overdraw,i=this.ctx=this.domElement.getContext("webgl",t)||this.domElement.getContext("experimental-webgl",t),!this.ctx)throw new Rt("unable to create a webgl context. Try using another renderer.");o=Ot.create(i,Ot.path.vertex,Ot.types.vertex),l=Ot.create(i,Ot.path.fragment,Ot.types.fragment),this.programs={current:null,buffers:{position:i.createBuffer()},resolution:{width:0,height:0,ratio:1,flagged:!1}},r=this.programs.path=K.program.create(i,[o,l]),this.programs.text=this.programs.path,r.position=i.getAttribLocation(r,"a_position"),r.matrix=i.getUniformLocation(r,"u_matrix"),r.rect=i.getUniformLocation(r,"u_rect");const c=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,c),i.vertexAttribPointer(r.position,2,i.FLOAT,!1,0,0),i.enableVertexAttribArray(r.position),i.bufferData(i.ARRAY_BUFFER,Gs,i.STATIC_DRAW),o=Ot.create(i,Ot.points.vertex,Ot.types.vertex),l=Ot.create(i,Ot.points.fragment,Ot.types.fragment),r=this.programs.points=K.program.create(i,[o,l]),r.position=i.getAttribLocation(r,"a_position"),r.matrix=i.getUniformLocation(r,"u_matrix"),r.size=i.getUniformLocation(r,"u_size"),i.enable(i.BLEND),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA)}setSize(t,i,r){let o,l;const c=this.ctx;return this.width=t,this.height=i,this.ratio=typeof r>"u"?Xs(c):r,this.domElement.width=t*this.ratio,this.domElement.height=i*this.ratio,F.isObject(this.domElement.style)&&F.extend(this.domElement.style,{width:t+"px",height:i+"px"}),this._renderer.matrix[0]=this._renderer.matrix[4]=this._renderer.scale=this.ratio,this._flagMatrix=!0,o=t*this.ratio,l=i*this.ratio,c.viewport(0,0,o,l),this.programs.resolution.width=o,this.programs.resolution.height=l,this.programs.resolution.ratio=this.ratio,this.programs.resolution.flagged=!0,this.trigger(A.Types.resize,t,i,r)}render(){const t=this.ctx;return this.overdraw||t.clear(t.COLOR_BUFFER_BIT),K.group.render.call(this.scene,t,this.programs),this._flagMatrix=!1,this.programs.resolution.flagged=!0,this}};p(Ia,"Utils",K);var gd=F.extend({Error:Rt,getRatio:Xs,read:lt,xhr:Fa},F,At,ma,ua),si=class{constructor(t){p(this,"_events",new A),p(this,"type",""),p(this,"renderer",null),p(this,"scene",null),p(this,"width",0),p(this,"height",0),p(this,"frameCount",0),p(this,"timeDelta",0),p(this,"playing",!1);const i=F.defaults(t||{},{fullscreen:!1,fitted:!1,width:640,height:480,type:si.Types.svg,autostart:!1});if(F.each(i,function(r,o){/fullscreen/i.test(o)||/autostart/i.test(o)||(this[o]=r)},this),F.isElement(i.domElement)){const r=i.domElement.tagName.toLowerCase();/^(CanvasRenderer-canvas|WebGLRenderer-canvas|SVGRenderer-svg)$/.test(this.type+"-"+r)||(this.type=si.Types[r])}this.renderer=new si[this.type](this),this.setPlaying(i.autostart),this.frameCount=0,i.fullscreen?(this.fit=vd.bind(this),this.fit.domElement=window,this.fit.attached=!0,F.extend(document.body.style,{overflow:"hidden",margin:0,padding:0,top:0,left:0,right:0,bottom:0,position:"fixed"}),F.extend(this.renderer.domElement.style,{display:"block",top:0,left:0,right:0,bottom:0,position:"fixed"}),St.bind(this.fit.domElement,"resize",this.fit),this.fit()):i.fitted?(this.fit=bd.bind(this),F.extend(this.renderer.domElement.style,{display:"block"})):F.isElement(i.domElement)||(this.renderer.setSize(i.width,i.height,this.ratio),this.width=i.width,this.height=i.height),this.renderer.bind(A.Types.resize,yd.bind(this)),this.scene=this.renderer.scene,si.Instances.push(this),i.autostart&&oi.init()}get _bound(){return this._events._bound}set _bound(t){this._events._bound=t}addEventListener(){return this._events.addEventListener.apply(this,arguments)}on(){return this._events.addEventListener.apply(this,arguments)}bind(){return this._events.addEventListener.apply(this,arguments)}removeEventListener(){return this._events.removeEventListener.apply(this,arguments)}off(){return this._events.removeEventListener.apply(this,arguments)}unbind(){return this._events.removeEventListener.apply(this,arguments)}dispatchEvent(){return this._events.dispatchEvent.apply(this,arguments)}trigger(){return this._events.dispatchEvent.apply(this,arguments)}listen(){return this._events.listen.apply(this,arguments)}ignore(){return this._events.ignore.apply(this,arguments)}appendTo(t){return t.appendChild(this.renderer.domElement),this.fit&&(this.fit.domElement!==window&&(this.fit.domElement=t,this.fit.attached=!1),this.update()),this}play(){return this.playing=!0,oi.init(),this.trigger(A.Types.play)}pause(){return this.playing=!1,this.trigger(A.Types.pause)}setPlaying(t){this.playing=t}release(t){let i,r,o;if(!F.isObject(t))return this.release(this.scene);if(typeof t.unbind=="function"&&t.unbind(),t.vertices)for(typeof t.vertices.unbind=="function"&&t.vertices.unbind(),i=0;i<t.vertices.length;i++)r=t.vertices[i],typeof r.unbind=="function"&&r.unbind(),r.controls&&(r.controls.left&&typeof r.controls.left.unbind=="function"&&r.controls.left.unbind(),r.controls.right&&typeof r.controls.right.unbind=="function"&&r.controls.right.unbind());if(t.children){for(i=0;i<t.children.length;i++)o=t.children[i],this.release(o);typeof t.children.unbind=="function"&&t.children.unbind()}return t}update(){const t=!!this._lastFrame,i=F.performance.now();t&&(this.timeDelta=parseFloat((i-this._lastFrame).toFixed(3))),this._lastFrame=i,this.fit&&this.fit.domElement&&!this.fit.attached&&(St.bind(this.fit.domElement,"resize",this.fit),this.fit.attached=!0,this.fit());const r=this.width,o=this.height,l=this.renderer;return(r!==l.width||o!==l.height)&&l.setSize(r,o,this.ratio),this.trigger(A.Types.update,this.frameCount,this.timeDelta),this.render()}render(){return this.renderer.render(),this.trigger(A.Types.render,this.frameCount++)}add(t){return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.scene.add(t),this}remove(t){return t instanceof Array||(t=Array.prototype.slice.call(arguments)),this.scene.remove(t),this}clear(){return this.scene.remove(this.scene.children),this}makeLine(t,i,r,o){const l=new Ws(t,i,r,o);return this.scene.add(l),l}makeArrow(t,i,r,o,l){const c=typeof l=="number"?l:10,h=Math.atan2(o-i,r-t),u=[new G(t,i,void 0,void 0,void 0,void 0,V.move),new G(r,o,void 0,void 0,void 0,void 0,V.line),new G(r-c*Math.cos(h-Math.PI/4),o-c*Math.sin(h-Math.PI/4),void 0,void 0,void 0,void 0,V.line),new G(r,o,void 0,void 0,void 0,void 0,V.move),new G(r-c*Math.cos(h+Math.PI/4),o-c*Math.sin(h+Math.PI/4),void 0,void 0,void 0,void 0,V.line)],_=new W(u,!1,!1,!0);return _.noFill(),_.cap="round",_.join="round",this.scene.add(_),_}makeRectangle(t,i,r,o){const l=new xe(t,i,r,o);return this.scene.add(l),l}makeRoundedRectangle(t,i,r,o,l){const c=new Ji(t,i,r,o,l);return this.scene.add(c),c}makeCircle(t,i,r,o){const l=new Xi(t,i,r,o);return this.scene.add(l),l}makeEllipse(t,i,r,o,l){const c=new Wi(t,i,r,o,l);return this.scene.add(c),c}makeStar(t,i,r,o,l){const c=new tn(t,i,r,o,l);return this.scene.add(c),c}makeCurve(t){const i=arguments.length;if(!Array.isArray(t)){t=[];for(let c=0;c<i;c+=2){const h=arguments[c];if(typeof h!="number")break;const u=arguments[c+1];t.push(new G(h,u))}}const r=arguments[i-1],o=new W(t,!(typeof r=="boolean"&&r),!0),l=o.getBoundingClientRect();return o.center().translation.set(l.left+l.width/2,l.top+l.height/2),this.scene.add(o),o}makePolygon(t,i,r,o){const l=new Qs(t,i,r,o);return this.scene.add(l),l}makeArcSegment(t,i,r,o,l,c,h){const u=new Js(t,i,r,o,l,c,h);return this.scene.add(u),u}makePoints(t){const i=arguments.length;let r=t;if(!Array.isArray(t)){r=[];for(let l=0;l<i;l+=2){const c=arguments[l];if(typeof c!="number")break;const h=arguments[l+1];r.push(new L(c,h))}}const o=new Zs(r);return this.scene.add(o),o}makePath(t){const i=arguments.length;let r=t;if(!Array.isArray(t)){r=[];for(let h=0;h<i;h+=2){const u=arguments[h];if(typeof u!="number")break;const _=arguments[h+1];r.push(new G(u,_))}}const o=arguments[i-1],l=new W(r,!(typeof o=="boolean"&&o)),c=l.getBoundingClientRect();return typeof c.top=="number"&&typeof c.left=="number"&&typeof c.right=="number"&&typeof c.bottom=="number"&&l.center().translation.set(c.left+c.width/2,c.top+c.height/2),this.scene.add(l),l}makeText(t,i,r,o){const l=new Bt(t,i,r,o);return this.add(l),l}makeLinearGradient(t,i,r,o){const l=Array.prototype.slice.call(arguments,4),c=new ht(t,i,r,o,l);return this.add(c),c}makeRadialGradient(t,i,r){const o=Array.prototype.slice.call(arguments,3),l=new ct(t,i,r,o);return this.add(l),l}makeSprite(t,i,r,o,l,c,h){const u=new Yi(t,i,r,o,l,c);return h&&u.play(),this.add(u),u}makeImageSequence(t,i,r,o,l){const c=new Zi(t,i,r,o);return l&&c.play(),this.add(c),c}makeTexture(t,i){return new Q(t,i)}makeGroup(t){t instanceof Array||(t=Array.prototype.slice.call(arguments));const i=new ft;return this.scene.add(i),i.add(t),i}interpret(t,i,r){const o=t.tagName.toLowerCase();if(r=typeof r<"u"?r:!0,!(o in lt))return null;const l=lt[o].call(this,t);return r?this.add(i&&l instanceof ft?l.children:l):l.parent&&l.remove(),l}load(t,i){const r=new ft;let o,l,c;const h=function(u){for(St.temp.innerHTML=u,l=0;l<St.temp.children.length;l++)o=St.temp.children[l],c=this.interpret(o,!1,!1),c!==null&&r.add(c);if(typeof i=="function"){const _=St.temp.children.length<=1?St.temp.children[0]:St.temp.children;i(r,_)}}.bind(this);return/\.svg$/i.test(t)?(Fa(t,h),r):(h(t),r)}},$=si;p($,"nextFrameID",vt.nextFrameID);p($,"Types",vt.Types);p($,"Version",vt.Version);p($,"PublishDate",vt.PublishDate);p($,"Identifier",vt.Identifier);p($,"Resolution",vt.Resolution);p($,"AutoCalculateImportedMatrices",vt.AutoCalculateImportedMatrices);p($,"Instances",vt.Instances);p($,"uniqueId",vt.uniqueId);p($,"Anchor",G);p($,"Collection",ue);p($,"Events",A);p($,"Group",ft);p($,"Matrix",Zt);p($,"Path",W);p($,"Registry",Gi);p($,"Shape",de);p($,"Text",Bt);p($,"Vector",L);p($,"Gradient",_t);p($,"ImageSequence",Zi);p($,"LinearGradient",ht);p($,"RadialGradient",ct);p($,"Sprite",Yi);p($,"Stop",pe);p($,"Texture",Q);p($,"ArcSegment",Js);p($,"Circle",Xi);p($,"Ellipse",Wi);p($,"Line",Ws);p($,"Points",Zs);p($,"Polygon",Qs);p($,"Rectangle",xe);p($,"RoundedRectangle",Ji);p($,"Star",tn);p($,"CanvasRenderer",li);p($,"SVGRenderer",Oa);p($,"WebGLRenderer",Ia);p($,"Commands",V);p($,"Utils",gd);function vd(){const t=document.body.getBoundingClientRect(),i=this.width=t.width,r=this.height=t.height;this.renderer.setSize(i,r,this.ratio)}function bd(){const t=this.renderer.domElement.parentElement;if(!t){console.warn("Two.js: Attempting to fit to parent, but no parent found.");return}const i=t.getBoundingClientRect(),r=this.width=i.width,o=this.height=i.height;this.renderer.setSize(r,o,this.ratio)}function yd(t,i){this.width=t,this.height=i,this.trigger(A.Types.resize,t,i)}var oi=St.getRequestAnimationFrame();function Na(){for(let t=0;t<$.Instances.length;t++){const i=$.Instances[t];i.playing&&i.update()}$.nextFrameID=oi(Na)}oi.init=function(){Na(),oi.init=function(){}};const wd=document.querySelector("#app"),Ui=new $({fullscreen:!0,autostart:!0}).appendTo(wd),jt={two:Ui,cities:10,generations:1e3,individuals:30,offspringRatio:.5,mutationRate:1,seed:"",distance:-1},hi=new gc.Pane({title:"Configuration"}),en=hi.addFolder({title:"Cities"});en.addInput(jt,"cities",{label:"Cities",step:1,min:5,max:50});en.addMonitor(jt,"seed",{view:"textarea",multiline:!0,lineCount:2});const Qi=hi.addFolder({title:"GA Params"});Qi.addInput(jt,"generations",{label:"Generations",step:1,min:1,max:1e3});Qi.addInput(jt,"individuals",{label:"Individuals",step:1,min:2,max:1e3});Qi.addInput(jt,"offspringRatio",{label:"Offspring ratio",step:.1,min:.1,max:.9});Qi.addInput(jt,"mutationRate",{label:"Mutation rate",step:1,min:0,max:50});const xd=en.addButton({title:"Generate cities"}),Ki=hi.addButton({title:"Run experiment",disabled:jt.seed===""});xd.on("click",()=>{const t=Cd(jt);jt.seed=t,Ki.disabled=!1});Ki.on("click",()=>{Ki.disabled=!0,setTimeout(()=>{Pd(jt)},100)});const kd=hi.addFolder({title:"Monitor"});kd.addMonitor(jt,"distance",{});function Cd(t){const i=Ui.width-hi.element.offsetWidth,r=Ui.height,o=$i(t.cities).map(l=>[ye(0,i),ye(0,r)]);return ja(Ui,0,o),o}function Pd(t){const i=$i(t.individuals).map(l=>bc(t.seed)),r=l=>-1*Da(l);let o={generation:1,individuals:i,offspringRatio:t.offspringRatio,fitness:r,mutationRate:t.mutationRate};Ba(t,o,t.two)}function Ba(t,i,r){const o=wc(i);ja(r,i.generation,o),t.distance=Da(o),i.generation<t.generations?setTimeout(()=>{Ba(t,yc(i),r)},0):Ki.disabled=!1}function Da(t){return t.map((i,r)=>{const o=r,l=r<t.length-1?r+1:0,c=t[l][0]-t[o][0],h=t[l][1]-t[o][1];return Math.sqrt(c*c+h*h)}).reduce((i,r)=>i+r,0)}function ja(t,i,r){t.clear();const o=t.makeText(`Generation: ${i}`,0,10,{alignment:"left"});o.fill="rgb(255, 255, 255)",r.forEach((l,c)=>{const h=t.makeCircle(l[0],l[1],10);h.fill="rgb(255, 0, 0)";const u=r[c],_=r[c<r.length-1?c+1:0],f=t.makeLine(u[0],u[1],_[0],_[1]);f.stroke="rgb(255, 0, 0)"})}
